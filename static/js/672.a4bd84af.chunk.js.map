{"version":3,"file":"static/js/672.a4bd84af.chunk.js","mappings":"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","sources":["Chat/LeftColumn.js","Chat/ChatHistory.js","Chat/Contacts.js","Chat/Profile.js","Chat/MiddleColumn.js","Chat/ChatServiceconversation.js","Chat/ChatService.js","Chat/ChatContainerCall.js","Chat/VideoChatApp.js","Chat/VideoCallApp.js","Chat/Chatheader.js","Chat/RightColumn.js","Chat/Chat.js","../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { auth } from '../firebase';\n\nconst LeftColumn = ({ handleButtonClick, isLeftColumnVisible }) => {\n  const [activeButton, setActiveButton] = useState('Chat History');\n  const [currentUser, setCurrentUser] = useState(null);\n  const isMobile = window.innerWidth <= 768;\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n      if (user) {\n        setCurrentUser(user); // Set the current user when authenticated\n      } else {\n        setCurrentUser(null); // Reset the current user if not authenticated\n      }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n  }, []);\n\n  const handleButtonClickInternal = (buttonName) => {\n    // Call the parent function passed as a prop\n    handleButtonClick(buttonName);\n    setActiveButton(buttonName);\n  };\n\n  const goBack = () => {\n    window.history.back(); // This will go back one page in the browser history\n  };\n\n    return (\n<div className={`chat-left ${isLeftColumnVisible ? '' : 'hide'}`}>\n        <div className=\"chatleft-column\">\n            <div className=\"d-none d-md-block mb-4\"> \n            <div className=\"avatar-section\">\n            {currentUser && currentUser.photoURL && ( // Check if currentUser and photoURL exist\n              <img\n                src={currentUser.photoURL} // Use currentUser's photoURL\n                alt=\"Avatar\"\n                className=\"w-100 h-auto rounded-circle\"\n                style={{ maxWidth: '12rem' }}\n              />\n            )}\n  </div>\n\n            <hr className=\"avatar-divider\" />\n            </div>\n      \n            <div className=\"LeftColumn-buttons \">\n        <div className=\"chatbutton-container flex-wrap justify-content-center justify-content-md-start gap-2\">\n  \n            <div className=\"button-container\" onClick={() => handleButtonClickInternal('Chat History')}>\n  <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z\" />\n      </svg>\n      \n          </button>\n  \n          {activeButton === 'Chat History' && <div className=\"activated-indicator\"></div>}\n          </div>\n  \n          <div className=\"button-container\" onClick={() => handleButtonClickInternal('Contacts')}>\n          <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z\" />\n            </svg>\n          </button>\n          {activeButton === 'Contacts' && <div className=\"activated-indicator\"></div>}\n        </div>\n  \n        <div className=\"button-container\" onClick={() => handleButtonClickInternal('Profile')}>\n      <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z\" />\n      </svg>\n          </button>\n  \n          {activeButton === 'Profile' && <div className=\"activated-indicator\"></div>}\n          </div>\n  \n       <div className=\"button-container\" onClick={() => handleButtonClickInternal('Settings')}>\n      <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z\" />\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n      </svg>\n          </button>\n          {activeButton === 'Settings' && <div className=\"activated-indicator\"></div>}\n          </div>\n          {isMobile && (\n            <div className=\"button-container\" onClick={() => handleButtonClickInternal('Back')}>\n              <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\" onClick={goBack}>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n                </svg>\n              </button>\n            </div>\n          )}\n  \n   </div>\n   \n   </div>\n   {!isMobile && (\n   <div className='logout-container '>\n<button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\" onClick={goBack}>\n<svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n</svg>\n</button>\n</div>\n   )}\n    \n            </div>\n            </div>\n    );\n  };\n  export default LeftColumn;","import React, { useState, useEffect } from 'react';\nimport { db, collection, doc, getDoc, getDocs, onSnapshot, query, where } from '../firebase';\nimport { auth } from '../firebase';\nimport { deleteDoc } from 'firebase/firestore';\n\nconst ChatHistory = ({ isActive, toggleRightColumnVisibility, updateOtherUserID, otherUserUID }) => {\n  const [showChatHistory, setShowChatHistory] = useState(false);\n  const [currentUserUID, setCurrentUserUID] = useState('');\n  const [otherUserIDs, setOtherUserIDs] = useState([]);\n  const [chatsWithUserData, setChatsWithUserData] = useState([]);\n  const [userProfilesCache, setUserProfilesCache] = useState({});\n  const [hasNewMessages, setHasNewMessages] = useState(false);\n  const [hasNewChats, setHasNewChats] = useState(false);\n  const [unreadMessages, setUnreadMessages] = useState({});\n  const [callingUserID, setCallingUserID] = useState(null);\n  const [latestMessageTimes, setLatestMessageTimes] = useState({});\n\n  useEffect(() => {\n    const isMobile = window.matchMedia('(max-width: 768px)').matches;\n    if (!isMobile) {\n      // Run the updateOtherUserID logic only on desktop\n      if (!otherUserUID && chatsWithUserData.length > 0) {\n        const firstChat = chatsWithUserData[0];\n        const firstChatOtherUserID = firstChat?.otherUserID || null;\n        updateOtherUserID(firstChatOtherUserID, currentUserUID);\n      }\n    }\n  }, [chatsWithUserData, otherUserUID, currentUserUID, updateOtherUserID]);\n\n  useEffect(() => {\n    const fetchChatsForCurrentUser = async (authUID) => {\n      const chatsCollection = collection(db, 'chats');\n      try {\n        const unsubscribe = onSnapshot(chatsCollection, (querySnapshot) => {\n          const chats = [];\n          querySnapshot.forEach((doc) => {\n            const chatID = doc.id;\n            const [fetchedAuthUID, fetchedOtherUserID] = chatID.split('_');\n            if (fetchedAuthUID === authUID || fetchedOtherUserID === authUID) {\n              const otherUserID = fetchedAuthUID === authUID ? fetchedOtherUserID : fetchedAuthUID;\n              setOtherUserIDs((prevUserIDs) => [...prevUserIDs, otherUserID]);\n              const lastMessage = doc.data().messages ? doc.data().messages[doc.data().messages.length - 1] : null;\n              const lastMessageTime = lastMessage ? lastMessage.timestamp.toMillis() : null;\n              chats.push({ id: doc.id, data: doc.data(), otherUserID, lastMessageTime });\n            }\n          });\n          setChatsWithUserData(chats);\n        });\n        return () => {\n          unsubscribe();\n        };\n      } catch (error) {\n        console.error(error);\n      }\n    };\n\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n      if (user) {\n        const authUID = user.uid;\n        setCurrentUserUID(authUID);\n        fetchChatsForCurrentUser(authUID);\n      }\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n\n  const fetchUserProfiles = async (otherUserID) => {\n    if (userProfilesCache[otherUserID]) {\n      return userProfilesCache[otherUserID];\n    }\n    const firestore = db;\n    let userData = {};\n    try {\n      const expertAppsRef = collection(firestore, 'expertApplications');\n      const expertAppDoc = doc(expertAppsRef, otherUserID);\n      const expertDocSnap = await getDoc(expertAppDoc);\n      if (expertDocSnap.exists()) {\n        const expertData = expertDocSnap.data();\n        userData = {\n          photoURL: expertData.photoURL || '',\n          displayName: expertData.displayName || 'Unknown',\n        };\n      } else {\n        const userProfilesRef = collection(firestore, 'userProfiles');\n        const userProfileDoc = doc(userProfilesRef, otherUserID);\n        const docSnap = await getDoc(userProfileDoc);\n\n        if (docSnap.exists()) {\n          const userProfileData = docSnap.data();\n          userData = {\n            photoURL: userProfileData.photoURL || '',\n            displayName: userProfileData.displayName || 'Unknown',\n          };\n        }\n      }\n\n      setUserProfilesCache(prevCache => ({\n        ...prevCache,\n        [otherUserID]: userData,\n      }));\n    } catch (error) {\n      console.error(error);\n    }\n    return userData;\n  };\n\n  useEffect(() => {\n    const updateChatsWithUserData = async () => {\n      const updatedChats = await Promise.all(\n        chatsWithUserData.map(async (chat) => {\n          const userData = await fetchUserProfiles(chat.otherUserID);\n          return { ...chat, userData };\n        })\n      );\n      setChatsWithUserData(updatedChats);\n    };\n    if (chatsWithUserData.length > 0) {\n      updateChatsWithUserData();\n    }\n  }, [chatsWithUserData]);\n\n  const handleDeleteChat = async (chatID, event) => {\n    event.stopPropagation();\n    try {\n      await deleteDoc(doc(db, 'chats', chatID));\n      updateOtherUserID(null, currentUserUID);\n      setChatsWithUserData((prevChats) => prevChats.filter((chat) => chat.id !== chatID));\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const handleChatButtonClick = (otherUserID, currentUserID) => {\n    updateOtherUserID(otherUserID, currentUserID);\n    setShowChatHistory(true);\n    toggleRightColumnVisibility();\n  };\n\n  const hasUnreadMessages = async (chat, currentUserUID) => {\n    try {\n      const chatID = chat.id;\n      const messagesCollectionRef = collection(db, `chats/${chatID}/messages`);\n      const querySnapshot = await getDocs(messagesCollectionRef);\n      for (const doc of querySnapshot.docs) {\n        const message = doc.data();\n        if (message.receiver === currentUserUID && !message.isRead) {\n          return true;\n        }\n      }\n      return false;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  useEffect(() => {\n    const fetchUnreadMessages = async () => {\n      const unreadMessages = await Promise.all(chatsWithUserData.map(chat => hasUnreadMessages(chat, currentUserUID)));\n      setUnreadMessages(unreadMessages);\n    };\n\n    fetchUnreadMessages();\n  }, [chatsWithUserData, currentUserUID]);\n\n  useEffect(() => {\n    if (currentUserUID) {\n      const unsubscribeRooms = onSnapshot(collection(db, 'rooms'), (querySnapshot) => {\n        querySnapshot.docChanges().forEach((change) => {\n          const doc = change.doc;\n          const roomID = doc.id;\n          const roomData = doc.data();\n          const [user1, user2] = roomID.split('_');\n\n          if (change.type === 'added') {\n            // Check if the room contains the current user and has an offer (indicating an ongoing call)\n            if ((user1 === currentUserUID || user2 === currentUserUID) && roomData.offer) {\n              // Set the calling user ID based on the other user in the room\n              setCallingUserID(user1 === currentUserUID ? user2 : user1);\n            }\n          } else if (change.type === 'removed') {\n            // Check if the room that was removed contained the current user\n            if (user1 === currentUserUID || user2 === currentUserUID) {\n              setCallingUserID(null);\n            }\n          }\n        });\n      });\n\n      const unsubscribeCalls = onSnapshot(collection(db, 'calls'), (querySnapshot) => {\n        querySnapshot.docChanges().forEach((change) => {\n          const doc = change.doc;\n          const callID = doc.id;\n          const callData = doc.data();\n          const [user1, user2] = callID.split('_');\n\n          if (change.type === 'added') {\n            // Check if the call contains the current user and has an offer (indicating an ongoing call)\n            if ((user1 === currentUserUID || user2 === currentUserUID) && callData.offer) {\n              // Set the calling user ID based on the other user in the call\n              setCallingUserID(user1 === currentUserUID ? user2 : user1);\n            }\n          } else if (change.type === 'removed') {\n            // Check if the call that was removed contained the current user\n            if (user1 === currentUserUID || user2 === currentUserUID) {\n              setCallingUserID(null);\n            }\n          }\n        });\n      });\n\n      return () => {\n        unsubscribeRooms();\n        unsubscribeCalls();\n      };\n    }\n  }, [currentUserUID]);\n\n  const getLatestMessageTime = async (chat, currentUserId) => {\n    if (chat.id) {\n      const messagesCollectionRef = collection(db, `chats/${chat.id}/messages`);\n      const otherUserId = chat.otherUserID;\n\n      const messagesQuery = query(messagesCollectionRef, where('sender', '==', otherUserId));\n      const messagesSnapshot = await getDocs(messagesQuery);\n\n      if (messagesSnapshot.docs.length > 0) {\n        const latestMessage = messagesSnapshot.docs.reduce((latest, current) => {\n          const latestTime = latest.data().timestamp.toMillis();\n          const currentTime = current.data().timestamp.toMillis();\n          return currentTime > latestTime ? current : latest;\n        });\n\n        // Ensure that the timestamp is parsed properly\n        const dateOptions = { year: 'numeric', month: 'short', day: 'numeric' };\n        const timeOptions = { hour: 'numeric', minute: 'numeric' };\n\n        const time = latestMessage.data().timestamp.toDate().toLocaleTimeString([], timeOptions); // Convert timestamp to time string\n        const date = latestMessage.data().timestamp.toDate().toLocaleDateString([], dateOptions); // Convert timestamp to date string\n        return `${time}, ${date}`;\n      }\n    }\n    return '';\n  };\n\n  useEffect(() => {\n    const fetchLatestMessageTimes = async () => {\n      const times = {};\n\n      for (const chat of chatsWithUserData) {\n        const time = await getLatestMessageTime(chat, currentUserUID);\n        times[chat.id] = time;\n      }\n\n      setLatestMessageTimes(times);\n    };\n\n    fetchLatestMessageTimes();\n  }, [chatsWithUserData, currentUserUID]);\n\n  const sortedChatsWithUserData = chatsWithUserData.sort((a, b) => b.lastMessageTime - a.lastMessageTime);\n\n\nreturn (\n<div className={isActive ? 'visible' : 'hidden'}>\n<div className=\"p-2 flex flex-col gap-2 h-full\">\n<div className=\" d-flex flex-column gap-2\">\n<div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n<div>\n<h4>Chats</h4>\n</div>\n<div className=\"d-flex \">\n\n<button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155\" />\n</svg>\n</button> \n<button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z\" />\n</svg>\n</button>\n</div>\n</div>\n<div className=\"relative flex flex-col\">\n<div>\n</div>\n</div>\n{sortedChatsWithUserData.map((chat, index) => (\n  <div key={index} className=\"relative\">\n  <button\n    className=\"chatbutton-history\"\n    onClick={() => handleChatButtonClick(chat.otherUserID, currentUserUID)}\n  >\n    <div className='d-flex'>\n      <div className=\"avatar-wrapper\">\n        <div className={`avatar-inner ${unreadMessages[index] || callingUserID === chat.otherUserID ? 'unread-border-overlay' : ''}`}>\n          <img\n            src={chat.userData?.photoURL || `${process.env.PUBLIC_URL}/images/arts/user.webp`}\n            alt=\"Avatar\"\n            className=\"small-avatar-mobile rounded-circle\"\n          />\n        </div>\n      </div>\n      <div className='button-align'>\n        <p className=\"font-weight-bold mb-0 text-start ms-2\">{chat.userData?.displayName}</p>\n        <p className=\"text-start ms-2\">{latestMessageTimes[chat.id]}</p> {/* Display the timestamp here */}\n      </div>\n            </div>\n\n      <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              color=\"#212529\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              strokeWidth={1}\n              stroke=\"currentColor\"\n              height=\"25\"\n              width=\"25\"\n              onClick={(event) => handleDeleteChat(chat.id, event)}\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                d=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\n              />\n            </svg>\n            </button>\n      </div>\n))}\n\n\n\n</div>\n</div>\n</div>\n);\n};\nexport default ChatHistory;\n","import React, { useState, useEffect } from 'react';\nimport { collection, getDoc, doc, updateDoc } from 'firebase/firestore';\nimport { Link } from 'react-router-dom';\nimport { firestore, auth } from '../firebase';\n\nimport Fuse from 'fuse.js';\n\nconst Contacts = ({ toggleRightColumnVisibility }) => {\n  const [showContacts, setShowContacts] = useState(false);\n  const [contacts, setContacts] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n\n  useEffect(() => {\n    const fetchContacts = async () => {\n      const authUser = auth.currentUser;\n      if (!authUser) {\n        console.error('User is not authenticated');\n        return;\n      }\n\n      let userDocument;\n\n      // Check if the authenticated user is in userProfiles or expertApplications\n      const userProfilesCollection = collection(firestore, 'userProfiles');\n      const expertApplicationsCollection = collection(firestore, 'expertApplications');\n      const userProfileDoc = doc(userProfilesCollection, authUser.uid);\n      const expertApplicationDoc = doc(expertApplicationsCollection, authUser.uid);\n\n      const userProfileSnapshot = await getDoc(userProfileDoc);\n      const expertApplicationSnapshot = await getDoc(expertApplicationDoc);\n\n      if (userProfileSnapshot.exists()) {\n        userDocument = userProfileDoc;\n      } else if (expertApplicationSnapshot.exists()) {\n        userDocument = expertApplicationDoc;\n      } else {\n        console.error('User document not found in either userProfiles or expertApplications');\n        return;\n      }\n\n      const userDocRef = doc(firestore, userDocument.path);\n      const userDocSnap = await getDoc(userDocRef);\n\n      if (userDocSnap.exists()) {\n        const userData = userDocSnap.data();\n        const contactsData = userData.contacts || {};\n\n        // Fetch contact details for each contact UID\n        const contactPromises = Object.keys(contactsData).map(async (contactUID) => {\n          const contactSnapshot = await getDoc(doc(firestore, 'userProfiles', contactUID));\n\n          if (contactSnapshot.exists()) {\n            return { ...contactSnapshot.data(), otherUserUID: contactSnapshot.id };\n          }\n\n          const expertSnapshot = await getDoc(doc(firestore, 'expertApplications', contactUID));\n\n          if (expertSnapshot.exists()) {\n            return { ...expertSnapshot.data(), otherUserUID: expertSnapshot.id };\n          }\n\n          return null;\n        });\n\n        const fetchedContacts = await Promise.all(contactPromises);\n        setContacts(fetchedContacts.filter(Boolean)); // Filter out null values\n      }\n    };\n\n    fetchContacts();\n  }, []);\n\n  useEffect(() => {\n    if (searchQuery.trim() !== '') {\n      const fuseOptions = {\n        keys: ['displayName', 'occupation', 'keywords'],\n        includeScore: true,\n        includeMatches: true,\n        threshold: 0.4,\n      };\n  \n      const fuse = new Fuse(contacts, fuseOptions);\n      const searchResults = fuse.search(searchQuery).map((result) => result.item);\n  \n      setSearchResults(searchResults);\n    } else {\n      setSearchResults(contacts);\n    }\n  }, [searchQuery, contacts]);\n  \n\n  const handleSearchInputChange = (e) => {\n    setSearchQuery(e.target.value);\n  };\n\n  const handleSearchKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      toggleRightColumnVisibility();\n    }\n  };\n\n  const handleButtonClick = async (result) => {\n    toggleRightColumnVisibility();\n\n    try {\n      const expertAppsRef = collection(firestore, 'expertApplications');\n      const expertDocSnap = await getDoc(doc(expertAppsRef, result.otherUserUID));\n\n      console.log('Expert Doc Snap:', expertDocSnap.data());\n\n      if (expertDocSnap.exists()) {\n        const customURL = expertDocSnap.data().customURL;\n        console.log('Custom URL:', customURL);\n        window.location.href = `/expert/${customURL}`; // Use React Router's Link path\n      } else {\n        const userProfilesRef = collection(firestore, 'userProfiles');\n        const userDocSnap = await getDoc(doc(userProfilesRef, result.otherUserUID));\n\n        console.log('User Doc Snap:', userDocSnap.data());\n\n        if (userDocSnap.exists()) {\n          const customURL = userDocSnap.data().customURL;\n          console.log('Custom URL:', customURL);\n          window.location.href = `/user/${customURL}`; // Use React Router's Link path\n        } else {\n          console.log('User profile not found for the specified UID.');\n        }\n      }\n    } catch (error) {\n      console.error('Error handling button click:', error.message);\n    }\n  };\n\n  const handleDeleteContact = async (contactUID) => {\n    try {\n      const authUser = auth.currentUser;\n      if (!authUser) {\n        console.error('User is not authenticated');\n        return;\n      }\n  \n      let userDocument;\n  \n      // Check if the authenticated user is in userProfiles or expertApplications\n      const userProfilesCollection = collection(firestore, 'userProfiles');\n      const expertApplicationsCollection = collection(firestore, 'expertApplications');\n      const userProfileDoc = doc(userProfilesCollection, authUser.uid);\n      const expertApplicationDoc = doc(expertApplicationsCollection, authUser.uid);\n  \n      const userProfileSnapshot = await getDoc(userProfileDoc);\n      const expertApplicationSnapshot = await getDoc(expertApplicationDoc);\n  \n      if (userProfileSnapshot.exists()) {\n        userDocument = userProfileDoc;\n      } else if (expertApplicationSnapshot.exists()) {\n        userDocument = expertApplicationDoc;\n      } else {\n        console.error('User document not found in either userProfiles or expertApplications');\n        return;\n      }\n  \n      const userDocRef = doc(firestore, userDocument.path);\n      const userDocSnap = await getDoc(userDocRef);\n  \n      if (userDocSnap.exists()) {\n        const userData = userDocSnap.data();\n        const contactsData = userData.contacts || {};\n  \n        // Remove the contactUID from the user's contacts\n        delete contactsData[contactUID];\n  \n        // Update the user's document in Firestore\n        await updateDoc(userDocRef, { contacts: contactsData });\n  \n        // Update the local state after deleting the contact from the user's contacts in Firestore\n        setContacts(contacts.filter((contact) => contact.otherUserUID !== contactUID));\n        setSearchResults(searchResults.filter((result) => result.otherUserUID !== contactUID));\n      }\n    } catch (error) {\n      console.error('Error deleting contact:', error.message);\n    }\n  };\n  \n  \n  return (\n    <div className=\"d-flex flex-column gap-2 mt-3\">\n      <div className=\"input-container\">\n        <input\n          type=\"text\"\n          className=\"chat-search-input\"\n          placeholder=\"Search for Experts\"\n          value={searchQuery}\n          onChange={handleSearchInputChange}\n          onKeyDown={handleSearchKeyPress}\n        />\n      </div>\n      <div className=\"contacts-list\">\n      {searchResults.map((result, index) => (\n  <Link key={index}>\n    <button\n     className=\"chatbutton-history\"\n      onClick={() => handleButtonClick(result)}\n    >\n       <div className='d-flex'>\n          <div className=\"small-avatar\">\n            <img\n              src={result.photoURL || 'avatar.png'}\n              alt=\"Avatar\"\n              className=\"w-100 h-auto rounded-circle\"\n              style={{ maxWidth: '12rem' }}\n            />\n        </div>\n            <div className='button-align'>\n              <p className=\"font-weight-bold mb-0 text-start ms-2\">{result.displayName}</p>\n              <p className=\"font-weight-bold mb-0 ms-2 text-muted\">{result.occupation}</p>\n            </div>\n            </div>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              color=\"#212529\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              strokeWidth={1}\n              stroke=\"currentColor\"\n              height=\"25\"\n              width=\"25\"\n              onClick={(e) => {\n                e.preventDefault(); // Prevent the default behavior, which may cause page reload\n                e.stopPropagation(); // Prevent the parent button's onClick event from being triggered\n                handleDeleteContact(result.otherUserUID);\n              }}\n              >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                d=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\n              />\n            </svg>\n\n    </button>\n  </Link>\n))}\n\n      </div>\n    </div>\n  );\n};\n\nexport default Contacts;\n","import React, { useEffect, useState } from 'react';\nimport { auth, firestore } from '../firebase'; \nimport { doc, getDoc } from 'firebase/firestore';\n\nconst Profile = () => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [description, setDescription] = useState('');\n  const [city, setCity] = useState('');\n  const [email, setEmail] = useState('');\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(async (user) => {\n      if (user) {\n        setCurrentUser(user);\n\n        // Check if user exists in expertApplications collection\n        const expertProfileRef = doc(firestore, 'expertApplications', user.uid);\n        const expertProfileSnapshot = await getDoc(expertProfileRef);\n\n        if (expertProfileSnapshot.exists()) {\n          const expertProfileData = expertProfileSnapshot.data();\n          setDescription(expertProfileData.description || ''); // Set description from expertApplications\n          setCity(expertProfileData.city || ''); // Set city from expertApplications\n          setEmail(expertProfileData.email || ''); // Set city from expertApplications\n        } else {\n          // If user not found in expertApplications, check in userProfiles collection\n          const userProfileRef = doc(firestore, 'userProfiles', user.uid);\n          const userProfileSnapshot = await getDoc(userProfileRef);\n\n          if (userProfileSnapshot.exists()) {\n            const userProfileData = userProfileSnapshot.data();\n            setDescription(userProfileData.description || ''); // Set description from userProfiles\n            setCity(userProfileData.city || ''); // Set city from userProfiles\n            setEmail(userProfileData.email || ''); // Set city from userProfiles\n          } else {\n            // Handle case where user doesn't exist in either collection\n            setDescription('Description not found');\n            setCity('City not found');\n          }\n        }\n      } else {\n        setCurrentUser(null);\n        setDescription('');\n        setCity('');\n        setEmail('');\n      }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n  }, []);\n\n\n  return (\n    <div className=\"d-flex flex-column gap-2 mt-3\">\n      <div className=\"justify-content-center align-items-center px-8\">\n        <div className=\"text-center\">\n          {currentUser && currentUser.photoURL && (\n            <img\n              className=\"medium-avatar mx-auto user-avatar mb-2\"\n              src={currentUser.photoURL}\n              alt=\"User Avatar\"\n            />\n          )}\n          {currentUser && currentUser.displayName && (\n            <>\n              <h4>{currentUser.displayName}</h4>\n              <p className='text-muted'>{description}</p> {/* Display bio here */}\n              <hr className=\"avatar-divider\" />\n            </>\n          )}\n        </div>\n\n\n</div>\n<div\n    className=\"langauges-spacing chat-btn-profile \"\n      style={{ transform: 'none' }}\n\n    >\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={2} stroke=\"currentColor\" height=\"30\" width=\"30\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75\" />\n            </svg>\n            {email}\n    </div>\n    <div\n   className=\"langauges-spacing chat-btn-profile \"\n      style={{ transform: 'none' }}\n\n    >\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\"  fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={2} stroke=\"currentColor\" height=\"30\" width=\"30\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z\" />\n  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z\" />\n            </svg>\n\n            {city}\n\n    </div>\n</div>\n\n  \n  );\n};\n\nexport default Profile;\n","import React, { useEffect, useState } from 'react';\nimport ChatHistory from './ChatHistory';\nimport Contacts from './Contacts';\nimport Profile from './Profile';\n\nconst MiddleColumn = ({ selectedMenu, toggleRightColumnVisibility,  updateOtherUserID, isMiddleColumnVisible, setActiveButton, otherUserUID, currentUserUID}) => {\n  const [currentMenu, setCurrentMenu] = useState(selectedMenu);\n  const [isVisible, setIsVisible] = useState(true);\n  const [isChatVisible, setIsChatVisible] = useState(true);\n\n  useEffect(() => {\n    setIsVisible(false);\n    const timeoutId = setTimeout(() => {\n      setCurrentMenu(selectedMenu);\n      setIsVisible(true);\n      setIsChatVisible(selectedMenu === 'Chat History'); // Set Chat visibility based on selectedMenu\n    }, 300);\n\n    return () => clearTimeout(timeoutId);\n  }, [selectedMenu]);\n\n  const switchToChatHistory = (updateActiveButton) => {\n    setCurrentMenu('Chat History');\n    setIsChatVisible(true);\n    updateActiveButton('Chat History'); // Update the active button in the parent component\n  };\n\n  return (\n    <div className={`chat-middle pt-4 ${isMiddleColumnVisible ? '' : 'hide'}`}>\n      <div className={`chat-component ${isVisible && isChatVisible ? 'visible' : 'hidden'}`}>\n        {currentMenu === 'Chat History' && (\n          <ChatHistory otherUserUID={otherUserUID}  updateOtherUserID={updateOtherUserID}  toggleRightColumnVisibility={toggleRightColumnVisibility} currentUserUID={currentUserUID}/>\n        )}\n      </div>\n      <div className={`contacts-component ${isVisible && !isChatVisible ? 'visible' : 'hidden'}`}>\n      {currentMenu === 'Contacts' && (\n          <Contacts switchToChatHistory={switchToChatHistory} setActiveButton={setActiveButton} toggleRightColumnVisibility={toggleRightColumnVisibility}  />\n        )}\n      </div>\n      <div className={`profile-component ${isVisible && currentMenu === 'Profile' ? 'visible' : 'hidden'}`}>\n        {currentMenu === 'Profile' && <Profile />}\n      </div>\n    </div>\n  );\n};\n\nexport default MiddleColumn;\n","import React, { useEffect, useState } from 'react';\nimport { collection, getDocs, query, orderBy, doc, getDoc } from 'firebase/firestore';\nimport { firestore, auth } from '../firebase';\nimport ReactMarkdown from 'react-markdown';\nimport LoadingCircle from '../components/LoadingCircle';\n\nconst ChatServiceconversation = ({ selectedSession, currentUserUID, otherUserUID, closeShareChat }) => {\n  const [sharedChatData, setSharedChatData] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [selectedMessageUID, setSelectedMessageUID] = useState(null);\n\n  useEffect(() => {\n    const determineSelectedMessageUID = async () => {\n      try {\n        const expertAppDocRef = doc(collection(firestore, 'expertApplications'), currentUserUID);\n        const expertAppSnapshot = await getDoc(expertAppDocRef);\n  \n        // Set selectedMessageUID based on the presence of currentUserUID in the expertApplications collection\n        setSelectedMessageUID(expertAppSnapshot.exists() ? otherUserUID : currentUserUID);\n  \n        console.log('Determining selectedMessageUID:', {\n          otherUserUID,\n          currentUserUID,\n          existsInExpertApplications: expertAppSnapshot.exists(),\n          determinedMessageUID: expertAppSnapshot.exists() ? otherUserUID : currentUserUID,\n        });\n      } catch (error) {\n        console.error('Error determining selectedMessageUID:', error);\n      }\n    };\n  \n    determineSelectedMessageUID();\n  }, [currentUserUID, otherUserUID]);\n\n  \n  useEffect(() => {\n    const fetchSharedChatData = async () => {\n      try {\n        if (selectedSession && selectedMessageUID) { // Check if selectedMessageUID is defined\n          const messagesCollectionRef = collection(firestore, 'users', selectedMessageUID, 'discussions', selectedSession, 'messages');\n          console.log('Path for messagesCollectionRef:', messagesCollectionRef.path); // Log the path\n          const messagesSnapshot = await getDocs(query(messagesCollectionRef, orderBy('createTime')));\n          const messagesData = messagesSnapshot.docs.map((doc) => {\n            const { prompt, response } = doc.data();\n            return { prompt, response };\n          });\n          setSharedChatData(messagesData);\n          setIsLoading(false); // Set loading to false when data is fetched\n          console.log('Fetched messages for discussionId:', selectedSession, messagesData);\n        }\n      } catch (error) {\n        console.error('Error fetching shared chat messages:', error);\n        setIsLoading(false); // Set loading to false on error\n      }\n    };\n  \n    fetchSharedChatData();\n  }, [selectedSession, selectedMessageUID]); // Include selectedMessageUID in the dependencies array\n  \n\n  if (!selectedMessageUID) {\n    return null; // or render a loading state if needed until selectedMessageUID is determined\n  }\n\n  return (\n   <div className=\"blurred-background\">\n    <div className=\"white-box-chathistory\">\n      <div className=\"go-back-svg go-back-svg-padding\">\n        <button onClick={closeShareChat}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} color=\"black\" stroke=\"currentColor\" className=\"w-6 h-6\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </button>\n      </div>\n\n      <h2>Share link to Chat</h2>\n      <div className='divider '></div>\n      <p>\n        Messages you send after creating your link won't be shared. Anyone with the URL will be able to view the shared chat.\n      </p>\n      <div className=\"shared-chat scroll-cat\">\n        {isLoading ? (\n          <LoadingCircle />\n        ) : (\n          sharedChatData.map((message, index) => (\n            <div key={index} className=\"chat-message\">\n              <strong>\n                <ReactMarkdown>{message.prompt}</ReactMarkdown>\n\n              </strong>\n              <ReactMarkdown>{message.response}</ReactMarkdown>\n              <div className='divider '></div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n    </div>\n  );\n};\n\nexport default ChatServiceconversation;\n","import { db, collection, doc, onSnapshot, setDoc, serverTimestamp, updateDoc, getDoc, query, where, addDoc } from '../firebase';\nimport { getStorage, ref, uploadBytes, getDownloadURL } from 'firebase/storage';\n\nconst storage = getStorage(); \n\nconst chatsCollection = collection(db, 'chats');\n\nconst createChatID = (currentUserUID, otherUserUID) => {\n  return currentUserUID < otherUserUID\n    ? `${currentUserUID}_${otherUserUID}`\n    : `${otherUserUID}_${currentUserUID}`;\n};\n\nconst sendMessage = async (currentUserUID, otherUserUID, messageText, selectedFile) => {\n  try {\n    const chatID = createChatID(currentUserUID, otherUserUID);\n    const chatDocRef = doc(chatsCollection, chatID);\n\n    // Check if the chat document exists, and create it if it doesn't\n    const chatDocSnapshot = await getDoc(chatDocRef);\n    if (!chatDocSnapshot.exists()) {\n      await setDoc(chatDocRef, {\n        users: [currentUserUID, otherUserUID],\n        createdAt: serverTimestamp(),\n      });\n    }\n\n    // Check if a file is present\n    if (selectedFile) {\n      const storageRef = ref(storage, `chat_files/${currentUserUID}/${otherUserUID}/${Date.now()}_${selectedFile.name}`);\n\n      // Upload the file to the specified storage location\n      await uploadBytes(storageRef, selectedFile);\n\n      // Get the download URL for the uploaded file\n      const downloadURL = await getDownloadURL(storageRef);\n\n      // Include this download URL in your message object\n      const messageObject = {\n        text: messageText,\n        file: {\n          name: selectedFile.name,\n          type: selectedFile.type,\n          url: downloadURL,\n        },\n        sender: currentUserUID,\n        receiver: otherUserUID,\n        timestamp: serverTimestamp(),\n        isRead: false,\n      };\n\n      // Then add the message to the 'messages' subcollection\n      const messagesCollectionRef = collection(chatDocRef, 'messages');\n      await addDoc(messagesCollectionRef, messageObject);\n    } else {\n      // Handle text messages\n      const messageObject = {\n        text: messageText,\n        sender: currentUserUID,\n        receiver: otherUserUID,\n        timestamp: serverTimestamp(),\n        isRead: false,\n      };\n\n      // Then add the message to the 'messages' subcollection\n      const messagesCollectionRef = collection(chatDocRef, 'messages');\n      await addDoc(messagesCollectionRef, messageObject);\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Error sending message:', error);\n    return false;\n  }\n};\n\n\nconst getMessages = (currentUserUID, otherUserUID, callback) => {\n  try {\n    const chatID = createChatID(currentUserUID, otherUserUID);\n    const chatDocRef = doc(chatsCollection, chatID);\n    const messagesCollectionRef = collection(chatDocRef, 'messages');\n\n    onSnapshot(messagesCollectionRef, (snapshot) => {\n      try {\n        const messages = snapshot.docs.map((doc) => {\n          return { id: doc.id, ...doc.data() };\n        });\n        const allMessages = messages.sort((a, b) => b.timestamp - a.timestamp);\n        const reversedMessages = allMessages.reverse();\n        callback(reversedMessages);\n      } catch (error) {\n        console.error('Error getting messages:', error);\n        callback([]); // Handle errors by returning an empty array or taking appropriate action\n      }\n    });\n  } catch (error) {\n    console.error('Error getting messages:', error);\n    callback([]); // Handle errors by returning an empty array or taking appropriate action\n  }\n};\n\nconst markMessageAsRead = async (currentUserUID, otherUserUID, messages) => {\n  try {\n    const chatID = createChatID(currentUserUID, otherUserUID);\n    const chatDocRef = doc(chatsCollection, chatID);\n    const messagesCollectionRef = collection(chatDocRef, 'messages');\n\n    // Loop through each message\n    messages.forEach(async (message) => {\n      // Check if the message has already been marked as read\n      if (!message.isRead && message.receiver === currentUserUID) {\n        // If the current user is the receiver and the message is unread, mark it as read\n        const messageDocRef = doc(messagesCollectionRef, message.id);\n        await updateDoc(messageDocRef, { isRead: true });\n        console.log('Message marked as read:', message.id);\n      }\n    });\n  } catch (error) {\n    console.error('Error marking messages as read:', error);\n  }\n};\n\nexport { sendMessage, getMessages, markMessageAsRead };\n","import React, { useState, useEffect, useRef } from 'react';\nimport { sendMessage, getMessages, markMessageAsRead } from './ChatService';\nimport { auth, onAuthStateChanged, db } from '../firebase';\nimport { onSnapshot, collection, getDocs } from 'firebase/firestore';\n\n\nconst ChatContainerCalls = ({ otherUserUID }) => {\n  const [messages, setMessages] = useState([]);\n  const chatBoxRef = useRef(null);\n  const messageInputRef = useRef(null);\n  const [inputValue, setInputValue] = useState('');\n  const [currentUserUID, setCurrentUserUID] = useState(null);\n  const [isChattingWithSelf, setIsChattingWithSelf] = useState(false);\n  const [textareaHeight, setTextareaHeight] = useState('28px');\n  const maxTextareaHeight = 200;\n\n  const [selectedFile, setSelectedFile] = useState(null);\n  const fileInputRef = useRef(null);\n  const [selectedFilePreview, setSelectedFilePreview] = useState(null);\n  const [lastSeenMessageId, setLastSeenMessageId] = useState(null);\n\n  const [initialLoad, setInitialLoad] = useState(true);\n\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      if (user) {\n        setCurrentUserUID(user.uid);\n      } else {\n        setCurrentUserUID(null);\n      }\n    });\n    return () => unsubscribe(); // Clean up the listener\n  }, []);\n\n  useEffect(() => {\n    setIsChattingWithSelf(currentUserUID === otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        // Reverse the messages here and then set them in the state\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n\n        // Scroll to bottom when new messages are fetched\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n  \n\n  const isMobile = window.innerWidth <= 767; // Adjust the width threshold as needed\n\n  const handleFileUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      setSelectedFile(file);\n      if (file.type && file.type.startsWith('image/')) {\n        // It's an image, no need to display anything\n        setSelectedFilePreview(null);\n      } else {\n        // It's not an image, display the SVG icon and file name\n        setSelectedFilePreview({\n          name: file.name,\n          type: 'file',\n        });\n      }\n    }\n  };\n  \n\n  useEffect(() => {\n    if (selectedFile && selectedFile.type && selectedFile.type.startsWith('image/')) {\n      const reader = new FileReader();\n      reader.onload = (event) => {\n        setSelectedFilePreview(event.target.result);\n      };\n      reader.readAsDataURL(selectedFile);\n    } else {\n      setSelectedFilePreview(null);\n    }\n  }, [selectedFile]);\n  \n\n  const handleMessageSend = async () => {\n    try {\n      if (isChattingWithSelf) {\n        console.error(\"Cannot send messages to yourself.\");\n        console.log('currentUserUID:', currentUserUID);\n        console.log('otherUserUID:', otherUserUID);\n        return;\n      }\n  \n      if (inputValue.trim() === '' && !selectedFile) {\n        return;\n      }\n  \n      if (currentUserUID && otherUserUID) {\n        const success = await sendMessage(currentUserUID, otherUserUID, inputValue, selectedFile);\n        if (success) {\n          setInputValue('');\n          setSelectedFile(null);\n          // Clear the image preview in the userui-input\n          setSelectedFilePreview(null);\n  \n          if (!isMobile) {\n            messageInputRef.current.focus();\n          }\n        }\n      } else {\n        console.error('currentUserUID or otherUserUID is undefined');\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  \n  \n  const scrollToBottom = () => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.scrollTop = chatBoxRef.current.scrollHeight;\n    }\n  };\n  \n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleTextareaResize = () => {\n    const textarea = messageInputRef.current;\n    if (textarea) {\n      const newHeight = Math.min(textarea.scrollHeight, maxTextareaHeight);\n      setTextareaHeight(`${newHeight}px`);\n    }\n  };\n  \n  \n  \n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n  \n\n  const handleInputChange = (e) => {\n    setInputValue(e.target.value);\n    handleTextareaResize();\n  };\n\n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n\n  useEffect(() => {\n    if (inputValue === '') {\n      setTextareaHeight('28px');\n    }\n  }, [inputValue]);\n\n  const formatTimestamp = (timestamp) => {\n    if (timestamp) {\n      const date = timestamp.toDate();\n      const hours = date.getHours().toString().padStart(2, '0'); // Get hours in 24-hour format\n      const minutes = date.getMinutes().toString().padStart(2, '0'); // Get minutes\n      return `${hours}:${minutes}`; // Format to HH:MM\n    }\n    return ''; // Return an empty string if the timestamp is not available\n  };\n\n  const handleScroll = () => {\n    // Calculate the last seen message based on scroll position\n    if (chatBoxRef.current) {\n      const { scrollTop, scrollHeight, clientHeight } = chatBoxRef.current;\n      const lastVisibleMessageIndex = Math.floor(scrollTop / clientHeight);\n      if (lastVisibleMessageIndex >= 0 && lastVisibleMessageIndex < messages.length) {\n        const lastSeenMessage = messages[lastVisibleMessageIndex];\n        setLastSeenMessageId(lastSeenMessage.id);\n      }\n    }\n  };\n  useEffect(() => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.addEventListener('scroll', handleScroll);\n    }\n    return () => {\n      if (chatBoxRef.current) {\n        chatBoxRef.current.removeEventListener('scroll', handleScroll);\n      }\n    };\n  }, [chatBoxRef, messages]); // Add messages to dependency array\n\n\n\n  \n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  \n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID, messages, lastSeenMessageId); // Pass lastSeenMessageId\n  }, [messages, currentUserUID, otherUserUID, lastSeenMessageId]);\n\n\n  return (\n\n      <div className=\"chat-column chat-column-video\">\n        <div className=\"chat-box chat-box-video\" ref={chatBoxRef}>\n    {Array.isArray(messages) && messages.length > 0 ? (\n  messages.map((message, index) =>\n    message.timestamp ? (\n      <div\n        key={index}\n        className={message.sender === currentUserUID ? 'chat-bubble user-sent' : 'chat-bubble'}\n      >\n        <div className=\"message\">\n          {message.file && message.file.type && message.file.type.startsWith('image/') ? (\n            <img\n              src={message.file.url}\n              alt=\"Image\"\n              className=\"rounded-image\"\n            />\n          ) : (\n            message.file && (\n              <div className=\"file-container\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  color=\"#212529\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  strokeWidth={1}\n                  stroke=\"currentColor\"\n                  height=\"25\"\n                  width=\"25\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                  />\n                </svg>\n                <a\n                  href={message.file.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  {message.file.name}\n                </a>\n              </div>\n            )\n          )}\n          {message.text && <p>{message.text}</p>}\n        </div>\n        <div\n          className={`timestamp small-timestamp ${\n            message.sender === currentUserUID ? 'user-sent-timestamp' : 'other-sent-timestamp'\n          }`}\n        >\n          {formatTimestamp(message.timestamp)}\n        </div>\n      </div>\n    ) : null\n  )\n) : (\n  <div>No messages yet.</div>\n)}\n\n\n        </div>\n        <div className=\"chatui-container\">\n    \n            <input\n              type=\"file\"\n              onChange={(e) => handleFileUpload(e)}\n              style={{ display: 'none' }}\n              ref={fileInputRef}\n            />\n            <button className=\"userui-left-button\" onClick={() => fileInputRef.current.click()}>\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                color=\"#212529\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth={1}\n                stroke=\"currentColor\"\n                height=\"25\"\n                width=\"25\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                />\n              </svg>\n            </button>\n            <button\n              aria-label=\"Send Message\"\n              onClick={handleMessageSend}\n              className=\" userui-right-button \"\n            >\n              <i className=\"fas fa-paper-plane\"></i>\n            </button>\n            <div id=\"messageInputContainer\">\n  {selectedFile && (\n    <div className=\"file-info\">\n      {selectedFile.type.startsWith('image/') && (\n        <div className=\"image-preview-container\">\n          <img\n            src={URL.createObjectURL(new Blob([selectedFile], { type: selectedFile.type }))}\n            alt=\"Image Preview\"\n            style={{ maxWidth: '70%', height: 'auto' }}\n          />\n        </div>\n      )}\n      {!selectedFile.type.startsWith('image/') && (\n        <div className=\"file-details\">\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n            />\n          </svg>\n          <span>{selectedFile.name}</span>\n        </div>\n      )}\n<button className=\"remove-button\" onClick={() => setSelectedFile(null)}>X</button>\n    </div>\n  )}\n\n</div>\n\n       \n            <textarea\n  type=\"text\"\n  placeholder=\"Type a message...\"\n  ref={messageInputRef}\n  style={{ height: textareaHeight }}  // <-- Use the style attribute\n  value={inputValue}\n  onChange={handleInputChange}\n  onKeyDown={(e) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleMessageSend();\n    }\n  }}\n  className=\"message-input scroll-col\"\n  autoComplete=\"off\"\n  inputMode=\"text\"\n/>\n\n          </div>\n          \n          </div>\n\n  \n  );\n};\n\nexport default ChatContainerCalls;\n","import React, { useEffect, useRef, useState } from 'react';\nimport { db, auth } from '../firebase';\nimport { collection, doc, setDoc, getDoc, onSnapshot, getDocs, deleteDoc, updateDoc } from 'firebase/firestore';\nimport ChatContainerCalls from './ChatContainerCall';\n\nconst VideoChatApp = ({ currentUserUID, otherUserUID, onClose, userData }) => {\nconst localVideoRef = useRef(null);\nconst remoteVideoRef = useRef(null);\n\nconst [peerConnection, setPeerConnection] = useState(null);\nconst [localStream, setLocalStream] = useState(null);\nconst [remoteStream, setRemoteStream] = useState(null);\nconst [roomId, setRoomId] = useState(null);\nconst [isCreatingRoom, setIsCreatingRoom] = useState(false);\nconst [isJoiningRoom, setIsJoiningRoom] = useState(false);\nconst [roomIdToJoin, setRoomIdToJoin] = useState('');\n\nconst [roomName, setRoomName] = useState('');\nconst [roomExists, setRoomExists] = useState(false);\nconst [showJoinButton, setShowJoinButton] = useState(false);\nconst [callToJoin, setCallToJoin] = useState(false);\nconst [isVideoEnabled, setIsVideoEnabled] = useState(false);\nconst [isAudioEnabled, setIsAudioEnabled] = useState(true);\nconst [inCall, setInCall] = useState(false);\nconst [currentUser, setCurrentUser] = useState(null);\nconst [isCalleeJoined, setIsCalleeJoined] = useState(false);\nconst [isRemoteVideoAvailable, setIsRemoteVideoAvailable] = useState(false);\n\nconst [showChat, setShowChat] = useState(false);\n\n\n\n\n\n\n\nlet calleeCandidatesUnsubscribe = null;\nlet callerCandidatesUnsubscribe = null;\n\nconst configuration = {\n  iceServers: [\n    {\n      urls: [\n        'stun:stun.l.google.com:19302',\n        'stun:stun1.l.google.com:19302',\n        'stun:stun2.l.google.com:19302',\n        'stun:stun3.l.google.com:19302',\n        'stun:stun4.l.google.com:19302',\n      ]\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:443\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turns:standard.relay.metered.ca:443?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n  ],\n  iceCandidatePoolSize: 10,\n};\nuseEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n    if (user) {\n        setCurrentUser(user); // Set the current user when authenticated\n    } else {\n        setCurrentUser(null); // Reset the current user if not authenticated\n    }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n}, []);\n\nuseEffect(() => {\n  const openUserMedia = async () => {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true,\n    });\n  \n    if (localVideoRef.current) {\n      localVideoRef.current.srcObject = stream;\n    }\n  \n    setLocalStream(stream);\n    setRemoteStream(new MediaStream());\n  \n    if (remoteVideoRef.current) {\n      remoteVideoRef.current.srcObject = remoteStream;\n    }\n  \n    if (localVideoRef.current && localVideoRef.current.srcObject) { // Add null check for console.log\n      console.log(\"Stream:\", localVideoRef.current.srcObject);\n    }\n  \n    setIsVideoEnabled(false); // Add this line\n  };\n  \n  \n    openUserMedia();\n  \n    // Clean up function\n    return () => {\n      hangUp();\n    };\n  }, [currentUserUID, otherUserUID]);\n  \n  \n\n\n\nuseEffect(() => {\n    const checkRoomExists = async () => {\n    const roomRef = doc(collection(db, 'rooms'), roomIdToJoin);\n    const roomSnapshot = await getDoc(roomRef);\n    setRoomExists(roomSnapshot.exists());\n    };\n\n    if (roomIdToJoin) {\n    checkRoomExists();\n    }\n}, [roomIdToJoin]);\n\nuseEffect(() => {\n    // Listen for room creation on the callee side\n    const roomsCollection = collection(db, 'rooms');\n    const unsubscribe = onSnapshot(roomsCollection, (snapshot) => {\n    snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n        const roomData = change.doc.data();\n        const roomId = change.doc.id;\n        const swappedRoomId = `${currentUserUID}_${otherUserUID}`;\n        if (roomId === swappedRoomId) {\n            setShowJoinButton(true);\n            setRoomId(roomId);\n            setCallToJoin(true);\n        }\n        }\n    });\n    });\n\n    // Clean up the listener on component unmount\n    return () => unsubscribe();\n}, [currentUserUID, otherUserUID]);\n\nconst createRoom = async () => {\n    // Set the room ID to otherUserUID_currentUserUID\n    const roomId = `${otherUserUID}_${currentUserUID}`;\n  \n    setIsCreatingRoom(true);\n    const roomRef = doc(collection(db, 'rooms'), roomId);\n  \n    const newPeerConnection = new RTCPeerConnection(configuration);\n    setPeerConnection(newPeerConnection);\n  \n    registerPeerConnectionListeners(newPeerConnection);\n  \n    localStream.getTracks().forEach(track => {\n      newPeerConnection.addTrack(track, localStream);\n    });\n  \n    // Create a reference to the videoCallStatus document\n    const videoCallStatusDocRef = doc(db, 'videoCallStatus', roomId);\n  \n    // First, get the document\n    const docSnap = await getDoc(videoCallStatusDocRef);\n  \n    if (!docSnap.exists()) {\n      // If the document doesn't exist, create it\n      await setDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: true,\n        },\n        [otherUserUID]: {\n          isEnabled: true,\n        },\n      });\n    } else {\n      // If the document exists, update it\n      await updateDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: true,\n        },\n        [otherUserUID]: {\n          isEnabled: true,\n        },\n      }, { merge: true });\n    }\n  \n    // Code for collecting ICE candidates\n    const callerCandidatesCollection = collection(db, 'rooms', roomRef.id, 'callerCandidates');\n  \n    newPeerConnection.addEventListener('icecandidate', event => {\n      if (!event.candidate) {\n        console.log('Got final candidate!');\n        return;\n      }\n      console.log('Got candidate: ', event.candidate);\n      if (newPeerConnection.signalingState !== 'closed') {\n        setDoc(doc(callerCandidatesCollection), event.candidate.toJSON());\n      }\n    });\n  \n    // Code for creating a room\n    const offer = await newPeerConnection.createOffer();\n    await newPeerConnection.setLocalDescription(offer);\n    console.log('Created offer:', offer);\n  \n    const roomWithOffer = {\n      'offer': {\n        type: offer.type,\n        sdp: offer.sdp,\n      },\n      'name': roomName, // Add the room name to the room data\n    };\n    await setDoc(roomRef, roomWithOffer);\n    setRoomId(roomRef.id);\n    console.log(`New room created with SDP offer. Room ID: ${roomRef.id}`);\n  \n    // Set remote stream as the srcObject of the remote video element\n    remoteVideoRef.current.srcObject = remoteStream;\n  \n    newPeerConnection.addEventListener('track', event => {\n      console.log('Got remote track:', event.streams[0]);\n      event.streams[0].getTracks().forEach(track => {\n        console.log('Add a track to the remoteStream:', track);\n        remoteStream.addTrack(track);\n      });\n    });\n  \n    // Listening for remote session description\n    onSnapshot(roomRef, async snapshot => {\n      const data = snapshot.data();\n      if (!newPeerConnection.currentRemoteDescription && data && data.answer) {\n        console.log('Got remote description: ', data.answer);\n        const rtcSessionDescription = new RTCSessionDescription(data.answer);\n        await newPeerConnection.setRemoteDescription(rtcSessionDescription);\n      }\n    });\n  \n    // Listen for remote ICE candidates\n    calleeCandidatesUnsubscribe = onSnapshot(collection(db, 'rooms', roomRef.id, 'calleeCandidates'), snapshot => {\n      snapshot.docChanges().forEach(async change => {\n        if (change.type === 'added') {\n    \n            setIsCalleeJoined(true);\n        \n          let data = change.doc.data();\n          console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n          if (newPeerConnection.signalingState !== 'closed') {\n            await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n          }\n        }\n      });\n    });\n    setInCall(true);\n    localStream.getVideoTracks()[0].enabled = true;\n    setIsVideoEnabled(true);\n  };\n  \n\nconst joinRoom = async () => {\n    // Set the room ID to currentUserUID_otherUserUID\n    const roomId = `${currentUserUID}_${otherUserUID}`;\n\n    if (roomId) {\n    setIsJoiningRoom(true);\n    const roomRef = doc(collection(db, 'rooms'), roomId);\n    const roomSnapshot = await getDoc(roomRef);\n\n    if (roomSnapshot.exists()) {\n        console.log('Got room:', roomSnapshot.data());\n        console.log('Create PeerConnection with configuration: ', configuration);\n        const newPeerConnection = new RTCPeerConnection(configuration);\n        setPeerConnection(newPeerConnection);\n        registerPeerConnectionListeners(newPeerConnection);\n        localStream.getTracks().forEach(track => {\n        newPeerConnection.addTrack(track, localStream);\n        });\n\n        // Code for collecting ICE candidates\n        const calleeCandidatesCollection = collection(db, 'rooms', roomId, 'calleeCandidates');\n        newPeerConnection.addEventListener('icecandidate', event => {\n        if (!event.candidate) {\n            console.log('Got final candidate!');\n            return;\n        }\n        console.log('Got candidate: ', event.candidate);\n        setDoc(doc(calleeCandidatesCollection), event.candidate.toJSON());\n        });\n\n        // Set remote stream as the srcObject of the remote video element\n        remoteVideoRef.current.srcObject = remoteStream;\n\n        newPeerConnection.addEventListener('track', event => {\n        console.log('Got remote track:', event.streams[0]);\n        event.streams[0].getTracks().forEach(track => {\n            console.log('Add a track to the remoteStream:', track);\n            remoteStream.addTrack(track);\n        });\n        });\n\n        // Code for creating SDP answer\n        const offer = roomSnapshot.data().offer;\n        console.log('Got offer:', offer);\n        await newPeerConnection.setRemoteDescription(new RTCSessionDescription(offer));\n        const answer = await newPeerConnection.createAnswer();\n        console.log('Created answer:', answer);\n        await newPeerConnection.setLocalDescription(answer);\n\n        const roomWithAnswer = {\n        answer: {\n            type: answer.type,\n            sdp: answer.sdp,\n        },\n        };\n        await setDoc(roomRef, roomWithAnswer, { merge: true });\n\n        // Listening for remote ICE candidates\n        const callerCandidatesCollection = collection(db, 'rooms', roomId, 'callerCandidates');\n        onSnapshot(callerCandidatesCollection, snapshot => {\n        snapshot.docChanges().forEach(async change => {\n            if (change.type === 'added') {\n            let data = change.doc.data();\n            console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n            if (newPeerConnection.signalingState !== 'closed') {\n                await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n            }\n            }\n        });\n        });\n\n        // Hide the join room button\n        setShowJoinButton(false);\n    } else {\n        console.log('Room not found');\n        setIsJoiningRoom(false);\n    }\n    } else {\n    console.error('Invalid room ID');\n    }\n    setInCall(true);\n    setIsVideoEnabled(true);\n    setIsCalleeJoined(true);\n};\n\n\n\n\nconst hangUp = async () => {\n    if (localStream) {\n      const tracks = localStream.getTracks();\n      tracks.forEach((track) => {\n        track.stop();\n      });\n    }\n  \n    if (remoteStream) {\n      remoteStream.getTracks().forEach((track) => track.stop());\n    }\n  \n    // Delete room on hangup\n    if (roomId) {\n      const calleeCandidates = await getDocs(\n        collection(db, \"rooms\", roomId, \"calleeCandidates\")\n      );\n      calleeCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const callerCandidates = await getDocs(\n        collection(db, \"rooms\", roomId, \"callerCandidates\")\n      );\n      callerCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const roomRef = doc(collection(db, \"rooms\"), roomId);\n      await deleteDoc(roomRef);\n  \n      // Delete videoCallStatus document\n      const videoCallStatusDocRef = doc(db, \"videoCallStatus\", roomId);\n      await deleteDoc(videoCallStatusDocRef);\n    }\n  \n    if (peerConnection) {\n      peerConnection.close();\n    }\n  \n    if (localVideoRef.current) {\n        localVideoRef.current.srcObject = null;\n        const profilePictureURL = currentUser?.photoURL || \"default-profile-picture.png\";\n        localVideoRef.current.poster = profilePictureURL;\n      }\n    \n      if (remoteVideoRef.current) {\n        remoteVideoRef.current.srcObject = null;\n      }\n    \n  \n    if (remoteVideoRef.current) {\n      remoteVideoRef.current.srcObject = null;\n    }\n  \n    // Remove the listeners\n    if (calleeCandidatesUnsubscribe) {\n      calleeCandidatesUnsubscribe();\n    }\n  \n    if (callerCandidatesUnsubscribe) {\n      callerCandidatesUnsubscribe();\n    }\n  \n    setIsCreatingRoom(false);\n    setIsJoiningRoom(false);\n    setRoomId(null);\n    setRoomIdToJoin(\"\");\n    setIsVideoEnabled(false);\n  };\n  \n  const handleHangUp = () => {\n    hangUp();\n    onClose();\n  };\n  \n\n\nconst registerPeerConnectionListeners = (pc) => {\n    pc.addEventListener('icegatheringstatechange', () => {\n    console.log(`ICE gathering state changed: ${pc.iceGatheringState}`);\n    });\n\n    pc.addEventListener('connectionstatechange', () => {\n    console.log(`Connection state change: ${pc.connectionState}`);\n    });\n\n    pc.addEventListener('signalingstatechange', () => {\n    console.log(`Signaling state change: ${pc.signalingState}`);\n    });\n\n    pc.addEventListener('iceconnectionstatechange ', () => {\n    console.log(`ICE connection state change: ${pc.iceConnectionState}`);\n    });\n};\n\nconst handleMuteAudio = () => {\n    if (localStream) {\n    localStream.getAudioTracks()[0].enabled = !localStream.getAudioTracks()[0].enabled;\n    setIsAudioEnabled(!isAudioEnabled);\n    }\n};\n\nconst handleStopVideo = async () => {\n  if (localStream) {\n    const videoTrack = localStream.getVideoTracks()[0];\n    videoTrack.enabled = !videoTrack.enabled;\n    setIsVideoEnabled(!isVideoEnabled);\n\n    // Create a reference to the user status document\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    // Get the current data for the document\n    const docSnap = await getDoc(userStatusDocRef);\n\n    if (docSnap.exists()) {\n      // Update the isEnabled field for the current user\n      await updateDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n      }, { merge: true });\n    } else {\n      // If the document doesn't exist, create it with the correct fields for both users\n      await setDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      });\n    }\n\n    // Toggle between the local video stream and the user's profile picture\n    const localVideoElement = localVideoRef.current;\n    if (videoTrack.enabled) {\n      localVideoElement.srcObject = localStream;\n    } else {\n      localVideoElement.srcObject = null;\n    }\n  }\n};\n\nuseEffect(() => {\n  if (roomId && otherUserUID) {\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    const unsubscribe = onSnapshot(userStatusDocRef, (docSnapshot) => {\n      if (docSnapshot.exists()) {\n        const otherUserStatus = docSnapshot.data()[otherUserUID];\n        if (otherUserStatus && otherUserStatus.isEnabled && remoteStream.getTracks().length > 0) {\n          setIsCalleeJoined(true);\n        } else {\n          setIsCalleeJoined(false);\n        }\n      } else {\n        setIsCalleeJoined(false);\n      }\n    }, (error) => {\n      console.log('Error listening to user status document:', error);\n    });\n\n    return () => unsubscribe();\n  }\n}, [roomId, otherUserUID, remoteStream]);\n  \n\n  \n  \n\nconst isMobile = window.innerWidth <= 768;\n\nconst handleCloseVideoCallApp = () => {\n  onClose();\n};\n\n\nreturn (\n    <div className='video-chat' >\n\n\n\n    <div className=\"video-chat-header d-none-mobile\">\n\n    <h2 className=\"fw-bold lead mb-3\" style={{ fontSize: '2rem' }}>{userData.displayName}</h2>\n        <div className=\"video-go-back-svg\">\n        <button onClick={onClose}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5}  stroke=\"currentColor\" className=\"w-6 h-6\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n        </svg>\n        </button>\n    </div>\n    </div>\n    <div className=\"video-chat-container\">\n        <div className={`chat-container-call ${showChat ? 'show' : ''}`}>\n          {showChat && (\n            <ChatContainerCalls\n              currentUserUID={currentUserUID}\n              otherUserUID={otherUserUID}\n            />\n          )}\n        </div>\n\n<div className=\"video-row\">\n\n\n\n{isMobile && (\n       <div className=\"mobile-go-back-svg\">\n       <svg onClick={handleCloseVideoCallApp} xmlns=\"http://www.w3.org/2000/svg\" color= '#212529'  fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={3} stroke=\"white\" height=\"45\" width=\"25\" style={{ margin: '5px' }}>\n         <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 19.5 8.25 12l7.5-7.5\" />\n       </svg>\n     </div>\n    )}  \n<video\nclassName=\"local-video\"\nref={localVideoRef}\nautoPlay\nplaysInline\nmuted\nstyle={{ display: isVideoEnabled ? 'block' : 'none' }}\n/>\n{!isVideoEnabled &&  !isMobile &&(\n<div className=\"profile-picture-container\">\n  <img\n    className=\"profile-picture\"\n    src={currentUser?.photoURL || \"default-profile-picture.png\"}\n    alt=\"Profile Picture\"\n  />\n</div>\n)}\n<video\n  className=\"remote-video\"\n  ref={remoteVideoRef}\n  autoPlay\n  playsInline\n  style={{ display: isCalleeJoined ? 'block' : 'none' }}\n/>\n{!isCalleeJoined && (\n  <>\n   \n    <div className=\"profile-picture-container\">\n    {isMobile && (\n      <p style={{ textAlign: 'center' }}>{userData?.displayName}</p>\n    )}\n      <img\n        className=\"profile-picture\"\n        src={userData.photoURL || \"default-profile-picture.png\"}\n        alt=\"Profile Picture\"\n      />\n    </div>\n  </>\n)}\n\n\n\n</div>\n<div className=\"name-row d-none-mobile \">\n<p>{currentUser?.displayName}</p>\n<p>{userData.displayName}</p>\n\n</div>\n\n</div>\n\n{!isMobile && (\n    <div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                  setIsVideoEnabled(true);\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n         <button\n         className=\"join-room-button\"\n         onClick={() => joinRoom(setIsCalleeJoined(true))}\n       >\n              \n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n  <div className=\"settings-button-container\">\n  <button className=\"settings-button\" onClick={() => setShowChat(!showChat)}>\n  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 0 1-.923 1.785A5.969 5.969 0 0 0 6 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337Z\" />\n  </svg>\n</button>\n\n        </div>\n        </div>\n\n    </div>\n        )}\n            {isMobile && (\n    <div className=\"video-chat-footer-mobile\">\n<div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n    \n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n            <button className=\"join-room-button\" onClick={joinRoom}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n            <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n\n        </div>\n\n    </div>\n    </div>\n    )}\n    </div>\n);\n\n};\nexport default VideoChatApp;","import React, { useEffect, useRef, useState } from 'react';\nimport { db, auth } from '../firebase';\nimport { collection, doc, setDoc, getDoc, onSnapshot, getDocs, deleteDoc, updateDoc } from 'firebase/firestore';\nimport ChatContainerCalls from './ChatContainerCall';\n\nconst VideoCallApp = ({ currentUserUID, otherUserUID, onClose, userData }) => {\nconst localVideoRef = useRef(null);\nconst remoteVideoRef = useRef(null);\n\nconst [peerConnection, setPeerConnection] = useState(null);\nconst [localStream, setLocalStream] = useState(null);\nconst [remoteStream, setRemoteStream] = useState(null);\nconst [roomId, setRoomId] = useState(null);\nconst [isCreatingRoom, setIsCreatingRoom] = useState(false);\nconst [isJoiningRoom, setIsJoiningRoom] = useState(false);\nconst [roomIdToJoin, setRoomIdToJoin] = useState('');\n\nconst [roomName, setRoomName] = useState('');\nconst [roomExists, setRoomExists] = useState(false);\nconst [showJoinButton, setShowJoinButton] = useState(false);\nconst [callToJoin, setCallToJoin] = useState(false);\nconst [isVideoEnabled, setIsVideoEnabled] = useState(false);\nconst [isAudioEnabled, setIsAudioEnabled] = useState(true);\nconst [inCall, setInCall] = useState(false);\nconst [currentUser, setCurrentUser] = useState(null);\nconst [isCalleeJoined, setIsCalleeJoined] = useState(false);\nconst [isRemoteVideoAvailable, setIsRemoteVideoAvailable] = useState(false);\n\nconst [showChat, setShowChat] = useState(false);\n\n\n\n\n\n\n\nlet calleeCandidatesUnsubscribe = null;\nlet callerCandidatesUnsubscribe = null;\n\nconst configuration = {\n  iceServers: [\n    {\n      urls: [\n        'stun:stun.l.google.com:19302',\n        'stun:stun1.l.google.com:19302',\n        'stun:stun2.l.google.com:19302',\n        'stun:stun3.l.google.com:19302',\n        'stun:stun4.l.google.com:19302',\n      ]\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:443\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turns:standard.relay.metered.ca:443?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n  ],\n  iceCandidatePoolSize: 10,\n};\nuseEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n    if (user) {\n        setCurrentUser(user); // Set the current user when authenticated\n    } else {\n        setCurrentUser(null); // Reset the current user if not authenticated\n    }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n}, []);\n\nuseEffect(() => {\n    const openUserMedia = async () => {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true,\n      });\n      localVideoRef.current.srcObject = stream;\n      setLocalStream(stream);\n      setRemoteStream(new MediaStream());\n      remoteVideoRef.current.srcObject = remoteStream;\n  \n      console.log(\"Stream:\", localVideoRef.current.srcObject);\n      setIsVideoEnabled(false); // Add this line\n    };\n  \n    openUserMedia();\n  \n    // Clean up function\n    return () => {\n      hangUp();\n    };\n  }, [currentUserUID, otherUserUID]);\n  \n  \n\n\n\nuseEffect(() => {\n    const checkRoomExists = async () => {\n    const roomRef = doc(collection(db, 'calls'), roomIdToJoin);\n    const roomSnapshot = await getDoc(roomRef);\n    setRoomExists(roomSnapshot.exists());\n    };\n\n    if (roomIdToJoin) {\n    checkRoomExists();\n    }\n}, [roomIdToJoin]);\n\nuseEffect(() => {\n    // Listen for room creation on the callee side\n    const roomsCollection = collection(db, 'calls');\n    const unsubscribe = onSnapshot(roomsCollection, (snapshot) => {\n    snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n        const roomData = change.doc.data();\n        const roomId = change.doc.id;\n        const swappedRoomId = `${currentUserUID}_${otherUserUID}`;\n        if (roomId === swappedRoomId) {\n            setShowJoinButton(true);\n            setRoomId(roomId);\n            setCallToJoin(true);\n        }\n        }\n    });\n    });\n\n    // Clean up the listener on component unmount\n    return () => unsubscribe();\n}, [currentUserUID, otherUserUID]);\n\nconst createRoom = async () => {\n    // Set the room ID to otherUserUID_currentUserUID\n    const roomId = `${otherUserUID}_${currentUserUID}`;\n  \n    setIsCreatingRoom(true);\n    const roomRef = doc(collection(db, 'calls'), roomId);\n  \n    const newPeerConnection = new RTCPeerConnection(configuration);\n    setPeerConnection(newPeerConnection);\n  \n    registerPeerConnectionListeners(newPeerConnection);\n  \n    localStream.getTracks().forEach(track => {\n      newPeerConnection.addTrack(track, localStream);\n    });\n  \n    // Create a reference to the videoCallStatus document\n    const videoCallStatusDocRef = doc(db, 'videoCallStatus', roomId);\n  \n    // First, get the document\n    const docSnap = await getDoc(videoCallStatusDocRef);\n  \n    if (!docSnap.exists()) {\n      // If the document doesn't exist, create it\n      await setDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: false,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      });\n    } else {\n      // If the document exists, update it\n      await updateDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: false,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      }, { merge: true });\n    }\n  \n    // Code for collecting ICE candidates\n    const callerCandidatesCollection = collection(db, 'calls', roomRef.id, 'callerCandidates');\n  \n    newPeerConnection.addEventListener('icecandidate', event => {\n      if (!event.candidate) {\n        console.log('Got final candidate!');\n        return;\n      }\n      console.log('Got candidate: ', event.candidate);\n      if (newPeerConnection.signalingState !== 'closed') {\n        setDoc(doc(callerCandidatesCollection), event.candidate.toJSON());\n      }\n    });\n  \n    // Code for creating a room\n    const offer = await newPeerConnection.createOffer();\n    await newPeerConnection.setLocalDescription(offer);\n    console.log('Created offer:', offer);\n  \n    const roomWithOffer = {\n      'offer': {\n        type: offer.type,\n        sdp: offer.sdp,\n      },\n      'name': roomName, // Add the room name to the room data\n    };\n    await setDoc(roomRef, roomWithOffer);\n    setRoomId(roomRef.id);\n    console.log(`New room created with SDP offer. Room ID: ${roomRef.id}`);\n  \n    // Set remote stream as the srcObject of the remote video element\n    remoteVideoRef.current.srcObject = remoteStream;\n  \n    newPeerConnection.addEventListener('track', event => {\n      console.log('Got remote track:', event.streams[0]);\n      event.streams[0].getTracks().forEach(track => {\n        console.log('Add a track to the remoteStream:', track);\n        remoteStream.addTrack(track);\n      });\n    });\n  \n    // Listening for remote session description\n    onSnapshot(roomRef, async snapshot => {\n      const data = snapshot.data();\n      if (!newPeerConnection.currentRemoteDescription && data && data.answer) {\n        console.log('Got remote description: ', data.answer);\n        const rtcSessionDescription = new RTCSessionDescription(data.answer);\n        await newPeerConnection.setRemoteDescription(rtcSessionDescription);\n      }\n    });\n  \n    // Listen for remote ICE candidates\n    calleeCandidatesUnsubscribe = onSnapshot(collection(db, 'calls', roomRef.id, 'calleeCandidates'), snapshot => {\n      snapshot.docChanges().forEach(async change => {\n        if (change.type === 'added') {\n    \n        \n          let data = change.doc.data();\n          console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n          if (newPeerConnection.signalingState !== 'closed') {\n            await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n          }\n        }\n      });\n    });\n    setInCall(true);\n    localStream.getVideoTracks()[0].enabled = false;\n    setIsVideoEnabled(false);\n  };\n  \n\nconst joinRoom = async () => {\n    // Set the room ID to currentUserUID_otherUserUID\n    const roomId = `${currentUserUID}_${otherUserUID}`;\n\n    if (roomId) {\n    setIsJoiningRoom(true);\n    const roomRef = doc(collection(db, 'calls'), roomId);\n    const roomSnapshot = await getDoc(roomRef);\n\n    if (roomSnapshot.exists()) {\n        console.log('Got room:', roomSnapshot.data());\n        console.log('Create PeerConnection with configuration: ', configuration);\n        const newPeerConnection = new RTCPeerConnection(configuration);\n        setPeerConnection(newPeerConnection);\n        registerPeerConnectionListeners(newPeerConnection);\n        localStream.getTracks().forEach(track => {\n        newPeerConnection.addTrack(track, localStream);\n        });\n\n        // Code for collecting ICE candidates\n        const calleeCandidatesCollection = collection(db, 'calls', roomId, 'calleeCandidates');\n        newPeerConnection.addEventListener('icecandidate', event => {\n        if (!event.candidate) {\n            console.log('Got final candidate!');\n            return;\n        }\n        console.log('Got candidate: ', event.candidate);\n        setDoc(doc(calleeCandidatesCollection), event.candidate.toJSON());\n        });\n\n        // Set remote stream as the srcObject of the remote video element\n        remoteVideoRef.current.srcObject = remoteStream;\n\n        newPeerConnection.addEventListener('track', event => {\n        console.log('Got remote track:', event.streams[0]);\n        event.streams[0].getTracks().forEach(track => {\n            console.log('Add a track to the remoteStream:', track);\n            remoteStream.addTrack(track);\n        });\n        });\n\n        // Code for creating SDP answer\n        const offer = roomSnapshot.data().offer;\n        console.log('Got offer:', offer);\n        await newPeerConnection.setRemoteDescription(new RTCSessionDescription(offer));\n        const answer = await newPeerConnection.createAnswer();\n        console.log('Created answer:', answer);\n        await newPeerConnection.setLocalDescription(answer);\n\n        const roomWithAnswer = {\n        answer: {\n            type: answer.type,\n            sdp: answer.sdp,\n        },\n        };\n        await setDoc(roomRef, roomWithAnswer, { merge: true });\n\n        // Listening for remote ICE candidates\n        const callerCandidatesCollection = collection(db, 'calls', roomId, 'callerCandidates');\n        onSnapshot(callerCandidatesCollection, snapshot => {\n        snapshot.docChanges().forEach(async change => {\n            if (change.type === 'added') {\n            let data = change.doc.data();\n            console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n            if (newPeerConnection.signalingState !== 'closed') {\n                await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n            }\n            }\n        });\n        });\n\n        // Hide the join room button\n        setShowJoinButton(false);\n    } else {\n        console.log('Room not found');\n        setIsJoiningRoom(false);\n    }\n    } else {\n    console.error('Invalid room ID');\n    }\n    setInCall(true);\n    setIsCalleeJoined(false);\n    localStream.getVideoTracks()[0].enabled = false;\n    setIsVideoEnabled(false);\n};\n\n\n\n\nconst hangUp = async () => {\n    if (localStream) {\n      const tracks = localStream.getTracks();\n      tracks.forEach((track) => {\n        track.stop();\n      });\n    }\n  \n    if (remoteStream) {\n      remoteStream.getTracks().forEach((track) => track.stop());\n    }\n  \n    // Delete room on hangup\n    if (roomId) {\n      const calleeCandidates = await getDocs(\n        collection(db, 'calls', roomId, \"calleeCandidates\")\n      );\n      calleeCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const callerCandidates = await getDocs(\n        collection(db, 'calls', roomId, \"callerCandidates\")\n      );\n      callerCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const roomRef = doc(collection(db, 'calls'), roomId);\n      await deleteDoc(roomRef);\n  \n      // Delete videoCallStatus document\n      const videoCallStatusDocRef = doc(db, \"videoCallStatus\", roomId);\n      await deleteDoc(videoCallStatusDocRef);\n    }\n  \n    if (peerConnection) {\n      peerConnection.close();\n    }\n  \n    if (localVideoRef.current) {\n        localVideoRef.current.srcObject = null;\n        const profilePictureURL = currentUser?.photoURL || \"default-profile-picture.png\";\n        localVideoRef.current.poster = profilePictureURL;\n      }\n    \n      if (remoteVideoRef.current) {\n        remoteVideoRef.current.srcObject = null;\n      }\n    \n  \n    if (remoteVideoRef.current) {\n      remoteVideoRef.current.srcObject = null;\n    }\n  \n    // Remove the listeners\n    if (calleeCandidatesUnsubscribe) {\n      calleeCandidatesUnsubscribe();\n    }\n  \n    if (callerCandidatesUnsubscribe) {\n      callerCandidatesUnsubscribe();\n    }\n  \n    setIsCreatingRoom(false);\n    setIsJoiningRoom(false);\n    setRoomId(null);\n    setRoomIdToJoin(\"\");\n    setIsVideoEnabled(false);\n  };\n  \n  \n\n\nconst registerPeerConnectionListeners = (pc) => {\n    pc.addEventListener('icegatheringstatechange', () => {\n    console.log(`ICE gathering state changed: ${pc.iceGatheringState}`);\n    });\n\n    pc.addEventListener('connectionstatechange', () => {\n    console.log(`Connection state change: ${pc.connectionState}`);\n    });\n\n    pc.addEventListener('signalingstatechange', () => {\n    console.log(`Signaling state change: ${pc.signalingState}`);\n    });\n\n    pc.addEventListener('iceconnectionstatechange ', () => {\n    console.log(`ICE connection state change: ${pc.iceConnectionState}`);\n    });\n};\n\nconst handleMuteAudio = () => {\n    if (localStream) {\n    localStream.getAudioTracks()[0].enabled = !localStream.getAudioTracks()[0].enabled;\n    setIsAudioEnabled(!isAudioEnabled);\n    }\n};\n\nconst handleStopVideo = async () => {\n  if (localStream) {\n    const videoTrack = localStream.getVideoTracks()[0];\n    videoTrack.enabled = !videoTrack.enabled;\n    setIsVideoEnabled(!isVideoEnabled);\n\n    // Create a reference to the user status document\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    // Get the current data for the document\n    const docSnap = await getDoc(userStatusDocRef);\n\n    if (docSnap.exists()) {\n      // Update the isEnabled field for the current user\n      await updateDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n      }, { merge: true });\n    } else {\n      // If the document doesn't exist, create it with the correct fields for both users\n      await setDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      });\n    }\n\n    // Toggle between the local video stream and the user's profile picture\n    const localVideoElement = localVideoRef.current;\n    if (videoTrack.enabled) {\n      localVideoElement.srcObject = localStream;\n    } else {\n      localVideoElement.srcObject = null;\n    }\n  }\n};\n\nuseEffect(() => {\n  if (roomId && otherUserUID) {\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    const unsubscribe = onSnapshot(userStatusDocRef, (docSnapshot) => {\n      if (docSnapshot.exists()) {\n        const otherUserStatus = docSnapshot.data()[otherUserUID];\n        if (otherUserStatus && otherUserStatus.isEnabled && remoteStream.getTracks().length > 0) {\n          setIsCalleeJoined(true);\n        } else {\n          setIsCalleeJoined(false);\n        }\n      } else {\n        setIsCalleeJoined(false);\n      }\n    }, (error) => {\n      console.log('Error listening to user status document:', error);\n    });\n\n    return () => unsubscribe();\n  }\n}, [roomId, otherUserUID, remoteStream]);\n\nconst isMobile = window.innerWidth <= 768;\n\nconst handleHangUp = () => {\n  hangUp();\n  onClose();\n};\n\nconst handleCloseVideoCallApp = () => {\n  onClose();\n};\n\n\n\nreturn (\n  <div className='video-chat' >\n\n    <div className=\"video-chat-header d-none-mobile\">\n\n    <h2 className=\"fw-bold lead mb-3\" style={{ fontSize: '2rem' }}>{userData.displayName}</h2>\n        <div className=\"video-go-back-svg\">\n        <button onClick={onClose}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5}  stroke=\"currentColor\" className=\"w-6 h-6\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n        </svg>\n        </button>\n    </div>\n    </div>\n    <div className=\"video-chat-container\">\n        <div className={`chat-container-call ${showChat ? 'show' : ''}`}>\n          {showChat && (\n            <ChatContainerCalls\n              currentUserUID={currentUserUID}\n              otherUserUID={otherUserUID}\n            />\n          )}\n        </div>\n\n<div className=\"video-row\">\n{isMobile && (\n       <div className=\"mobile-go-back-svg\">\n       <svg onClick={handleCloseVideoCallApp} xmlns=\"http://www.w3.org/2000/svg\" color= '#212529'  fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={3} stroke=\"white\" height=\"45\" width=\"25\" style={{ margin: '5px' }}>\n         <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 19.5 8.25 12l7.5-7.5\" />\n       </svg>\n     </div>\n     \n    )}  \n<video\nclassName=\"local-video\"\nref={localVideoRef}\nmuted\nautoPlay\nplaysInline\nstyle={{ display: isVideoEnabled ? 'block' : 'none' }}\n/>\n{!isVideoEnabled && !isMobile &&(\n<div className=\"profile-picture-container \">\n  <img\n    className=\"profile-picture\"\n    src={currentUser?.photoURL || \"default-profile-picture.png\"}\n    alt=\"Profile Picture\"\n  />\n</div>\n)}\n<video\n  className=\"remote-video\"\n  ref={remoteVideoRef}\n  autoPlay\n  playsInline\n  style={{ display: isCalleeJoined ? 'block' : 'none' }}\n/>\n{!isCalleeJoined && (\n  <>\n   \n    <div className=\"profile-picture-container \">\n    {isMobile && (\n      <p style={{ textAlign: 'center' }}>{userData?.displayName}</p>\n    )}\n      <img\n        className=\"profile-picture\"\n        src={userData.photoURL || \"default-profile-picture.png\"}\n        alt=\"Profile Picture\"\n      />\n    </div>\n  </>\n)}\n\n\n\n\n</div>\n<div className=\"name-row d-none-mobile \">\n<p>{currentUser?.displayName}</p>\n<p>{userData.displayName}</p>\n\n</div>\n</div>\n{!isMobile && (\n    <div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n         <button\n         className=\"join-room-button\"\n         onClick={() => joinRoom()}\n       >\n              \n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n  <div className=\"settings-button-container\">\n  <button className=\"settings-button\" onClick={() => setShowChat(!showChat)}>\n  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 0 1-.923 1.785A5.969 5.969 0 0 0 6 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337Z\" />\n  </svg>\n</button>\n\n        </div>\n        </div>\n\n    </div>\n        )}\n            {isMobile && (\n    <div className=\"video-chat-footer-mobile\">\n<div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n    \n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n            <button className=\"join-room-button\" onClick={joinRoom}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n            <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n\n        </div>\n\n    </div>\n    </div>\n    )}\n    </div>\n);\n\n};\nexport default VideoCallApp;","import React, { useState, useEffect } from 'react';\nimport { db, auth } from '../firebase'; // Import your Firebase instance\nimport { collection, doc, getDoc, setDoc, where, query, onSnapshot } from 'firebase/firestore';\nimport ChatServiceconversation from './ChatServiceconversation';\nimport VideoChatApp from './VideoChatApp'; \nimport VideoCallApp from './VideoCallApp';\n\n\nconst ChatHeader = ({ toggleColumns, otherUserUID, currentUserUID }) => {\n  const [userData, setUserData] = useState({\n    isMobile: false,\n    photoURL: null,\n    displayName: '',\n    occupation: '',\n    isShareChatOpen: false,\n    selectedSession: null,\n    selectedMessageUID: null,\n  });\n\n  const [showVideoCall, setShowVideoCall] = useState(false);\n  const [incomingCall, setIncomingCall] = useState(null);\n\n  const [showCall, setShowCall] = useState(false);\n  const [incomingPhoneCall, setIncomingPhoneCall] = useState(null);\n\n  const [showVideoCallAnimation, setShowVideoCallAnimation] = useState(false);\n  const [showCallAnimation, setShowCallAnimation] = useState(false);\n\n\n  const toggleVideoCall = () => {\n    const videoWrapper = document.querySelector('.video-chat-wrapper');\n  \n    if (showVideoCall) {\n      videoWrapper.classList.remove('open');\n      videoWrapper.classList.add('close');\n      setTimeout(() => {\n        setShowVideoCall(false);\n        videoWrapper.classList.remove('close');\n      }, 500);\n    } else {\n      setShowVideoCallAnimation(true);\n      setTimeout(() => {\n        videoWrapper.classList.add('open');\n        setShowVideoCall(true);\n      }, 100);\n    }\n  };\n  \n  const handleVideoChatClose = () => {\n    toggleVideoCall();\n  };\n\n  const toggleCall = () => {\n    const videoCAllWrapper = document.querySelector('.video-call-wrapper');\n  \n    if (showCall) {\n      videoCAllWrapper.classList.remove('open');\n      videoCAllWrapper.classList.add('close');\n      setTimeout(() => {\n        setShowCall(false);\n        videoCAllWrapper.classList.remove('close');\n      }, 500);\n    } else {\n      setShowCallAnimation(true);\n      setTimeout(() => {\n        videoCAllWrapper.classList.add('open');\n        setShowCall(true);\n      }, 100);\n    }\n  };\n  \n  const handleVideoCallClose = () => {\n    toggleCall();\n  };\n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      const roomId = `${currentUserUID}_${otherUserUID}`;\n    const roomRef = doc(collection(db, 'rooms'), roomId);\n    \n    const unsubscribe = onSnapshot(roomRef, (snapshot) => {\n    if (snapshot.exists()) {\n    setIncomingCall({\n    roomId: snapshot.id,\n    offer: snapshot.data().offer,\n    });\n    } else {\n    setIncomingCall(null);\n    }\n    });\n    \n    return () => unsubscribe();\n    }\n    }, [currentUserUID, otherUserUID]);\n\n    useEffect(() => {\n      if (currentUserUID && otherUserUID) {\n        const roomId = `${currentUserUID}_${otherUserUID}`;\n      const roomRef = doc(collection(db, 'calls'), roomId);\n      \n      const unsubscribe = onSnapshot(roomRef, (snapshot) => {\n      if (snapshot.exists()) {\n        setIncomingPhoneCall({\n      roomId: snapshot.id,\n      offer: snapshot.data().offer,\n      });\n      } else {\n        setIncomingPhoneCall(null);\n      }\n      });\n      \n      return () => unsubscribe();\n      }\n      }, [currentUserUID, otherUserUID]);\n    \n  \n\n\n    useEffect(() => {\n      const mediaQuery = window.matchMedia('(max-width: 768px)');\n      setUserData((prevUserData) => ({ ...prevUserData, isMobile: mediaQuery.matches }));\n  \n      const handleResize = () => {\n        setUserData((prevUserData) => ({ ...prevUserData, isMobile: mediaQuery.matches }));\n      };\n  \n      mediaQuery.addListener(handleResize);\n  \n      return () => {\n        mediaQuery.removeListener(handleResize);\n      };\n    }, []);\n  \n    const fetchUserData = async (userTypeRef) => {\n      try {\n        const userDocSnap = await getDoc(doc(userTypeRef, otherUserUID));\n  \n        if (userDocSnap.exists()) {\n          const userData = userDocSnap.data();\n          if (userData) {\n            setUserData((prevUserData) => ({\n              ...prevUserData,\n              photoURL: userData.photoURL,\n              displayName: userData.displayName ?? '',\n              occupation: userData.occupation ?? '',\n            }));\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching user data:', error);\n      }\n    };\n  \n    useEffect(() => {\n      const fetchData = async () => {\n        try {\n          if (otherUserUID) {\n            const firestore = db;\n            const expertAppsRef = collection(firestore, 'expertApplications');\n            const expertDocSnap = await getDoc(doc(expertAppsRef, otherUserUID));\n  \n            if (expertDocSnap.exists()) {\n              fetchUserData(expertAppsRef);\n            } else {\n              const userProfilesRef = collection(firestore, 'userProfiles');\n              fetchUserData(userProfilesRef);\n            }\n          }\n        } catch (error) {\n          console.error('Error fetching user data:', error);\n        }\n      };\n  \n      fetchData();\n    }, [otherUserUID]);\n  \n    useEffect(() => {\n      const fetchSessionAndUpdate = async () => {\n        try {\n          if (otherUserUID && currentUserUID) {\n            const firestore = db;\n            const conversationsCollectionRef = collection(firestore, 'sharedConversations');\n            let discussionID;\n  \n            const expertAppsRef = collection(firestore, 'expertApplications');\n            const expertDocSnap = await getDoc(doc(expertAppsRef, currentUserUID));\n  \n            if (expertDocSnap.exists()) {\n              discussionID = `${otherUserUID}_${currentUserUID}`;\n            } else {\n              discussionID = `${currentUserUID}_${otherUserUID}`;\n            }\n  \n            const conversationRef = doc(conversationsCollectionRef, discussionID);\n            const conversationSnapshot = await getDoc(conversationRef);\n  \n            if (conversationSnapshot.exists()) {\n              const selectedSession = conversationSnapshot.data().selectedSession;\n              setUserData((prevUserData) => ({\n                ...prevUserData,\n                selectedSession: selectedSession,\n              }));\n            } else {\n            }\n          } else {\n            setUserData((prevUserData) => ({\n              ...prevUserData,\n              selectedMessageUID: null,\n              selectedSession: null,\n            }));\n          }\n        } catch (error) {\n          console.error('Error fetching and updating session:', error);\n        }\n      };\n  \n      fetchSessionAndUpdate();\n    }, [otherUserUID, currentUserUID]);\n  \n    const closeShareChat = () => {\n      setUserData((prevUserData) => ({ ...prevUserData, isShareChatOpen: false }));\n    };\n\n    const renderCustomSVG = () => {\n      if (userData.selectedSession) {\n        return (\n          <svg\n          className='render-chat'\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill={'none'}\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n            onClick={() => {\n              setUserData((prevUserData) => ({ ...prevUserData, isShareChatOpen: true }));\n            }}\n          >\n        <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z\"\n        />\n          </svg>\n      );\n    } else {\n      return null;\n    }\n  };\n  \n    const handleImageClick = async () => {\n      try {\n        if (!otherUserUID) {\n          throw new Error('otherUserUID is undefined or null');\n        }\n  \n        const firestore = db;\n        const expertAppsRef = collection(firestore, 'expertApplications');\n        const expertDocSnap = await getDoc(doc(expertAppsRef, otherUserUID));\n  \n        if (expertDocSnap.exists()) {\n          const customURL = expertDocSnap.data().customURL;\n          window.location.href = `https://www.tioassist.io/expert/${customURL}`;\n        } else {\n          const userProfilesRef = collection(firestore, 'userProfiles');\n          const userDocSnap = await getDoc(doc(userProfilesRef, otherUserUID));\n  \n          if (userDocSnap.exists()) {\n            const customURL = userDocSnap.data().customURL;\n            window.location.href = `https://www.tioassist.io/user/${customURL}`;\n          } else {\n          }\n        }\n      } catch (error) {\n        console.error('Error handling image click:', error.message);\n      }\n    };\n  \n    return (\n      <div className=\"chat-header\" >\n        <div className='chat-header-one'>\n        {userData.isMobile && (\n          <svg\n            onClick={toggleColumns}\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n            style={{ marginRight: '8px' }}\n          >\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n          </svg>\n        )}\n  \n        <div className=\"small-avatar-mobile\" onClick={handleImageClick}>\n          <img\n            className=\"small-avatar-mobile \"\n            src={userData.photoURL}\n            alt=\"Custom 404 Image\"\n            role=\"button\"\n          />\n        </div>\n        <div className=\"user-info\">\n          <div>\n            <p className=\"font-weight-bold mb-0\">{userData.displayName}</p>\n            <p className=\"text-sm text-muted\">{userData.occupation}</p>\n          </div>\n        </div>\n        </div>\n        <div className='chat-header-two'>\n        <div className={`svg-wrapper ${incomingPhoneCall ? 'unread-svg-border' : ''}`}    onClick={toggleCall}>\n        <svg    \n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill={'none'}\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            id=\"call\"\n            height=\"25\" width=\"25\" style={{ margin: '5px' }}>\n            \n  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z\" />\n</svg>\n</div>\n<div className={`svg-wrapper ${incomingCall ? 'unread-svg-border' : ''}`}    onClick={toggleVideoCall}>\n<svg    \n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill={'none'}\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\" width=\"25\" style={{ margin: '5px' }}\n            id=\"videocall\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z\" />\n</svg>\n</div>\n{renderCustomSVG()}\n  \n        {userData.isShareChatOpen && (\n          <ChatServiceconversation\n            currentUserUID={currentUserUID}\n            selectedSession={userData.selectedSession}\n            otherUserUID={otherUserUID}\n            closeShareChat={closeShareChat}\n          />\n        )}\n\n        </div>\n        <div\n  className={`video-chat-wrapper ${showVideoCallAnimation ? 'open' : ''}`}\n>\n  {showVideoCall && (\n    <VideoChatApp\n      currentUserUID={currentUserUID}\n      otherUserUID={otherUserUID}\n      onClose={handleVideoChatClose}\n      userData={userData}\n    />\n  )}\n</div>\n\n<div\n  className={`video-call-wrapper ${showCallAnimation ? 'open' : ''}`}\n>\n       {showCall && (\n        <VideoCallApp\n          currentUserUID={currentUserUID}\n          otherUserUID={otherUserUID}\n          onClose={handleVideoCallClose}\n          userData={userData}  \n        />\n      )}\n      </div>\n    </div>\n    );\n  };\n  \n  export default ChatHeader;","import React, { useState, useEffect, useRef } from 'react';\nimport ChatHeader from './Chatheader';\nimport { sendMessage, getMessages, markMessageAsRead } from './ChatService';\nimport { auth, onAuthStateChanged, db } from '../firebase';\nimport { onSnapshot, collection, getDocs } from 'firebase/firestore';\n\n\nconst RightColumn = ({ isRightColumnVisible, toggleColumns, otherUserUID }) => {\n  const [messages, setMessages] = useState([]);\n  const chatBoxRef = useRef(null);\n  const messageInputRef = useRef(null);\n  const [inputValue, setInputValue] = useState('');\n  const [currentUserUID, setCurrentUserUID] = useState(null);\n  const [isChattingWithSelf, setIsChattingWithSelf] = useState(false);\n  const [textareaHeight, setTextareaHeight] = useState('28px');\n  const maxTextareaHeight = 200;\n\n  const [selectedFile, setSelectedFile] = useState(null);\n  const fileInputRef = useRef(null);\n  const [selectedFilePreview, setSelectedFilePreview] = useState(null);\n  const [lastSeenMessageId, setLastSeenMessageId] = useState(null);\n\n  const [initialLoad, setInitialLoad] = useState(true);\n\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      if (user) {\n        setCurrentUserUID(user.uid);\n      } else {\n        setCurrentUserUID(null);\n      }\n    });\n    return () => unsubscribe(); // Clean up the listener\n  }, []);\n\n  useEffect(() => {\n    setIsChattingWithSelf(currentUserUID === otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        // Reverse the messages here and then set them in the state\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n\n        // Scroll to bottom when new messages are fetched\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n  \n\n  const isMobile = window.innerWidth <= 767; // Adjust the width threshold as needed\n\n  const handleFileUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      setSelectedFile(file);\n      if (file.type && file.type.startsWith('image/')) {\n        // It's an image, no need to display anything\n        setSelectedFilePreview(null);\n      } else {\n        // It's not an image, display the SVG icon and file name\n        setSelectedFilePreview({\n          name: file.name,\n          type: 'file',\n        });\n      }\n    }\n  };\n  \n\n  useEffect(() => {\n    if (selectedFile && selectedFile.type && selectedFile.type.startsWith('image/')) {\n      const reader = new FileReader();\n      reader.onload = (event) => {\n        setSelectedFilePreview(event.target.result);\n      };\n      reader.readAsDataURL(selectedFile);\n    } else {\n      setSelectedFilePreview(null);\n    }\n  }, [selectedFile]);\n  \n\n  const handleMessageSend = async () => {\n    try {\n      if (isChattingWithSelf) {\n        console.error(\"Cannot send messages to yourself.\");\n        console.log('currentUserUID:', currentUserUID);\n        console.log('otherUserUID:', otherUserUID);\n        return;\n      }\n  \n      if (inputValue.trim() === '' && !selectedFile) {\n        return;\n      }\n  \n      if (currentUserUID && otherUserUID) {\n        const success = await sendMessage(currentUserUID, otherUserUID, inputValue, selectedFile);\n        if (success) {\n          setInputValue('');\n          setSelectedFile(null);\n          // Clear the image preview in the userui-input\n          setSelectedFilePreview(null);\n  \n          if (!isMobile) {\n            messageInputRef.current.focus();\n          }\n        }\n      } else {\n        console.error('currentUserUID or otherUserUID is undefined');\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  \n  \n  const scrollToBottom = () => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.scrollTop = chatBoxRef.current.scrollHeight;\n    }\n  };\n  \n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleTextareaResize = () => {\n    const textarea = messageInputRef.current;\n    if (textarea) {\n      const newHeight = Math.min(textarea.scrollHeight, maxTextareaHeight);\n      setTextareaHeight(`${newHeight}px`);\n    }\n  };\n  \n  \n  \n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n  \n\n  const handleInputChange = (e) => {\n    setInputValue(e.target.value);\n    handleTextareaResize();\n  };\n\n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n\n  useEffect(() => {\n    if (inputValue === '') {\n      setTextareaHeight('28px');\n    }\n  }, [inputValue]);\n\n  const formatTimestamp = (timestamp) => {\n    if (timestamp) {\n      const date = timestamp.toDate();\n      const hours = date.getHours().toString().padStart(2, '0'); // Get hours in 24-hour format\n      const minutes = date.getMinutes().toString().padStart(2, '0'); // Get minutes\n      return `${hours}:${minutes}`; // Format to HH:MM\n    }\n    return ''; // Return an empty string if the timestamp is not available\n  };\n\n  const handleScroll = () => {\n    // Calculate the last seen message based on scroll position\n    if (chatBoxRef.current) {\n      const { scrollTop, scrollHeight, clientHeight } = chatBoxRef.current;\n      const lastVisibleMessageIndex = Math.floor(scrollTop / clientHeight);\n      if (lastVisibleMessageIndex >= 0 && lastVisibleMessageIndex < messages.length) {\n        const lastSeenMessage = messages[lastVisibleMessageIndex];\n        setLastSeenMessageId(lastSeenMessage.id);\n      }\n    }\n  };\n  useEffect(() => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.addEventListener('scroll', handleScroll);\n    }\n    return () => {\n      if (chatBoxRef.current) {\n        chatBoxRef.current.removeEventListener('scroll', handleScroll);\n      }\n    };\n  }, [chatBoxRef, messages]); // Add messages to dependency array\n\n\n\n  \n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  \n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID, messages, lastSeenMessageId); // Pass lastSeenMessageId\n  }, [messages, currentUserUID, otherUserUID, lastSeenMessageId]);\n\n  useEffect(() => {\n    if (isRightColumnVisible && initialLoad) {\n      setInitialLoad(false);\n    }\n  }, [isRightColumnVisible, initialLoad]);\n\n\n  return (\n    <div className={`chat-right ${isRightColumnVisible && !initialLoad ? 'slide-in' : ''}`}>\n      <ChatHeader toggleColumns={toggleColumns} otherUserUID={otherUserUID} currentUserUID={currentUserUID} />\n      <div className=\"chat-column\">\n        <div className=\"chat-box\" ref={chatBoxRef}>\n    {Array.isArray(messages) && messages.length > 0 ? (\n  messages.map((message, index) =>\n    message.timestamp ? (\n      <div\n        key={index}\n        className={message.sender === currentUserUID ? 'chat-bubble user-sent' : 'chat-bubble'}\n      >\n        <div className=\"message\">\n          {message.file && message.file.type && message.file.type.startsWith('image/') ? (\n            <img\n              src={message.file.url}\n              alt=\"Image\"\n              className=\"rounded-image\"\n            />\n          ) : (\n            message.file && (\n              <div className=\"file-container\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  color=\"#212529\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  strokeWidth={1}\n                  stroke=\"currentColor\"\n                  height=\"25\"\n                  width=\"25\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                  />\n                </svg>\n                <a\n                  href={message.file.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  {message.file.name}\n                </a>\n              </div>\n            )\n          )}\n          {message.text && <p>{message.text}</p>}\n        </div>\n        <div\n          className={`timestamp small-timestamp ${\n            message.sender === currentUserUID ? 'user-sent-timestamp' : 'other-sent-timestamp'\n          }`}\n        >\n          {formatTimestamp(message.timestamp)}\n        </div>\n      </div>\n    ) : null\n  )\n) : (\n  <div>No messages yet.</div>\n)}\n\n\n        </div>\n        <div className=\"chatui-container\">\n    \n            <input\n              type=\"file\"\n              onChange={(e) => handleFileUpload(e)}\n              style={{ display: 'none' }}\n              ref={fileInputRef}\n            />\n            <button className=\"userui-left-button\" onClick={() => fileInputRef.current.click()}>\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                color=\"#212529\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth={1}\n                stroke=\"currentColor\"\n                height=\"25\"\n                width=\"25\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                />\n              </svg>\n            </button>\n            <button\n              aria-label=\"Send Message\"\n              onClick={handleMessageSend}\n              className=\" userui-right-button \"\n            >\n              <i className=\"fas fa-paper-plane\"></i>\n            </button>\n            <div id=\"messageInputContainer\">\n  {selectedFile && (\n    <div className=\"file-info\">\n      {selectedFile.type.startsWith('image/') && (\n        <div className=\"image-preview-container\">\n          <img\n            src={URL.createObjectURL(new Blob([selectedFile], { type: selectedFile.type }))}\n            alt=\"Image Preview\"\n            style={{ maxWidth: '70%', height: 'auto' }}\n          />\n        </div>\n      )}\n      {!selectedFile.type.startsWith('image/') && (\n        <div className=\"file-details\">\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n            />\n          </svg>\n          <span>{selectedFile.name}</span>\n        </div>\n      )}\n<button className=\"remove-button\" onClick={() => setSelectedFile(null)}>X</button>\n    </div>\n  )}\n\n</div>\n\n       \n            <textarea\n  type=\"text\"\n  placeholder=\"Type a message...\"\n  ref={messageInputRef}\n  style={{ height: textareaHeight }}  // <-- Use the style attribute\n  value={inputValue}\n  onChange={handleInputChange}\n  onKeyDown={(e) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleMessageSend();\n    }\n  }}\n  className=\"message-input scroll-col\"\n  autoComplete=\"off\"\n  inputMode=\"text\"\n/>\n\n          </div>\n          \n          </div>\n        </div>\n  \n  );\n};\n\nexport default RightColumn;\n","import React, { useState, useEffect } from 'react';\nimport LeftColumn from './LeftColumn';\nimport MiddleColumn from './MiddleColumn';\nimport RightColumn from './RightColumn';\nimport ChatHistory from './ChatHistory';\nimport Contacts from './Contacts';\nimport Profile from './Profile';\nimport { useLocation } from 'react-router-dom';\n\nconst Chat = () => {\n  const [isActive, setIsActive] = useState(false);\n  const [selectedMenu, setSelectedMenu] = useState('');\n  const [isRightColumnVisible, setIsRightColumnVisible] = useState(true);\n  const [isMiddleColumnVisible, setIsMiddleColumnVisible] = useState(true);\n  const [isLeftColumnVisible, setIsLeftColumnVisible] = useState(true);\n  const [activeButton, setActiveButton] = useState(null);\n\n  const location = useLocation();\n  const { state: locationState } = location;\n  const { currentUserUID, otherUserUID: locationOtherUserUID } = locationState || {};\n\n  const [otherUserUID, setOtherUserUID] = useState(locationOtherUserUID || null);\n\n  const updateOtherUserID = (newOtherUserID, currentUserID) => {\n    setOtherUserUID(newOtherUserID);\n    console.log('Current User ID:', currentUserID); // Log the current user ID\n  };\n\n  useEffect(() => {\n    if (locationState) {\n      // Update otherUserUID if available in the location state\n      setOtherUserUID(locationState.otherUserUID || null);\n      console.log('Other User ID:', locationState.otherUserUID); // Log the other user ID\n    }\n  }, [locationState]);\n\n  \n  // useEffect to set 'Chat History' after component mounts\n  useEffect(() => {\n    setSelectedMenu('Chat History');\n    // Check if the device is a mobile device and hide the right column initially\n    const isMobile = window.matchMedia('(max-width: 768px)').matches;\n    setIsRightColumnVisible(!isMobile);\n  }, []);\n\n  const handleButtonClick = (menu) => {\n    setIsActive(!isActive);\n    setSelectedMenu(menu);\n    setIsLeftColumnVisible(true);\n    setActiveButton(menu);  // Show the left column when a menu is selected\n  };\n\n\n\n  const toggleRightColumnVisibility = () => {\n    setIsRightColumnVisible((prevVisibility) => !prevVisibility);\n    setIsMiddleColumnVisible(false);\n    setIsLeftColumnVisible(false); // Toggle the left column visibility\n  };\n\n  useEffect(() => {\n    const isMobile = window.matchMedia('(max-width: 768px)').matches;\n    if (isMobile && otherUserUID) {\n      setIsLeftColumnVisible(false);\n      setIsMiddleColumnVisible(false);\n      setIsRightColumnVisible(true);\n    }\n  }, [otherUserUID]);\n  \n  const toggleColumns = () => {\n    setIsRightColumnVisible((prevVisibility) => !prevVisibility);\n    setIsMiddleColumnVisible(true); // Show the middle column\n    setIsLeftColumnVisible(true); // Show the left column\n  };\n\n  useEffect(() => {\n    const isMobile = window.matchMedia('(max-width: 768px)').matches;\n\n    if (isMobile) {\n      document.body.style.overflow = 'hidden';\n\n      return () => {\n        document.body.style.overflow = 'auto';\n      };\n    }\n  }, []);\n\n\n\n  return (\n    <div className=\"chatcontainer\">\n      <LeftColumn handleButtonClick={handleButtonClick} isActive={isActive} \n              toggleRightColumnVisibility={toggleRightColumnVisibility}\n              isLeftColumnVisible={isLeftColumnVisible} \n              activeButton={activeButton} // Pass activeButton state\n              setActiveButton={setActiveButton} \n              otherUserUID={otherUserUID} \n              currentUserUID={currentUserUID} \n      />\n      <MiddleColumn\n        isActive={isActive}\n        selectedMenu={selectedMenu}\n        toggleRightColumnVisibility={toggleRightColumnVisibility}\n        isMiddleColumnVisible={isMiddleColumnVisible} \n        activeButton={activeButton} // Pass activeButton state\n        setActiveButton={setActiveButton} \n        currentUserUID={currentUserUID}\n        updateOtherUserID={updateOtherUserID}\n        otherUserUID={otherUserUID}\n      >\n        {selectedMenu === 'Chat History' && <ChatHistory isActive={isActive} selectedMenu={selectedMenu} />}\n        {selectedMenu === 'Contacts' && <Contacts isActive={isActive} selectedMenu={selectedMenu} />}\n        {selectedMenu === 'Profile' && <Profile isActive={isActive} selectedMenu={selectedMenu} />}\n        {/* Add conditions for other menu options here */}\n      </MiddleColumn>\n      {otherUserUID && (\n      <RightColumn\n        isRightColumnVisible={isRightColumnVisible}\n        toggleColumns={toggleColumns}\n        otherUserUID={otherUserUID}\n      />\n    )}\n  </div>\n\n  );\n};\n\nexport default Chat;","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}"],"names":["_ref","handleButtonClick","isLeftColumnVisible","_useState","useState","_useState2","_slicedToArray","activeButton","setActiveButton","_useState3","_useState4","currentUser","setCurrentUser","isMobile","window","innerWidth","useEffect","unsubscribe","auth","onAuthStateChanged","user","handleButtonClickInternal","buttonName","goBack","history","back","_jsx","className","concat","children","_jsxs","photoURL","src","alt","style","maxWidth","onClick","type","xmlns","color","fill","viewBox","strokeWidth","stroke","height","width","strokeLinecap","strokeLinejoin","d","isActive","toggleRightColumnVisibility","updateOtherUserID","otherUserUID","setShowChatHistory","currentUserUID","setCurrentUserUID","_useState5","_useState6","setOtherUserIDs","_useState7","_useState8","chatsWithUserData","setChatsWithUserData","_useState9","_useState10","userProfilesCache","setUserProfilesCache","_useState11","_useState12","_useState13","_useState14","_useState15","_useState16","unreadMessages","setUnreadMessages","_useState17","_useState18","callingUserID","setCallingUserID","_useState19","_useState20","latestMessageTimes","setLatestMessageTimes","matchMedia","matches","length","firstChat","firstChatOtherUserID","otherUserID","fetchChatsForCurrentUser","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","authUID","chatsCollection","_unsubscribe","wrap","_context","prev","next","collection","db","onSnapshot","querySnapshot","chats","forEach","doc","_chatID$split","id","split","_chatID$split2","fetchedAuthUID","fetchedOtherUserID","prevUserIDs","_toConsumableArray","lastMessage","data","messages","lastMessageTime","timestamp","toMillis","push","abrupt","t0","console","error","stop","_x","apply","arguments","uid","fetchUserProfiles","_ref3","_callee2","firestore","userData","expertAppsRef","expertAppDoc","expertDocSnap","expertData","userProfilesRef","userProfileDoc","docSnap","userProfileData","_context2","getDoc","sent","exists","displayName","prevCache","_objectSpread","_defineProperty","_x2","updateChatsWithUserData","_ref4","_callee4","updatedChats","_context4","Promise","all","map","_ref5","_callee3","chat","_context3","_x3","handleDeleteChat","_ref6","_callee5","chatID","event","_context5","stopPropagation","deleteDoc","prevChats","filter","_x4","_x5","hasUnreadMessages","_ref7","_callee6","messagesCollectionRef","_iterator","_step","_doc","message","_context6","getDocs","_createForOfIteratorHelper","docs","s","n","done","value","receiver","isRead","e","f","finish","t1","_x6","_x7","fetchUnreadMessages","_ref8","_callee7","_context7","unsubscribeRooms","docChanges","change","roomID","roomData","_roomID$split","_roomID$split2","user1","user2","offer","unsubscribeCalls","callID","callData","_callID$split","_callID$split2","getLatestMessageTime","_ref9","_callee8","currentUserId","otherUserId","messagesQuery","messagesSnapshot","latestMessage","dateOptions","timeOptions","time","date","_context8","query","where","reduce","latest","current","latestTime","year","month","day","hour","minute","toDate","toLocaleTimeString","toLocaleDateString","_x8","_x9","fetchLatestMessageTimes","_ref10","_callee9","times","_iterator2","_step2","_context9","sortedChatsWithUserData","sort","a","b","display","justifyContent","alignItems","index","_chat$userData","_chat$userData2","process","contacts","setContacts","searchQuery","setSearchQuery","searchResults","setSearchResults","fetchContacts","authUser","userDocument","userProfilesCollection","expertApplicationsCollection","expertApplicationDoc","userProfileSnapshot","expertApplicationSnapshot","userDocRef","userDocSnap","contactsData","contactPromises","fetchedContacts","path","Object","keys","contactUID","contactSnapshot","expertSnapshot","Boolean","trim","Fuse","includeScore","includeMatches","threshold","search","result","item","customURL","_customURL","log","location","href","handleDeleteContact","updateDoc","contact","placeholder","onChange","target","onKeyDown","key","Link","occupation","preventDefault","description","setDescription","city","setCity","email","setEmail","expertProfileRef","expertProfileSnapshot","expertProfileData","userProfileRef","_Fragment","transform","selectedMenu","isMiddleColumnVisible","currentMenu","setCurrentMenu","isVisible","setIsVisible","isChatVisible","setIsChatVisible","timeoutId","setTimeout","clearTimeout","ChatHistory","Contacts","switchToChatHistory","updateActiveButton","Profile","selectedSession","closeShareChat","sharedChatData","setSharedChatData","isLoading","setIsLoading","selectedMessageUID","setSelectedMessageUID","determineSelectedMessageUID","expertAppDocRef","expertAppSnapshot","existsInExpertApplications","determinedMessageUID","fetchSharedChatData","messagesData","orderBy","_doc$data","prompt","response","LoadingCircle","ReactMarkdown","storage","getStorage","createChatID","sendMessage","messageText","selectedFile","chatDocRef","storageRef","downloadURL","messageObject","_messageObject","_messagesCollectionRef","setDoc","users","createdAt","serverTimestamp","ref","Date","now","name","uploadBytes","getDownloadURL","text","file","url","sender","addDoc","getMessages","callback","snapshot","reversedMessages","reverse","markMessageAsRead","messageDocRef","setMessages","chatBoxRef","useRef","messageInputRef","inputValue","setInputValue","isChattingWithSelf","setIsChattingWithSelf","textareaHeight","setTextareaHeight","setSelectedFile","fileInputRef","setSelectedFilePreview","lastSeenMessageId","setLastSeenMessageId","newMessages","slice","scrollToBottom","startsWith","reader","FileReader","onload","readAsDataURL","handleMessageSend","focus","scrollTop","scrollHeight","handleTextareaResize","textarea","newHeight","Math","min","formatTimestamp","hours","getHours","toString","padStart","minutes","getMinutes","handleScroll","_chatBoxRef$current","clientHeight","lastVisibleMessageIndex","floor","lastSeenMessage","addEventListener","removeEventListener","Array","isArray","rel","files","handleFileUpload","click","URL","createObjectURL","Blob","autoComplete","inputMode","onClose","localVideoRef","remoteVideoRef","peerConnection","setPeerConnection","localStream","setLocalStream","remoteStream","setRemoteStream","roomId","setRoomId","setIsCreatingRoom","setIsJoiningRoom","roomIdToJoin","setRoomIdToJoin","roomName","setRoomExists","showJoinButton","setShowJoinButton","_useState21","_useState22","callToJoin","setCallToJoin","_useState23","_useState24","isVideoEnabled","setIsVideoEnabled","_useState25","_useState26","isAudioEnabled","setIsAudioEnabled","_useState27","_useState28","inCall","setInCall","_useState29","_useState30","_useState31","_useState32","isCalleeJoined","setIsCalleeJoined","_useState33","_useState34","_useState35","_useState36","showChat","setShowChat","calleeCandidatesUnsubscribe","configuration","iceServers","urls","username","credential","iceCandidatePoolSize","openUserMedia","stream","navigator","mediaDevices","getUserMedia","video","audio","srcObject","MediaStream","hangUp","checkRoomExists","roomRef","roomSnapshot","roomsCollection","createRoom","newPeerConnection","videoCallStatusDocRef","_setDoc","_updateDoc","callerCandidatesCollection","roomWithOffer","RTCPeerConnection","registerPeerConnectionListeners","getTracks","track","addTrack","isEnabled","merge","candidate","signalingState","toJSON","createOffer","setLocalDescription","sdp","streams","rtcSessionDescription","currentRemoteDescription","answer","RTCSessionDescription","setRemoteDescription","JSON","stringify","addIceCandidate","RTCIceCandidate","getVideoTracks","enabled","joinRoom","calleeCandidatesCollection","roomWithAnswer","createAnswer","_callee10","profilePictureURL","_context10","_ref11","close","poster","handleHangUp","pc","iceGatheringState","connectionState","iceConnectionState","handleMuteAudio","getAudioTracks","handleStopVideo","_ref12","_callee11","videoTrack","userStatusDocRef","_setDoc2","localVideoElement","_context11","docSnapshot","otherUserStatus","fontSize","ChatContainerCalls","margin","autoPlay","playsInline","muted","textAlign","toggleColumns","isShareChatOpen","setUserData","showVideoCall","setShowVideoCall","incomingCall","setIncomingCall","showCall","setShowCall","incomingPhoneCall","setIncomingPhoneCall","showVideoCallAnimation","setShowVideoCallAnimation","showCallAnimation","setShowCallAnimation","toggleVideoCall","videoWrapper","document","querySelector","classList","remove","add","toggleCall","videoCAllWrapper","mediaQuery","prevUserData","handleResize","addListener","removeListener","fetchUserData","userTypeRef","_userData","_userData$displayName","_userData$occupation","fetchData","fetchSessionAndUpdate","conversationsCollectionRef","discussionID","conversationRef","conversationSnapshot","handleImageClick","Error","marginRight","role","ChatServiceconversation","VideoChatApp","VideoCallApp","isRightColumnVisible","initialLoad","setInitialLoad","ChatHeader","setIsActive","setSelectedMenu","setIsRightColumnVisible","setIsMiddleColumnVisible","setIsLeftColumnVisible","locationState","useLocation","state","locationOtherUserUID","setOtherUserUID","prevVisibility","body","overflow","LeftColumn","menu","MiddleColumn","newOtherUserID","currentUserID","RightColumn","_objectWithoutProperties","source","excluded","i","getOwnPropertySymbols","sourceSymbolKeys","indexOf","prototype","propertyIsEnumerable","call","_objectWithoutPropertiesLoose","sourceKeys"],"sourceRoot":""}