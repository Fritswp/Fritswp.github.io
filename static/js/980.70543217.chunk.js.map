{"version":3,"file":"static/js/980.70543217.chunk.js","mappings":"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","sources":["Chat/LeftColumn.js","Chat/ChatHistory.js","Chat/Contacts.js","Chat/Profile.js","Chat/MiddleColumn.js","Chat/ChatServiceconversation.js","Chat/ChatService.js","Chat/ChatContainerCall.js","Chat/VideoChatApp.js","Chat/VideoCallApp.js","Chat/Chatheader.js","Chat/RightColumn.js","Chat/Chat.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { auth } from '../firebase';\n\nconst LeftColumn = ({ handleButtonClick, isLeftColumnVisible }) => {\n  const [activeButton, setActiveButton] = useState(null);\n  const [currentUser, setCurrentUser] = useState(null);\n  const isMobile = window.innerWidth <= 768;\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n      if (user) {\n        setCurrentUser(user); // Set the current user when authenticated\n      } else {\n        setCurrentUser(null); // Reset the current user if not authenticated\n      }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n  }, []);\n\n  const handleButtonClickInternal = (buttonName) => {\n    // Call the parent function passed as a prop\n    handleButtonClick(buttonName);\n    setActiveButton(buttonName);\n  };\n\n  const goBack = () => {\n    window.history.back(); // This will go back one page in the browser history\n  };\n\n    return (\n<div className={`chat-left ${isLeftColumnVisible ? '' : 'hide'}`}>\n        <div className=\"chatleft-column\">\n            <div className=\"d-none d-md-block mb-4\"> \n            <div className=\"avatar-section\">\n            {currentUser && currentUser.photoURL && ( // Check if currentUser and photoURL exist\n              <img\n                src={currentUser.photoURL} // Use currentUser's photoURL\n                alt=\"Avatar\"\n                className=\"w-100 h-auto rounded-circle\"\n                style={{ maxWidth: '12rem' }}\n              />\n            )}\n  </div>\n\n  \n  \n            <hr className=\"avatar-divider\" />\n            </div>\n      \n            <div className=\"LeftColumn-buttons \">\n        <div className=\"chatbutton-container flex-wrap justify-content-center justify-content-md-start gap-2\">\n  \n            <div className=\"button-container\" onClick={() => handleButtonClickInternal('Chat History')}>\n  <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z\" />\n      </svg>\n      \n          </button>\n  \n          {activeButton === 'Chat History' && <div className=\"activated-indicator\"></div>}\n          </div>\n  \n          <div className=\"button-container\" onClick={() => handleButtonClickInternal('Contacts')}>\n          <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM4 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 0110.374 21c-2.331 0-4.512-.645-6.374-1.766z\" />\n            </svg>\n          </button>\n          {activeButton === 'Contacts' && <div className=\"activated-indicator\"></div>}\n        </div>\n  \n        <div className=\"button-container\" onClick={() => handleButtonClickInternal('Profile')}>\n      <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z\" />\n      </svg>\n          </button>\n  \n          {activeButton === 'Profile' && <div className=\"activated-indicator\"></div>}\n          </div>\n  \n       <div className=\"button-container\" onClick={() => handleButtonClickInternal('Settings')}>\n      <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z\" />\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n      </svg>\n          </button>\n          {activeButton === 'Settings' && <div className=\"activated-indicator\"></div>}\n          </div>\n          {isMobile && (\n            <div className=\"button-container\" onClick={() => handleButtonClickInternal('Back')}>\n              <button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\" onClick={goBack}>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n                </svg>\n              </button>\n            </div>\n          )}\n  \n   </div>\n   \n   </div>\n   {!isMobile && (\n   <div className='logout-container '>\n<button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\" onClick={goBack}>\n<svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n</svg>\n</button>\n</div>\n   )}\n    \n            </div>\n            </div>\n    );\n  };\n  export default LeftColumn;","import React, { useState, useEffect } from 'react';\nimport { db, collection, doc, getDoc, getDocs, onSnapshot } from '../firebase';\nimport { auth } from '../firebase'; // Import Firebase auth\nimport { deleteDoc } from 'firebase/firestore';\n\nconst ChatHistory = ({ isActive, toggleRightColumnVisibility, updateOtherUserID, otherUserUID }) => {\nconst [showChatHistory, setShowChatHistory] = useState(false);\nconst [currentUserUID, setCurrentUserUID] = useState('');\nconst [otherUserIDs, setOtherUserIDs] = useState([]);\nconst [chatsWithUserData, setChatsWithUserData] = useState([]);\nconst [userProfilesCache, setUserProfilesCache] = useState({});\nconst [hasNewMessages, setHasNewMessages] = useState(false);\nconst [hasNewChats, setHasNewChats] = useState(false);\nconst [unreadMessages, setUnreadMessages] = useState({});\nconst [callingUserID, setCallingUserID] = useState(null);\n\n\nuseEffect(() => {\nconst isMobile = window.matchMedia('(max-width: 768px)').matches;\nif (!isMobile) {\n// Run the updateOtherUserID logic only on desktop\nif (!otherUserUID && chatsWithUserData.length > 0) {\nconst firstChat = chatsWithUserData[0];\nconst firstChatOtherUserID = firstChat?.otherUserID || null;\nupdateOtherUserID(firstChatOtherUserID, currentUserUID);\n}\n}\n}, [chatsWithUserData, otherUserUID, currentUserUID, updateOtherUserID]);\n\nuseEffect(() => {\nconst fetchChatsForCurrentUser = async (authUID) => {\nconst chatsCollection = collection(db, 'chats');\ntry {\nconst querySnapshot = await getDocs(chatsCollection);\nconst chats = [];\nquerySnapshot.forEach((doc) => {\nconst chatID = doc.id;\nconst [fetchedAuthUID, fetchedOtherUserID] = chatID.split('_');\nif (fetchedAuthUID === authUID || fetchedOtherUserID === authUID) {\nconst otherUserID = fetchedAuthUID === authUID ? fetchedOtherUserID : fetchedAuthUID;\nsetOtherUserIDs((prevUserIDs) => [...prevUserIDs, otherUserID]);\nchats.push({ id: doc.id, data: doc.data(), otherUserID });\n}\n});\n// Check if there are new chats or messages\nconst hasNewMessages = chats.some(chat => chat.data.messages);\nconst hasNewChats = chats.length > chatsWithUserData.length;\nif (hasNewMessages) {\nsetHasNewMessages(true);\n}\nif (hasNewChats) {\nsetHasNewChats(true);\n}\nsetChatsWithUserData(chats);\n// Use onSnapshot to listen for real-time updates\nconst unsubscribe = onSnapshot(chatsCollection, (snapshot) => {\nsnapshot.docChanges().forEach((change) => {\nconst chatID = change.doc.id;\nconst [fetchedAuthUID, fetchedOtherUserID] = chatID.split('_');\nconst otherUserID = fetchedAuthUID === authUID ? fetchedOtherUserID : fetchedAuthUID;\n// Check if the change is related to the current user\nif (fetchedAuthUID === authUID || fetchedOtherUserID === authUID) {\n// Handle the change based on the type (added, modified, removed)\nif (change.type === 'added' || change.type === 'modified') {\n// Update the state with the new or modified chat\nsetChatsWithUserData((prevChats) => {\nconst existingChatIndex = prevChats.findIndex((chat) => chat.id === chatID);\nif (existingChatIndex !== -1) {\n// Modify existing chat\nconst updatedChats = [...prevChats];\nupdatedChats[existingChatIndex] = { id: chatID, data: change.doc.data(), otherUserID };\nreturn updatedChats;\n} else {\n// Add new chat\nreturn [...prevChats, { id: chatID, data: change.doc.data(), otherUserID }];\n}\n});\n// Set hasNewMessages or hasNewChats accordingly\nif (change.doc.data().messages) {\nsetHasNewMessages(true);\n} else {\nsetHasNewChats(true);\n}\n} else if (change.type === 'removed') {\n// Handle the removal of a chat\nsetChatsWithUserData((prevChats) => prevChats.filter((chat) => chat.id !== chatID));\n}\n}\n});\n}); \nreturn () => {\nunsubscribe();\n};\n} catch (error) {\nconsole.error('Error fetching chats:', error);\n}\n};\n\nconst unsubscribe = auth.onAuthStateChanged((user) => {\nif (user) {\nconst authUID = user.uid;\nsetCurrentUserUID(authUID);\nfetchChatsForCurrentUser(authUID);\n}\n});\nreturn () => {\nunsubscribe();\n};\n}, []);\n\nconst fetchUserProfiles = async (otherUserID) => {\nif (userProfilesCache[otherUserID]) {\nreturn userProfilesCache[otherUserID];\n}\nconst firestore = db;\nlet userData = {};\ntry {\nconst expertAppsRef = collection(firestore, 'expertApplications');\nconst expertAppDoc = doc(expertAppsRef, otherUserID);\nconst expertDocSnap = await getDoc(expertAppDoc);\nif (expertDocSnap.exists()) {\nconst expertData = expertDocSnap.data();\nuserData = {\nphotoURL: expertData.photoURL || '',\ndisplayName: expertData.displayName || 'Unknown',\n};\n} else {\nconst userProfilesRef = collection(firestore, 'userProfiles');\nconst userProfileDoc = doc(userProfilesRef, otherUserID);\nconst docSnap = await getDoc(userProfileDoc);\n\nif (docSnap.exists()) {\nconst userProfileData = docSnap.data();\nuserData = {\nphotoURL: userProfileData.photoURL || '',\ndisplayName: userProfileData.displayName || 'Unknown',\n};\n}\n}\n\nsetUserProfilesCache(prevCache => ({\n...prevCache,\n[otherUserID]: userData,\n}));\n} catch (error) {\nconsole.error('Error getting user profile:', error);\n}\nreturn userData;\n};\n\nuseEffect(() => {\nconst updateChatsWithUserData = async () => {\nconst updatedChats = await Promise.all(\nchatsWithUserData.map(async (chat) => {\nconst userData = await fetchUserProfiles(chat.otherUserID);\nreturn { ...chat, userData };\n})\n);\nsetChatsWithUserData(updatedChats);\n};\nif (chatsWithUserData.length > 0) {\nupdateChatsWithUserData();\n}\n}, [chatsWithUserData]);\n\nconst handleDeleteChat = async (chatID, event) => {\nevent.stopPropagation();\ntry {\nawait deleteDoc(doc(db, 'chats', chatID));\nupdateOtherUserID(null, currentUserUID);\nsetChatsWithUserData((prevChats) => prevChats.filter((chat) => chat.id !== chatID));\n} catch (error) {\nconsole.error('Error deleting chat:', error);\n}\n};\n\nconst handleChatButtonClick = (otherUserID, currentUserID) => {\nupdateOtherUserID(otherUserID, currentUserID);\nsetShowChatHistory(true);\ntoggleRightColumnVisibility();\n};\n\nconst hasUnreadMessages = async (chat, currentUserUID) => {\ntry {\nconst chatID = chat.id;\nconst messagesCollectionRef = collection(db, `chats/${chatID}/messages`);\nconst querySnapshot = await getDocs(messagesCollectionRef);\nfor (const doc of querySnapshot.docs) {\nconst message = doc.data();\nif (message.receiver === currentUserUID && !message.isRead) {\nreturn true;\n}\n}\nreturn false;\n} catch (error) {\nconsole.error('Error checking for unread messages:', error);\nreturn false;\n}\n};\nuseEffect(() => {\nconst fetchUnreadMessages = async () => {\nconst unreadMessages = await Promise.all(chatsWithUserData.map(chat => hasUnreadMessages(chat, currentUserUID)));\nsetUnreadMessages(unreadMessages);\n};\n\nfetchUnreadMessages();\n}, [chatsWithUserData, currentUserUID]);\n\nuseEffect(() => {\n  if (currentUserUID) {\n    const unsubscribeRooms = onSnapshot(collection(db, 'rooms'), (querySnapshot) => {\n      querySnapshot.docChanges().forEach((change) => {\n        const doc = change.doc;\n        const roomID = doc.id;\n        const roomData = doc.data();\n        const [user1, user2] = roomID.split('_');\n\n        if (change.type === 'added') {\n          // Check if the room contains the current user and has an offer (indicating an ongoing call)\n          if ((user1 === currentUserUID || user2 === currentUserUID) && roomData.offer) {\n            // Set the calling user ID based on the other user in the room\n            setCallingUserID(user1 === currentUserUID ? user2 : user1);\n          }\n        } else if (change.type === 'removed') {\n          // Check if the room that was removed contained the current user\n          if (user1 === currentUserUID || user2 === currentUserUID) {\n            setCallingUserID(null);\n          }\n        }\n      });\n    });\n\n    const unsubscribeCalls = onSnapshot(collection(db, 'calls'), (querySnapshot) => {\n      querySnapshot.docChanges().forEach((change) => {\n        const doc = change.doc;\n        const callID = doc.id;\n        const callData = doc.data();\n        const [user1, user2] = callID.split('_');\n\n        if (change.type === 'added') {\n          // Check if the call contains the current user and has an offer (indicating an ongoing call)\n          if ((user1 === currentUserUID || user2 === currentUserUID) && callData.offer) {\n            // Set the calling user ID based on the other user in the call\n            setCallingUserID(user1 === currentUserUID ? user2 : user1);\n          }\n        } else if (change.type === 'removed') {\n          // Check if the call that was removed contained the current user\n          if (user1 === currentUserUID || user2 === currentUserUID) {\n            setCallingUserID(null);\n          }\n        }\n      });\n    });\n\n    return () => {\n      unsubscribeRooms();\n      unsubscribeCalls();\n    };\n  }\n}, [currentUserUID]);\n\n\n\n\n\n\n\n\n\nreturn (\n<div className={isActive ? 'visible' : 'hidden'}>\n<div className=\"p-2 flex flex-col gap-2 h-full\">\n<div className=\" d-flex flex-column gap-2\">\n<div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n<div>\n<h4>Chats</h4>\n</div>\n<div className=\"d-flex \">\n\n<button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155\" />\n</svg>\n</button> \n<button type=\"button\" className=\"py-3 px-3 gap-4 chat-btn\">\n<svg xmlns=\"http://www.w3.org/2000/svg\" color= '#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z\" />\n</svg>\n</button>\n</div>\n</div>\n<div className=\"relative flex flex-col\">\n<div>\n</div>\n</div>\n{chatsWithUserData.map((chat, index) => (\n  <div key={index} className=\"relative\">\n    <button\n     className=\"chatbutton-history\"\n      onClick={() => handleChatButtonClick(chat.otherUserID, currentUserUID)}\n    >\n      <div className=\"avatar-wrapper\">\n      <div className={`avatar-inner ${unreadMessages[index] || callingUserID === chat.otherUserID ? 'unread-border-overlay' : ''}`}>\n          <img\n            src={chat.userData?.photoURL || `${process.env.PUBLIC_URL}/images/arts/user.webp`}\n            alt=\"Avatar\"\n            className=\"small-avatar-mobile rounded-circle\"\n          />\n        </div>\n      </div>\n   \n        <p className=\"font-weight-bold mb-0 text-start ms-2\">{chat.userData?.displayName}</p>\n    \n      <div className=''>\n        <button className='delete-button-history' onClick={(event) => handleDeleteChat(chat.id, event)}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" color='#212529' fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1} stroke=\"currentColor\" height=\"25\" width=\"25\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\" />\n          </svg>\n        </button>\n      </div>\n    </button>\n  </div>\n))}\n\n\n\n</div>\n</div>\n</div>\n);\n};\nexport default ChatHistory;\n","import React, { useState, useEffect } from 'react';\nimport { collection, getDocs, getDoc, doc } from 'firebase/firestore';\nimport { Link } from 'react-router-dom'; // Import Link from React Router\nimport { firestore } from '../firebase';\nimport Fuse from 'fuse.js';\n\n\nconst Contacts = ({ toggleRightColumnVisibility }) => {\n  const [showContacts, setShowContacts] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n\n  useEffect(() => {\n    if (searchQuery.trim() !== '') {\n      const fetchData = async (collectionName) => {\n        const collectionRef = collection(firestore, collectionName);\n        const querySnapshot = await getDocs(collectionRef);\n        const data = [];\n\n        querySnapshot.forEach((doc) => {\n          const item = { ...doc.data(), otherUserUID: doc.id };\n          data.push(item);\n        });\n\n        return data;\n      };\n\n      const fetchExpertData = fetchData('expertApplications');\n      const fetchProfileData = fetchData('userProfiles');\n\n      Promise.all([fetchExpertData, fetchProfileData])\n        .then(([expertsData, profilesData]) => {\n          const combinedData = [...expertsData, ...profilesData];\n\n          const fuseOptions = {\n            keys: ['displayName', 'occupation', 'keywords'],\n            includeScore: true,\n            includeMatches: true,\n            threshold: 0.4,\n          };\n\n          const fuse = new Fuse(combinedData, fuseOptions);\n          const searchResults = fuse.search(searchQuery).map((result) => result.item);\n\n          setSearchResults(searchResults);\n        })\n        .catch((error) => {\n          console.error('Error fetching search results:', error);\n        });\n    } else {\n      setSearchResults([]);\n    }\n  }, [searchQuery]);\n\n  const handleSearchInputChange = (e) => {\n    setSearchQuery(e.target.value);\n  };\n\n  const handleSearchKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      toggleRightColumnVisibility();\n    }\n  };\n\n  const handleButtonClick = async (result) => {\n    toggleRightColumnVisibility();\n\n    try {\n      const expertAppsRef = collection(firestore, 'expertApplications');\n      const expertDocSnap = await getDoc(doc(expertAppsRef, result.otherUserUID));\n\n      console.log('Expert Doc Snap:', expertDocSnap.data());\n\n      if (expertDocSnap.exists()) {\n        const customURL = expertDocSnap.data().customURL;\n        console.log('Custom URL:', customURL);\n        window.location.href = `/expert/${customURL}`; // Use React Router's Link path\n      } else {\n        const userProfilesRef = collection(firestore, 'userProfiles');\n        const userDocSnap = await getDoc(doc(userProfilesRef, result.otherUserUID));\n\n        console.log('User Doc Snap:', userDocSnap.data());\n\n        if (userDocSnap.exists()) {\n          const customURL = userDocSnap.data().customURL;\n          console.log('Custom URL:', customURL);\n          window.location.href = `/user/${customURL}`; // Use React Router's Link path\n        } else {\n          console.log('User profile not found for the specified UID.');\n        }\n      }\n    } catch (error) {\n      console.error('Error handling button click:', error.message);\n    }\n  };\n  \n  return (\n    <div className=\"d-flex flex-column gap-2 mt-3\">\n      <div className=\"input-container\">\n        <input\n          type=\"text\"\n          className=\"chat-search-input\"\n          placeholder=\"Search for Experts\"\n          value={searchQuery}\n          onChange={handleSearchInputChange}\n          onKeyDown={handleSearchKeyPress}\n        />\n      </div>\n      {searchResults.map((result, index) => (\n          <Link>\n        <button\n          key={index}\n          className=\"py-2 px-2 pe-5 gap-4 chat-btn\"\n          onClick={() => handleButtonClick(result)}\n        >\n          <div className=\"row align-items-center\">\n            <div className=\"col-auto\">\n              <div className=\"small-avatar\">\n                <img\n                  src={result.photoURL || 'avatar.png'}\n                  alt=\"Avatar\"\n                  className=\"w-100 h-auto rounded-circle\"\n                  style={{ maxWidth: '12rem' }}\n                />\n              </div>\n            </div>\n            <div className=\"col\">\n              <div className=\"text-end\">\n                <p className=\"font-weight-bold mb-0\">{result.displayName}</p>\n                <p className=\"text-sm text-muted\">{result.occupation}</p>\n              </div>\n            </div>\n          </div>\n        </button>\n         </Link>\n      ))}\n    </div>\n  );\n};\n\nexport default Contacts;\n","import React, { useEffect, useState } from 'react';\nimport { auth, firestore } from '../firebase'; \nimport { doc, getDoc } from 'firebase/firestore';\n\nconst Profile = () => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [description, setDescription] = useState('');\n  const [city, setCity] = useState('');\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(async (user) => {\n      if (user) {\n        setCurrentUser(user);\n\n        // Check if user exists in expertApplications collection\n        const expertProfileRef = doc(firestore, 'expertApplications', user.uid);\n        const expertProfileSnapshot = await getDoc(expertProfileRef);\n\n        if (expertProfileSnapshot.exists()) {\n          const expertProfileData = expertProfileSnapshot.data();\n          setDescription(expertProfileData.description || ''); // Set description from expertApplications\n          setCity(expertProfileData.city || ''); // Set city from expertApplications\n        } else {\n          // If user not found in expertApplications, check in userProfiles collection\n          const userProfileRef = doc(firestore, 'userProfiles', user.uid);\n          const userProfileSnapshot = await getDoc(userProfileRef);\n\n          if (userProfileSnapshot.exists()) {\n            const userProfileData = userProfileSnapshot.data();\n            setDescription(userProfileData.description || ''); // Set description from userProfiles\n            setCity(userProfileData.city || ''); // Set city from userProfiles\n          } else {\n            // Handle case where user doesn't exist in either collection\n            setDescription('Description not found');\n            setCity('City not found');\n          }\n        }\n      } else {\n        setCurrentUser(null);\n        setDescription('');\n        setCity('');\n      }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n  }, []);\n\n\n  return (\n    <div className=\"d-flex flex-column gap-2 mt-3\">\n      <div className=\"justify-content-center align-items-center px-8\">\n        <div className=\"text-center\">\n          {currentUser && currentUser.photoURL && (\n            <img\n              className=\"medium-avatar mx-auto user-avatar mb-2\"\n              src={currentUser.photoURL}\n              alt=\"User Avatar\"\n            />\n          )}\n          {currentUser && currentUser.displayName && (\n            <>\n              <h4>{currentUser.displayName}</h4>\n              <p className='text-muted'>{description}</p> {/* Display bio here */}\n              <hr className=\"avatar-divider\" />\n            </>\n          )}\n        </div>\n\n\n</div>\n<button\n    className=\"d-flex chat-btn chat-btn-history align-items-center px-4 p-2  w-100  gap-4\"\n      style={{ transform: 'none' }}\n      // Add any additional props you need\n    >\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" style={{ paddingRight: '5px' }} fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={2} stroke=\"currentColor\" height=\"30\" width=\"30\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75\" />\n            </svg>\n\n   My Pofile\n    </button>\n    <button\n    className=\"d-flex chat-btn chat-btn-history align-items-center px-4 p-2  gap-4   w-100 \"\n      style={{ transform: 'none' }}\n      // Add any additional props you need\n    >\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" color=\"#212529\" style={{ paddingRight: '5px' }} fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={2} stroke=\"currentColor\" height=\"30\" width=\"30\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z\" />\n  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z\" />\n            </svg>\n\n            {city}\n    </button>\n</div>\n\n  \n  );\n};\n\nexport default Profile;\n","import React, { useEffect, useState } from 'react';\nimport ChatHistory from './ChatHistory';\nimport Contacts from './Contacts';\nimport Profile from './Profile';\n\nconst MiddleColumn = ({ selectedMenu, toggleRightColumnVisibility,  updateOtherUserID, isMiddleColumnVisible, setActiveButton, otherUserUID, currentUserUID}) => {\n  const [currentMenu, setCurrentMenu] = useState(selectedMenu);\n  const [isVisible, setIsVisible] = useState(true);\n  const [isChatVisible, setIsChatVisible] = useState(true);\n\n  useEffect(() => {\n    setIsVisible(false);\n    const timeoutId = setTimeout(() => {\n      setCurrentMenu(selectedMenu);\n      setIsVisible(true);\n      setIsChatVisible(selectedMenu === 'Chat History'); // Set Chat visibility based on selectedMenu\n    }, 300);\n\n    return () => clearTimeout(timeoutId);\n  }, [selectedMenu]);\n\n  const switchToChatHistory = (updateActiveButton) => {\n    setCurrentMenu('Chat History');\n    setIsChatVisible(true);\n    updateActiveButton('Chat History'); // Update the active button in the parent component\n  };\n\n  return (\n    <div className={`chat-middle pt-4 ${isMiddleColumnVisible ? '' : 'hide'}`}>\n      <div className={`chat-component ${isVisible && isChatVisible ? 'visible' : 'hidden'}`}>\n        {currentMenu === 'Chat History' && (\n          <ChatHistory otherUserUID={otherUserUID}  updateOtherUserID={updateOtherUserID}  toggleRightColumnVisibility={toggleRightColumnVisibility} currentUserUID={currentUserUID}/>\n        )}\n      </div>\n      <div className={`contacts-component ${isVisible && !isChatVisible ? 'visible' : 'hidden'}`}>\n      {currentMenu === 'Contacts' && (\n          <Contacts switchToChatHistory={switchToChatHistory} setActiveButton={setActiveButton} toggleRightColumnVisibility={toggleRightColumnVisibility}  />\n        )}\n      </div>\n      <div className={`profile-component ${isVisible && currentMenu === 'Profile' ? 'visible' : 'hidden'}`}>\n        {currentMenu === 'Profile' && <Profile />}\n      </div>\n    </div>\n  );\n};\n\nexport default MiddleColumn;\n","import React, { useEffect, useState } from 'react';\nimport { collection, getDocs, query, orderBy, doc, getDoc } from 'firebase/firestore';\nimport { firestore, auth } from '../firebase';\nimport ReactMarkdown from 'react-markdown';\nimport LoadingCircle from '../components/LoadingCircle';\n\nconst ChatServiceconversation = ({ selectedSession, currentUserUID, otherUserUID, closeShareChat }) => {\n  const [sharedChatData, setSharedChatData] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [selectedMessageUID, setSelectedMessageUID] = useState(null);\n\n  useEffect(() => {\n    const determineSelectedMessageUID = async () => {\n      try {\n        const expertAppDocRef = doc(collection(firestore, 'expertApplications'), currentUserUID);\n        const expertAppSnapshot = await getDoc(expertAppDocRef);\n  \n        // Set selectedMessageUID based on the presence of currentUserUID in the expertApplications collection\n        setSelectedMessageUID(expertAppSnapshot.exists() ? otherUserUID : currentUserUID);\n  \n        console.log('Determining selectedMessageUID:', {\n          otherUserUID,\n          currentUserUID,\n          existsInExpertApplications: expertAppSnapshot.exists(),\n          determinedMessageUID: expertAppSnapshot.exists() ? otherUserUID : currentUserUID,\n        });\n      } catch (error) {\n        console.error('Error determining selectedMessageUID:', error);\n      }\n    };\n  \n    determineSelectedMessageUID();\n  }, [currentUserUID, otherUserUID]);\n\n  \n  useEffect(() => {\n    const fetchSharedChatData = async () => {\n      try {\n        if (selectedSession && selectedMessageUID) { // Check if selectedMessageUID is defined\n          const messagesCollectionRef = collection(firestore, 'users', selectedMessageUID, 'discussions', selectedSession, 'messages');\n          console.log('Path for messagesCollectionRef:', messagesCollectionRef.path); // Log the path\n          const messagesSnapshot = await getDocs(query(messagesCollectionRef, orderBy('createTime')));\n          const messagesData = messagesSnapshot.docs.map((doc) => {\n            const { prompt, response } = doc.data();\n            return { prompt, response };\n          });\n          setSharedChatData(messagesData);\n          setIsLoading(false); // Set loading to false when data is fetched\n          console.log('Fetched messages for discussionId:', selectedSession, messagesData);\n        }\n      } catch (error) {\n        console.error('Error fetching shared chat messages:', error);\n        setIsLoading(false); // Set loading to false on error\n      }\n    };\n  \n    fetchSharedChatData();\n  }, [selectedSession, selectedMessageUID]); // Include selectedMessageUID in the dependencies array\n  \n\n  if (!selectedMessageUID) {\n    return null; // or render a loading state if needed until selectedMessageUID is determined\n  }\n\n  return (\n   <div className=\"blurred-background\">\n    <div className=\"white-box-chathistory\">\n      <div className=\"go-back-svg go-back-svg-padding\">\n        <button onClick={closeShareChat}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} color=\"black\" stroke=\"currentColor\" className=\"w-6 h-6\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </button>\n      </div>\n\n      <h2>Share link to Chat</h2>\n      <div className='divider '></div>\n      <p>\n        Messages you send after creating your link won't be shared. Anyone with the URL will be able to view the shared chat.\n      </p>\n      <div className=\"shared-chat scroll-cat\">\n        {isLoading ? (\n          <LoadingCircle />\n        ) : (\n          sharedChatData.map((message, index) => (\n            <div key={index} className=\"chat-message\">\n              <strong>\n                <ReactMarkdown>{message.prompt}</ReactMarkdown>\n\n              </strong>\n              <ReactMarkdown>{message.response}</ReactMarkdown>\n              <div className='divider '></div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n    </div>\n  );\n};\n\nexport default ChatServiceconversation;\n","import { db, collection, doc, onSnapshot, setDoc, serverTimestamp, updateDoc, getDocs, query, where, addDoc } from '../firebase';\nimport { getStorage, ref, uploadBytes, getDownloadURL } from 'firebase/storage';\n\nconst storage = getStorage(); \n\nconst chatsCollection = collection(db, 'chats');\n\nconst createChatID = (currentUserUID, otherUserUID) => {\n  return currentUserUID < otherUserUID\n    ? `${currentUserUID}_${otherUserUID}`\n    : `${otherUserUID}_${currentUserUID}`;\n};\n\nconst sendMessage = async (currentUserUID, otherUserUID, messageText, selectedFile) => {\n  try {\n    const chatID = createChatID(currentUserUID, otherUserUID);\n    const chatDocRef = doc(chatsCollection, chatID);\n\n    // Check if a file is present\n    if (selectedFile) {\n      const storageRef = ref(storage, `chat_files/${currentUserUID}/${otherUserUID}/${Date.now()}_${selectedFile.name}`);\n\n      // Upload the file to the specified storage location\n      await uploadBytes(storageRef, selectedFile);\n\n      // Get the download URL for the uploaded file\n      const downloadURL = await getDownloadURL(storageRef);\n\n      // Include this download URL in your message object\n      const messageObject = {\n        text: messageText,\n        file: {\n          name: selectedFile.name,\n          type: selectedFile.type,\n          url: downloadURL,\n        },\n        sender: currentUserUID,\n        receiver: otherUserUID,\n        timestamp: serverTimestamp(),\n        isRead: false,\n      };\n\n      // Then add the message to the 'messages' subcollection\n      const messagesCollectionRef = collection(chatDocRef, 'messages');\n      await addDoc(messagesCollectionRef, messageObject);\n    } else {\n      // Handle text messages\n      const messageObject = {\n        text: messageText,\n        sender: currentUserUID,\n        receiver: otherUserUID,\n        timestamp: serverTimestamp(),\n        isRead: false,\n      };\n\n      // Then add the message to the 'messages' subcollection\n      const messagesCollectionRef = collection(chatDocRef, 'messages');\n      await addDoc(messagesCollectionRef, messageObject);\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Error sending message:', error);\n    return false;\n  }\n};\n\n\nconst getMessages = (currentUserUID, otherUserUID, callback) => {\n  try {\n    const chatID = createChatID(currentUserUID, otherUserUID);\n    const chatDocRef = doc(chatsCollection, chatID);\n    const messagesCollectionRef = collection(chatDocRef, 'messages');\n\n    onSnapshot(messagesCollectionRef, (snapshot) => {\n      try {\n        const messages = snapshot.docs.map((doc) => {\n          return { id: doc.id, ...doc.data() };\n        });\n        const allMessages = messages.sort((a, b) => b.timestamp - a.timestamp);\n        const reversedMessages = allMessages.reverse();\n        callback(reversedMessages);\n      } catch (error) {\n        console.error('Error getting messages:', error);\n        callback([]); // Handle errors by returning an empty array or taking appropriate action\n      }\n    });\n  } catch (error) {\n    console.error('Error getting messages:', error);\n    callback([]); // Handle errors by returning an empty array or taking appropriate action\n  }\n};\n\nconst markMessageAsRead = async (currentUserUID, otherUserUID, messages) => {\n  try {\n    const chatID = createChatID(currentUserUID, otherUserUID);\n    const chatDocRef = doc(chatsCollection, chatID);\n    const messagesCollectionRef = collection(chatDocRef, 'messages');\n\n    // Loop through each message\n    messages.forEach(async (message) => {\n      // Check if the message has already been marked as read\n      if (!message.isRead && message.receiver === currentUserUID) {\n        // If the current user is the receiver and the message is unread, mark it as read\n        const messageDocRef = doc(messagesCollectionRef, message.id);\n        await updateDoc(messageDocRef, { isRead: true });\n        console.log('Message marked as read:', message.id);\n      }\n    });\n  } catch (error) {\n    console.error('Error marking messages as read:', error);\n  }\n};\n\nexport { sendMessage, getMessages, markMessageAsRead };\n","import React, { useState, useEffect, useRef } from 'react';\nimport { sendMessage, getMessages, markMessageAsRead } from './ChatService';\nimport { auth, onAuthStateChanged, db } from '../firebase';\nimport { onSnapshot, collection, getDocs } from 'firebase/firestore';\n\n\nconst ChatContainerCalls = ({ otherUserUID }) => {\n  const [messages, setMessages] = useState([]);\n  const chatBoxRef = useRef(null);\n  const messageInputRef = useRef(null);\n  const [inputValue, setInputValue] = useState('');\n  const [currentUserUID, setCurrentUserUID] = useState(null);\n  const [isChattingWithSelf, setIsChattingWithSelf] = useState(false);\n  const [textareaHeight, setTextareaHeight] = useState('28px');\n  const maxTextareaHeight = 200;\n\n  const [selectedFile, setSelectedFile] = useState(null);\n  const fileInputRef = useRef(null);\n  const [selectedFilePreview, setSelectedFilePreview] = useState(null);\n  const [lastSeenMessageId, setLastSeenMessageId] = useState(null);\n\n  const [initialLoad, setInitialLoad] = useState(true);\n\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      if (user) {\n        setCurrentUserUID(user.uid);\n      } else {\n        setCurrentUserUID(null);\n      }\n    });\n    return () => unsubscribe(); // Clean up the listener\n  }, []);\n\n  useEffect(() => {\n    setIsChattingWithSelf(currentUserUID === otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        // Reverse the messages here and then set them in the state\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n\n        // Scroll to bottom when new messages are fetched\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n  \n\n  const isMobile = window.innerWidth <= 767; // Adjust the width threshold as needed\n\n  const handleFileUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      setSelectedFile(file);\n      if (file.type && file.type.startsWith('image/')) {\n        // It's an image, no need to display anything\n        setSelectedFilePreview(null);\n      } else {\n        // It's not an image, display the SVG icon and file name\n        setSelectedFilePreview({\n          name: file.name,\n          type: 'file',\n        });\n      }\n    }\n  };\n  \n\n  useEffect(() => {\n    if (selectedFile && selectedFile.type && selectedFile.type.startsWith('image/')) {\n      const reader = new FileReader();\n      reader.onload = (event) => {\n        setSelectedFilePreview(event.target.result);\n      };\n      reader.readAsDataURL(selectedFile);\n    } else {\n      setSelectedFilePreview(null);\n    }\n  }, [selectedFile]);\n  \n\n  const handleMessageSend = async () => {\n    try {\n      if (isChattingWithSelf) {\n        console.error(\"Cannot send messages to yourself.\");\n        console.log('currentUserUID:', currentUserUID);\n        console.log('otherUserUID:', otherUserUID);\n        return;\n      }\n  \n      if (inputValue.trim() === '' && !selectedFile) {\n        return;\n      }\n  \n      if (currentUserUID && otherUserUID) {\n        const success = await sendMessage(currentUserUID, otherUserUID, inputValue, selectedFile);\n        if (success) {\n          setInputValue('');\n          setSelectedFile(null);\n          // Clear the image preview in the userui-input\n          setSelectedFilePreview(null);\n  \n          if (!isMobile) {\n            messageInputRef.current.focus();\n          }\n        }\n      } else {\n        console.error('currentUserUID or otherUserUID is undefined');\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  \n  \n  const scrollToBottom = () => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.scrollTop = chatBoxRef.current.scrollHeight;\n    }\n  };\n  \n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleTextareaResize = () => {\n    const textarea = messageInputRef.current;\n    if (textarea) {\n      const newHeight = Math.min(textarea.scrollHeight, maxTextareaHeight);\n      setTextareaHeight(`${newHeight}px`);\n    }\n  };\n  \n  \n  \n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n  \n\n  const handleInputChange = (e) => {\n    setInputValue(e.target.value);\n    handleTextareaResize();\n  };\n\n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n\n  useEffect(() => {\n    if (inputValue === '') {\n      setTextareaHeight('28px');\n    }\n  }, [inputValue]);\n\n  const formatTimestamp = (timestamp) => {\n    if (timestamp) {\n      const date = timestamp.toDate();\n      const hours = date.getHours().toString().padStart(2, '0'); // Get hours in 24-hour format\n      const minutes = date.getMinutes().toString().padStart(2, '0'); // Get minutes\n      return `${hours}:${minutes}`; // Format to HH:MM\n    }\n    return ''; // Return an empty string if the timestamp is not available\n  };\n\n  const handleScroll = () => {\n    // Calculate the last seen message based on scroll position\n    if (chatBoxRef.current) {\n      const { scrollTop, scrollHeight, clientHeight } = chatBoxRef.current;\n      const lastVisibleMessageIndex = Math.floor(scrollTop / clientHeight);\n      if (lastVisibleMessageIndex >= 0 && lastVisibleMessageIndex < messages.length) {\n        const lastSeenMessage = messages[lastVisibleMessageIndex];\n        setLastSeenMessageId(lastSeenMessage.id);\n      }\n    }\n  };\n  useEffect(() => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.addEventListener('scroll', handleScroll);\n    }\n    return () => {\n      if (chatBoxRef.current) {\n        chatBoxRef.current.removeEventListener('scroll', handleScroll);\n      }\n    };\n  }, [chatBoxRef, messages]); // Add messages to dependency array\n\n\n\n  \n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  \n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID, messages, lastSeenMessageId); // Pass lastSeenMessageId\n  }, [messages, currentUserUID, otherUserUID, lastSeenMessageId]);\n\n\n  return (\n\n      <div className=\"chat-column chat-column-video\">\n        <div className=\"chat-box chat-box-video\" ref={chatBoxRef}>\n    {Array.isArray(messages) && messages.length > 0 ? (\n  messages.map((message, index) =>\n    message.timestamp ? (\n      <div\n        key={index}\n        className={message.sender === currentUserUID ? 'chat-bubble user-sent' : 'chat-bubble'}\n      >\n        <div className=\"message\">\n          {message.file && message.file.type && message.file.type.startsWith('image/') ? (\n            <img\n              src={message.file.url}\n              alt=\"Image\"\n              className=\"rounded-image\"\n            />\n          ) : (\n            message.file && (\n              <div className=\"file-container\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  color=\"#212529\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  strokeWidth={1}\n                  stroke=\"currentColor\"\n                  height=\"25\"\n                  width=\"25\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                  />\n                </svg>\n                <a\n                  href={message.file.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  {message.file.name}\n                </a>\n              </div>\n            )\n          )}\n          {message.text && <p>{message.text}</p>}\n        </div>\n        <div\n          className={`timestamp small-timestamp ${\n            message.sender === currentUserUID ? 'user-sent-timestamp' : 'other-sent-timestamp'\n          }`}\n        >\n          {formatTimestamp(message.timestamp)}\n        </div>\n      </div>\n    ) : null\n  )\n) : (\n  <div>No messages yet.</div>\n)}\n\n\n        </div>\n        <div className=\"chatui-container\">\n    \n            <input\n              type=\"file\"\n              onChange={(e) => handleFileUpload(e)}\n              style={{ display: 'none' }}\n              ref={fileInputRef}\n            />\n            <button className=\"userui-left-button\" onClick={() => fileInputRef.current.click()}>\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                color=\"#212529\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth={1}\n                stroke=\"currentColor\"\n                height=\"25\"\n                width=\"25\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                />\n              </svg>\n            </button>\n            <button\n              aria-label=\"Send Message\"\n              onClick={handleMessageSend}\n              className=\" userui-right-button \"\n            >\n              <i className=\"fas fa-paper-plane\"></i>\n            </button>\n            <div id=\"messageInputContainer\">\n  {selectedFile && (\n    <div className=\"file-info\">\n      {selectedFile.type.startsWith('image/') && (\n        <div className=\"image-preview-container\">\n          <img\n            src={URL.createObjectURL(new Blob([selectedFile], { type: selectedFile.type }))}\n            alt=\"Image Preview\"\n            style={{ maxWidth: '70%', height: 'auto' }}\n          />\n        </div>\n      )}\n      {!selectedFile.type.startsWith('image/') && (\n        <div className=\"file-details\">\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n            />\n          </svg>\n          <span>{selectedFile.name}</span>\n        </div>\n      )}\n<button className=\"remove-button\" onClick={() => setSelectedFile(null)}>X</button>\n    </div>\n  )}\n\n</div>\n\n       \n            <textarea\n  type=\"text\"\n  placeholder=\"Type a message...\"\n  ref={messageInputRef}\n  style={{ height: textareaHeight }}  // <-- Use the style attribute\n  value={inputValue}\n  onChange={handleInputChange}\n  onKeyDown={(e) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleMessageSend();\n    }\n  }}\n  className=\"message-input scroll-col\"\n  autoComplete=\"off\"\n  inputMode=\"text\"\n/>\n\n          </div>\n          \n          </div>\n\n  \n  );\n};\n\nexport default ChatContainerCalls;\n","import React, { useEffect, useRef, useState } from 'react';\nimport { db, auth } from '../firebase';\nimport { collection, doc, setDoc, getDoc, onSnapshot, getDocs, deleteDoc, updateDoc } from 'firebase/firestore';\nimport ChatContainerCalls from './ChatContainerCall';\n\nconst VideoChatApp = ({ currentUserUID, otherUserUID, onClose, userData }) => {\nconst localVideoRef = useRef(null);\nconst remoteVideoRef = useRef(null);\n\nconst [peerConnection, setPeerConnection] = useState(null);\nconst [localStream, setLocalStream] = useState(null);\nconst [remoteStream, setRemoteStream] = useState(null);\nconst [roomId, setRoomId] = useState(null);\nconst [isCreatingRoom, setIsCreatingRoom] = useState(false);\nconst [isJoiningRoom, setIsJoiningRoom] = useState(false);\nconst [roomIdToJoin, setRoomIdToJoin] = useState('');\n\nconst [roomName, setRoomName] = useState('');\nconst [roomExists, setRoomExists] = useState(false);\nconst [showJoinButton, setShowJoinButton] = useState(false);\nconst [callToJoin, setCallToJoin] = useState(false);\nconst [isVideoEnabled, setIsVideoEnabled] = useState(false);\nconst [isAudioEnabled, setIsAudioEnabled] = useState(true);\nconst [inCall, setInCall] = useState(false);\nconst [currentUser, setCurrentUser] = useState(null);\nconst [isCalleeJoined, setIsCalleeJoined] = useState(false);\nconst [isRemoteVideoAvailable, setIsRemoteVideoAvailable] = useState(false);\n\nconst [showChat, setShowChat] = useState(false);\n\n\n\n\n\n\n\nlet calleeCandidatesUnsubscribe = null;\nlet callerCandidatesUnsubscribe = null;\n\nconst configuration = {\n  iceServers: [\n    {\n      urls: [\n        'stun:stun.l.google.com:19302',\n        'stun:stun1.l.google.com:19302',\n        'stun:stun2.l.google.com:19302',\n        'stun:stun3.l.google.com:19302',\n        'stun:stun4.l.google.com:19302',\n      ]\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:443\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turns:standard.relay.metered.ca:443?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n  ],\n  iceCandidatePoolSize: 10,\n};\nuseEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n    if (user) {\n        setCurrentUser(user); // Set the current user when authenticated\n    } else {\n        setCurrentUser(null); // Reset the current user if not authenticated\n    }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n}, []);\n\nuseEffect(() => {\n  const openUserMedia = async () => {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true,\n    });\n  \n    if (localVideoRef.current) {\n      localVideoRef.current.srcObject = stream;\n    }\n  \n    setLocalStream(stream);\n    setRemoteStream(new MediaStream());\n  \n    if (remoteVideoRef.current) {\n      remoteVideoRef.current.srcObject = remoteStream;\n    }\n  \n    if (localVideoRef.current && localVideoRef.current.srcObject) { // Add null check for console.log\n      console.log(\"Stream:\", localVideoRef.current.srcObject);\n    }\n  \n    setIsVideoEnabled(false); // Add this line\n  };\n  \n  \n    openUserMedia();\n  \n    // Clean up function\n    return () => {\n      hangUp();\n    };\n  }, [currentUserUID, otherUserUID]);\n  \n  \n\n\n\nuseEffect(() => {\n    const checkRoomExists = async () => {\n    const roomRef = doc(collection(db, 'rooms'), roomIdToJoin);\n    const roomSnapshot = await getDoc(roomRef);\n    setRoomExists(roomSnapshot.exists());\n    };\n\n    if (roomIdToJoin) {\n    checkRoomExists();\n    }\n}, [roomIdToJoin]);\n\nuseEffect(() => {\n    // Listen for room creation on the callee side\n    const roomsCollection = collection(db, 'rooms');\n    const unsubscribe = onSnapshot(roomsCollection, (snapshot) => {\n    snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n        const roomData = change.doc.data();\n        const roomId = change.doc.id;\n        const swappedRoomId = `${currentUserUID}_${otherUserUID}`;\n        if (roomId === swappedRoomId) {\n            setShowJoinButton(true);\n            setRoomId(roomId);\n            setCallToJoin(true);\n        }\n        }\n    });\n    });\n\n    // Clean up the listener on component unmount\n    return () => unsubscribe();\n}, [currentUserUID, otherUserUID]);\n\nconst createRoom = async () => {\n    // Set the room ID to otherUserUID_currentUserUID\n    const roomId = `${otherUserUID}_${currentUserUID}`;\n  \n    setIsCreatingRoom(true);\n    const roomRef = doc(collection(db, 'rooms'), roomId);\n  \n    const newPeerConnection = new RTCPeerConnection(configuration);\n    setPeerConnection(newPeerConnection);\n  \n    registerPeerConnectionListeners(newPeerConnection);\n  \n    localStream.getTracks().forEach(track => {\n      newPeerConnection.addTrack(track, localStream);\n    });\n  \n    // Create a reference to the videoCallStatus document\n    const videoCallStatusDocRef = doc(db, 'videoCallStatus', roomId);\n  \n    // First, get the document\n    const docSnap = await getDoc(videoCallStatusDocRef);\n  \n    if (!docSnap.exists()) {\n      // If the document doesn't exist, create it\n      await setDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: true,\n        },\n        [otherUserUID]: {\n          isEnabled: true,\n        },\n      });\n    } else {\n      // If the document exists, update it\n      await updateDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: true,\n        },\n        [otherUserUID]: {\n          isEnabled: true,\n        },\n      }, { merge: true });\n    }\n  \n    // Code for collecting ICE candidates\n    const callerCandidatesCollection = collection(db, 'rooms', roomRef.id, 'callerCandidates');\n  \n    newPeerConnection.addEventListener('icecandidate', event => {\n      if (!event.candidate) {\n        console.log('Got final candidate!');\n        return;\n      }\n      console.log('Got candidate: ', event.candidate);\n      if (newPeerConnection.signalingState !== 'closed') {\n        setDoc(doc(callerCandidatesCollection), event.candidate.toJSON());\n      }\n    });\n  \n    // Code for creating a room\n    const offer = await newPeerConnection.createOffer();\n    await newPeerConnection.setLocalDescription(offer);\n    console.log('Created offer:', offer);\n  \n    const roomWithOffer = {\n      'offer': {\n        type: offer.type,\n        sdp: offer.sdp,\n      },\n      'name': roomName, // Add the room name to the room data\n    };\n    await setDoc(roomRef, roomWithOffer);\n    setRoomId(roomRef.id);\n    console.log(`New room created with SDP offer. Room ID: ${roomRef.id}`);\n  \n    // Set remote stream as the srcObject of the remote video element\n    remoteVideoRef.current.srcObject = remoteStream;\n  \n    newPeerConnection.addEventListener('track', event => {\n      console.log('Got remote track:', event.streams[0]);\n      event.streams[0].getTracks().forEach(track => {\n        console.log('Add a track to the remoteStream:', track);\n        remoteStream.addTrack(track);\n      });\n    });\n  \n    // Listening for remote session description\n    onSnapshot(roomRef, async snapshot => {\n      const data = snapshot.data();\n      if (!newPeerConnection.currentRemoteDescription && data && data.answer) {\n        console.log('Got remote description: ', data.answer);\n        const rtcSessionDescription = new RTCSessionDescription(data.answer);\n        await newPeerConnection.setRemoteDescription(rtcSessionDescription);\n      }\n    });\n  \n    // Listen for remote ICE candidates\n    calleeCandidatesUnsubscribe = onSnapshot(collection(db, 'rooms', roomRef.id, 'calleeCandidates'), snapshot => {\n      snapshot.docChanges().forEach(async change => {\n        if (change.type === 'added') {\n    \n            setIsCalleeJoined(true);\n        \n          let data = change.doc.data();\n          console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n          if (newPeerConnection.signalingState !== 'closed') {\n            await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n          }\n        }\n      });\n    });\n    setInCall(true);\n    localStream.getVideoTracks()[0].enabled = true;\n    setIsVideoEnabled(true);\n  };\n  \n\nconst joinRoom = async () => {\n    // Set the room ID to currentUserUID_otherUserUID\n    const roomId = `${currentUserUID}_${otherUserUID}`;\n\n    if (roomId) {\n    setIsJoiningRoom(true);\n    const roomRef = doc(collection(db, 'rooms'), roomId);\n    const roomSnapshot = await getDoc(roomRef);\n\n    if (roomSnapshot.exists()) {\n        console.log('Got room:', roomSnapshot.data());\n        console.log('Create PeerConnection with configuration: ', configuration);\n        const newPeerConnection = new RTCPeerConnection(configuration);\n        setPeerConnection(newPeerConnection);\n        registerPeerConnectionListeners(newPeerConnection);\n        localStream.getTracks().forEach(track => {\n        newPeerConnection.addTrack(track, localStream);\n        });\n\n        // Code for collecting ICE candidates\n        const calleeCandidatesCollection = collection(db, 'rooms', roomId, 'calleeCandidates');\n        newPeerConnection.addEventListener('icecandidate', event => {\n        if (!event.candidate) {\n            console.log('Got final candidate!');\n            return;\n        }\n        console.log('Got candidate: ', event.candidate);\n        setDoc(doc(calleeCandidatesCollection), event.candidate.toJSON());\n        });\n\n        // Set remote stream as the srcObject of the remote video element\n        remoteVideoRef.current.srcObject = remoteStream;\n\n        newPeerConnection.addEventListener('track', event => {\n        console.log('Got remote track:', event.streams[0]);\n        event.streams[0].getTracks().forEach(track => {\n            console.log('Add a track to the remoteStream:', track);\n            remoteStream.addTrack(track);\n        });\n        });\n\n        // Code for creating SDP answer\n        const offer = roomSnapshot.data().offer;\n        console.log('Got offer:', offer);\n        await newPeerConnection.setRemoteDescription(new RTCSessionDescription(offer));\n        const answer = await newPeerConnection.createAnswer();\n        console.log('Created answer:', answer);\n        await newPeerConnection.setLocalDescription(answer);\n\n        const roomWithAnswer = {\n        answer: {\n            type: answer.type,\n            sdp: answer.sdp,\n        },\n        };\n        await setDoc(roomRef, roomWithAnswer, { merge: true });\n\n        // Listening for remote ICE candidates\n        const callerCandidatesCollection = collection(db, 'rooms', roomId, 'callerCandidates');\n        onSnapshot(callerCandidatesCollection, snapshot => {\n        snapshot.docChanges().forEach(async change => {\n            if (change.type === 'added') {\n            let data = change.doc.data();\n            console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n            if (newPeerConnection.signalingState !== 'closed') {\n                await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n            }\n            }\n        });\n        });\n\n        // Hide the join room button\n        setShowJoinButton(false);\n    } else {\n        console.log('Room not found');\n        setIsJoiningRoom(false);\n    }\n    } else {\n    console.error('Invalid room ID');\n    }\n    setInCall(true);\n    setIsVideoEnabled(true);\n    setIsCalleeJoined(true);\n};\n\n\n\n\nconst hangUp = async () => {\n    if (localStream) {\n      const tracks = localStream.getTracks();\n      tracks.forEach((track) => {\n        track.stop();\n      });\n    }\n  \n    if (remoteStream) {\n      remoteStream.getTracks().forEach((track) => track.stop());\n    }\n  \n    // Delete room on hangup\n    if (roomId) {\n      const calleeCandidates = await getDocs(\n        collection(db, \"rooms\", roomId, \"calleeCandidates\")\n      );\n      calleeCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const callerCandidates = await getDocs(\n        collection(db, \"rooms\", roomId, \"callerCandidates\")\n      );\n      callerCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const roomRef = doc(collection(db, \"rooms\"), roomId);\n      await deleteDoc(roomRef);\n  \n      // Delete videoCallStatus document\n      const videoCallStatusDocRef = doc(db, \"videoCallStatus\", roomId);\n      await deleteDoc(videoCallStatusDocRef);\n    }\n  \n    if (peerConnection) {\n      peerConnection.close();\n    }\n  \n    if (localVideoRef.current) {\n        localVideoRef.current.srcObject = null;\n        const profilePictureURL = currentUser?.photoURL || \"default-profile-picture.png\";\n        localVideoRef.current.poster = profilePictureURL;\n      }\n    \n      if (remoteVideoRef.current) {\n        remoteVideoRef.current.srcObject = null;\n      }\n    \n  \n    if (remoteVideoRef.current) {\n      remoteVideoRef.current.srcObject = null;\n    }\n  \n    // Remove the listeners\n    if (calleeCandidatesUnsubscribe) {\n      calleeCandidatesUnsubscribe();\n    }\n  \n    if (callerCandidatesUnsubscribe) {\n      callerCandidatesUnsubscribe();\n    }\n  \n    setIsCreatingRoom(false);\n    setIsJoiningRoom(false);\n    setRoomId(null);\n    setRoomIdToJoin(\"\");\n    setIsVideoEnabled(false);\n  };\n  \n  const handleHangUp = () => {\n    hangUp();\n    onClose();\n  };\n  \n\n\nconst registerPeerConnectionListeners = (pc) => {\n    pc.addEventListener('icegatheringstatechange', () => {\n    console.log(`ICE gathering state changed: ${pc.iceGatheringState}`);\n    });\n\n    pc.addEventListener('connectionstatechange', () => {\n    console.log(`Connection state change: ${pc.connectionState}`);\n    });\n\n    pc.addEventListener('signalingstatechange', () => {\n    console.log(`Signaling state change: ${pc.signalingState}`);\n    });\n\n    pc.addEventListener('iceconnectionstatechange ', () => {\n    console.log(`ICE connection state change: ${pc.iceConnectionState}`);\n    });\n};\n\nconst handleMuteAudio = () => {\n    if (localStream) {\n    localStream.getAudioTracks()[0].enabled = !localStream.getAudioTracks()[0].enabled;\n    setIsAudioEnabled(!isAudioEnabled);\n    }\n};\n\nconst handleStopVideo = async () => {\n  if (localStream) {\n    const videoTrack = localStream.getVideoTracks()[0];\n    videoTrack.enabled = !videoTrack.enabled;\n    setIsVideoEnabled(!isVideoEnabled);\n\n    // Create a reference to the user status document\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    // Get the current data for the document\n    const docSnap = await getDoc(userStatusDocRef);\n\n    if (docSnap.exists()) {\n      // Update the isEnabled field for the current user\n      await updateDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n      }, { merge: true });\n    } else {\n      // If the document doesn't exist, create it with the correct fields for both users\n      await setDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      });\n    }\n\n    // Toggle between the local video stream and the user's profile picture\n    const localVideoElement = localVideoRef.current;\n    if (videoTrack.enabled) {\n      localVideoElement.srcObject = localStream;\n    } else {\n      localVideoElement.srcObject = null;\n    }\n  }\n};\n\nuseEffect(() => {\n  if (roomId && otherUserUID) {\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    const unsubscribe = onSnapshot(userStatusDocRef, (docSnapshot) => {\n      if (docSnapshot.exists()) {\n        const otherUserStatus = docSnapshot.data()[otherUserUID];\n        if (otherUserStatus && otherUserStatus.isEnabled && remoteStream.getTracks().length > 0) {\n          setIsCalleeJoined(true);\n        } else {\n          setIsCalleeJoined(false);\n        }\n      } else {\n        setIsCalleeJoined(false);\n      }\n    }, (error) => {\n      console.log('Error listening to user status document:', error);\n    });\n\n    return () => unsubscribe();\n  }\n}, [roomId, otherUserUID, remoteStream]);\n  \n\n  \n  \n\nconst isMobile = window.innerWidth <= 768;\n\nconst handleCloseVideoCallApp = () => {\n  onClose();\n};\n\n\nreturn (\n    <div className='video-chat' >\n\n\n\n    <div className=\"video-chat-header d-none-mobile\">\n\n    <h2 className=\"fw-bold lead mb-3\" style={{ fontSize: '2rem' }}>{userData.displayName}</h2>\n        <div className=\"video-go-back-svg\">\n        <button onClick={onClose}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5}  stroke=\"currentColor\" className=\"w-6 h-6\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n        </svg>\n        </button>\n    </div>\n    </div>\n    <div className=\"video-chat-container\">\n        <div className={`chat-container-call ${showChat ? 'show' : ''}`}>\n          {showChat && (\n            <ChatContainerCalls\n              currentUserUID={currentUserUID}\n              otherUserUID={otherUserUID}\n            />\n          )}\n        </div>\n\n<div className=\"video-row\">\n\n\n\n{isMobile && (\n       <div className=\"mobile-go-back-svg\">\n       <svg onClick={handleCloseVideoCallApp} xmlns=\"http://www.w3.org/2000/svg\" color= '#212529'  fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={3} stroke=\"white\" height=\"45\" width=\"25\" style={{ margin: '5px' }}>\n         <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 19.5 8.25 12l7.5-7.5\" />\n       </svg>\n     </div>\n    )}  \n<video\nclassName=\"local-video\"\nref={localVideoRef}\nautoPlay\nplaysInline\nmuted\nstyle={{ display: isVideoEnabled ? 'block' : 'none' }}\n/>\n{!isVideoEnabled &&  !isMobile &&(\n<div className=\"profile-picture-container\">\n  <img\n    className=\"profile-picture\"\n    src={currentUser?.photoURL || \"default-profile-picture.png\"}\n    alt=\"Profile Picture\"\n  />\n</div>\n)}\n<video\n  className=\"remote-video\"\n  ref={remoteVideoRef}\n  autoPlay\n  playsInline\n  style={{ display: isCalleeJoined ? 'block' : 'none' }}\n/>\n{!isCalleeJoined && (\n  <>\n   \n    <div className=\"profile-picture-container\">\n    {isMobile && (\n      <p style={{ textAlign: 'center' }}>{userData?.displayName}</p>\n    )}\n      <img\n        className=\"profile-picture\"\n        src={userData.photoURL || \"default-profile-picture.png\"}\n        alt=\"Profile Picture\"\n      />\n    </div>\n  </>\n)}\n\n\n\n</div>\n<div className=\"name-row d-none-mobile \">\n<p>{currentUser?.displayName}</p>\n<p>{userData.displayName}</p>\n\n</div>\n\n</div>\n\n{!isMobile && (\n    <div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                  setIsVideoEnabled(true);\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n         <button\n         className=\"join-room-button\"\n         onClick={() => joinRoom(setIsCalleeJoined(true))}\n       >\n              \n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n  <div className=\"settings-button-container\">\n  <button className=\"settings-button\" onClick={() => setShowChat(!showChat)}>\n  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 0 1-.923 1.785A5.969 5.969 0 0 0 6 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337Z\" />\n  </svg>\n</button>\n\n        </div>\n        </div>\n\n    </div>\n        )}\n            {isMobile && (\n    <div className=\"video-chat-footer-mobile\">\n<div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n    \n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n            <button className=\"join-room-button\" onClick={joinRoom}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n            <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n\n        </div>\n\n    </div>\n    </div>\n    )}\n    </div>\n);\n\n};\nexport default VideoChatApp;","import React, { useEffect, useRef, useState } from 'react';\nimport { db, auth } from '../firebase';\nimport { collection, doc, setDoc, getDoc, onSnapshot, getDocs, deleteDoc, updateDoc } from 'firebase/firestore';\nimport ChatContainerCalls from './ChatContainerCall';\n\nconst VideoCallApp = ({ currentUserUID, otherUserUID, onClose, userData }) => {\nconst localVideoRef = useRef(null);\nconst remoteVideoRef = useRef(null);\n\nconst [peerConnection, setPeerConnection] = useState(null);\nconst [localStream, setLocalStream] = useState(null);\nconst [remoteStream, setRemoteStream] = useState(null);\nconst [roomId, setRoomId] = useState(null);\nconst [isCreatingRoom, setIsCreatingRoom] = useState(false);\nconst [isJoiningRoom, setIsJoiningRoom] = useState(false);\nconst [roomIdToJoin, setRoomIdToJoin] = useState('');\n\nconst [roomName, setRoomName] = useState('');\nconst [roomExists, setRoomExists] = useState(false);\nconst [showJoinButton, setShowJoinButton] = useState(false);\nconst [callToJoin, setCallToJoin] = useState(false);\nconst [isVideoEnabled, setIsVideoEnabled] = useState(false);\nconst [isAudioEnabled, setIsAudioEnabled] = useState(true);\nconst [inCall, setInCall] = useState(false);\nconst [currentUser, setCurrentUser] = useState(null);\nconst [isCalleeJoined, setIsCalleeJoined] = useState(false);\nconst [isRemoteVideoAvailable, setIsRemoteVideoAvailable] = useState(false);\n\nconst [showChat, setShowChat] = useState(false);\n\n\n\n\n\n\n\nlet calleeCandidatesUnsubscribe = null;\nlet callerCandidatesUnsubscribe = null;\n\nconst configuration = {\n  iceServers: [\n    {\n      urls: [\n        'stun:stun.l.google.com:19302',\n        'stun:stun1.l.google.com:19302',\n        'stun:stun2.l.google.com:19302',\n        'stun:stun3.l.google.com:19302',\n        'stun:stun4.l.google.com:19302',\n      ]\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:80?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turn:standard.relay.metered.ca:443\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n    {\n      urls: \"turns:standard.relay.metered.ca:443?transport=tcp\",\n      username: \"9f24237eef08d63be9f50c85\",\n      credential: \"bcSTypx8qHWJ7hH9\",\n    },\n  ],\n  iceCandidatePoolSize: 10,\n};\nuseEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n    if (user) {\n        setCurrentUser(user); // Set the current user when authenticated\n    } else {\n        setCurrentUser(null); // Reset the current user if not authenticated\n    }\n    });\n\n    return () => unsubscribe(); // Unsubscribe from the auth state listener\n}, []);\n\nuseEffect(() => {\n    const openUserMedia = async () => {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true,\n      });\n      localVideoRef.current.srcObject = stream;\n      setLocalStream(stream);\n      setRemoteStream(new MediaStream());\n      remoteVideoRef.current.srcObject = remoteStream;\n  \n      console.log(\"Stream:\", localVideoRef.current.srcObject);\n      setIsVideoEnabled(false); // Add this line\n    };\n  \n    openUserMedia();\n  \n    // Clean up function\n    return () => {\n      hangUp();\n    };\n  }, [currentUserUID, otherUserUID]);\n  \n  \n\n\n\nuseEffect(() => {\n    const checkRoomExists = async () => {\n    const roomRef = doc(collection(db, 'calls'), roomIdToJoin);\n    const roomSnapshot = await getDoc(roomRef);\n    setRoomExists(roomSnapshot.exists());\n    };\n\n    if (roomIdToJoin) {\n    checkRoomExists();\n    }\n}, [roomIdToJoin]);\n\nuseEffect(() => {\n    // Listen for room creation on the callee side\n    const roomsCollection = collection(db, 'calls');\n    const unsubscribe = onSnapshot(roomsCollection, (snapshot) => {\n    snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n        const roomData = change.doc.data();\n        const roomId = change.doc.id;\n        const swappedRoomId = `${currentUserUID}_${otherUserUID}`;\n        if (roomId === swappedRoomId) {\n            setShowJoinButton(true);\n            setRoomId(roomId);\n            setCallToJoin(true);\n        }\n        }\n    });\n    });\n\n    // Clean up the listener on component unmount\n    return () => unsubscribe();\n}, [currentUserUID, otherUserUID]);\n\nconst createRoom = async () => {\n    // Set the room ID to otherUserUID_currentUserUID\n    const roomId = `${otherUserUID}_${currentUserUID}`;\n  \n    setIsCreatingRoom(true);\n    const roomRef = doc(collection(db, 'calls'), roomId);\n  \n    const newPeerConnection = new RTCPeerConnection(configuration);\n    setPeerConnection(newPeerConnection);\n  \n    registerPeerConnectionListeners(newPeerConnection);\n  \n    localStream.getTracks().forEach(track => {\n      newPeerConnection.addTrack(track, localStream);\n    });\n  \n    // Create a reference to the videoCallStatus document\n    const videoCallStatusDocRef = doc(db, 'videoCallStatus', roomId);\n  \n    // First, get the document\n    const docSnap = await getDoc(videoCallStatusDocRef);\n  \n    if (!docSnap.exists()) {\n      // If the document doesn't exist, create it\n      await setDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: false,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      });\n    } else {\n      // If the document exists, update it\n      await updateDoc(videoCallStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: false,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      }, { merge: true });\n    }\n  \n    // Code for collecting ICE candidates\n    const callerCandidatesCollection = collection(db, 'calls', roomRef.id, 'callerCandidates');\n  \n    newPeerConnection.addEventListener('icecandidate', event => {\n      if (!event.candidate) {\n        console.log('Got final candidate!');\n        return;\n      }\n      console.log('Got candidate: ', event.candidate);\n      if (newPeerConnection.signalingState !== 'closed') {\n        setDoc(doc(callerCandidatesCollection), event.candidate.toJSON());\n      }\n    });\n  \n    // Code for creating a room\n    const offer = await newPeerConnection.createOffer();\n    await newPeerConnection.setLocalDescription(offer);\n    console.log('Created offer:', offer);\n  \n    const roomWithOffer = {\n      'offer': {\n        type: offer.type,\n        sdp: offer.sdp,\n      },\n      'name': roomName, // Add the room name to the room data\n    };\n    await setDoc(roomRef, roomWithOffer);\n    setRoomId(roomRef.id);\n    console.log(`New room created with SDP offer. Room ID: ${roomRef.id}`);\n  \n    // Set remote stream as the srcObject of the remote video element\n    remoteVideoRef.current.srcObject = remoteStream;\n  \n    newPeerConnection.addEventListener('track', event => {\n      console.log('Got remote track:', event.streams[0]);\n      event.streams[0].getTracks().forEach(track => {\n        console.log('Add a track to the remoteStream:', track);\n        remoteStream.addTrack(track);\n      });\n    });\n  \n    // Listening for remote session description\n    onSnapshot(roomRef, async snapshot => {\n      const data = snapshot.data();\n      if (!newPeerConnection.currentRemoteDescription && data && data.answer) {\n        console.log('Got remote description: ', data.answer);\n        const rtcSessionDescription = new RTCSessionDescription(data.answer);\n        await newPeerConnection.setRemoteDescription(rtcSessionDescription);\n      }\n    });\n  \n    // Listen for remote ICE candidates\n    calleeCandidatesUnsubscribe = onSnapshot(collection(db, 'calls', roomRef.id, 'calleeCandidates'), snapshot => {\n      snapshot.docChanges().forEach(async change => {\n        if (change.type === 'added') {\n    \n        \n          let data = change.doc.data();\n          console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n          if (newPeerConnection.signalingState !== 'closed') {\n            await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n          }\n        }\n      });\n    });\n    setInCall(true);\n    localStream.getVideoTracks()[0].enabled = false;\n    setIsVideoEnabled(false);\n  };\n  \n\nconst joinRoom = async () => {\n    // Set the room ID to currentUserUID_otherUserUID\n    const roomId = `${currentUserUID}_${otherUserUID}`;\n\n    if (roomId) {\n    setIsJoiningRoom(true);\n    const roomRef = doc(collection(db, 'calls'), roomId);\n    const roomSnapshot = await getDoc(roomRef);\n\n    if (roomSnapshot.exists()) {\n        console.log('Got room:', roomSnapshot.data());\n        console.log('Create PeerConnection with configuration: ', configuration);\n        const newPeerConnection = new RTCPeerConnection(configuration);\n        setPeerConnection(newPeerConnection);\n        registerPeerConnectionListeners(newPeerConnection);\n        localStream.getTracks().forEach(track => {\n        newPeerConnection.addTrack(track, localStream);\n        });\n\n        // Code for collecting ICE candidates\n        const calleeCandidatesCollection = collection(db, 'calls', roomId, 'calleeCandidates');\n        newPeerConnection.addEventListener('icecandidate', event => {\n        if (!event.candidate) {\n            console.log('Got final candidate!');\n            return;\n        }\n        console.log('Got candidate: ', event.candidate);\n        setDoc(doc(calleeCandidatesCollection), event.candidate.toJSON());\n        });\n\n        // Set remote stream as the srcObject of the remote video element\n        remoteVideoRef.current.srcObject = remoteStream;\n\n        newPeerConnection.addEventListener('track', event => {\n        console.log('Got remote track:', event.streams[0]);\n        event.streams[0].getTracks().forEach(track => {\n            console.log('Add a track to the remoteStream:', track);\n            remoteStream.addTrack(track);\n        });\n        });\n\n        // Code for creating SDP answer\n        const offer = roomSnapshot.data().offer;\n        console.log('Got offer:', offer);\n        await newPeerConnection.setRemoteDescription(new RTCSessionDescription(offer));\n        const answer = await newPeerConnection.createAnswer();\n        console.log('Created answer:', answer);\n        await newPeerConnection.setLocalDescription(answer);\n\n        const roomWithAnswer = {\n        answer: {\n            type: answer.type,\n            sdp: answer.sdp,\n        },\n        };\n        await setDoc(roomRef, roomWithAnswer, { merge: true });\n\n        // Listening for remote ICE candidates\n        const callerCandidatesCollection = collection(db, 'calls', roomId, 'callerCandidates');\n        onSnapshot(callerCandidatesCollection, snapshot => {\n        snapshot.docChanges().forEach(async change => {\n            if (change.type === 'added') {\n            let data = change.doc.data();\n            console.log(`Got new remote ICE candidate: ${JSON.stringify(data)}`);\n            if (newPeerConnection.signalingState !== 'closed') {\n                await newPeerConnection.addIceCandidate(new RTCIceCandidate(data));\n            }\n            }\n        });\n        });\n\n        // Hide the join room button\n        setShowJoinButton(false);\n    } else {\n        console.log('Room not found');\n        setIsJoiningRoom(false);\n    }\n    } else {\n    console.error('Invalid room ID');\n    }\n    setInCall(true);\n    setIsCalleeJoined(false);\n    localStream.getVideoTracks()[0].enabled = false;\n    setIsVideoEnabled(false);\n};\n\n\n\n\nconst hangUp = async () => {\n    if (localStream) {\n      const tracks = localStream.getTracks();\n      tracks.forEach((track) => {\n        track.stop();\n      });\n    }\n  \n    if (remoteStream) {\n      remoteStream.getTracks().forEach((track) => track.stop());\n    }\n  \n    // Delete room on hangup\n    if (roomId) {\n      const calleeCandidates = await getDocs(\n        collection(db, 'calls', roomId, \"calleeCandidates\")\n      );\n      calleeCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const callerCandidates = await getDocs(\n        collection(db, 'calls', roomId, \"callerCandidates\")\n      );\n      callerCandidates.forEach(async (candidate) => {\n        await deleteDoc(candidate.ref);\n      });\n  \n      const roomRef = doc(collection(db, 'calls'), roomId);\n      await deleteDoc(roomRef);\n  \n      // Delete videoCallStatus document\n      const videoCallStatusDocRef = doc(db, \"videoCallStatus\", roomId);\n      await deleteDoc(videoCallStatusDocRef);\n    }\n  \n    if (peerConnection) {\n      peerConnection.close();\n    }\n  \n    if (localVideoRef.current) {\n        localVideoRef.current.srcObject = null;\n        const profilePictureURL = currentUser?.photoURL || \"default-profile-picture.png\";\n        localVideoRef.current.poster = profilePictureURL;\n      }\n    \n      if (remoteVideoRef.current) {\n        remoteVideoRef.current.srcObject = null;\n      }\n    \n  \n    if (remoteVideoRef.current) {\n      remoteVideoRef.current.srcObject = null;\n    }\n  \n    // Remove the listeners\n    if (calleeCandidatesUnsubscribe) {\n      calleeCandidatesUnsubscribe();\n    }\n  \n    if (callerCandidatesUnsubscribe) {\n      callerCandidatesUnsubscribe();\n    }\n  \n    setIsCreatingRoom(false);\n    setIsJoiningRoom(false);\n    setRoomId(null);\n    setRoomIdToJoin(\"\");\n    setIsVideoEnabled(false);\n  };\n  \n  \n\n\nconst registerPeerConnectionListeners = (pc) => {\n    pc.addEventListener('icegatheringstatechange', () => {\n    console.log(`ICE gathering state changed: ${pc.iceGatheringState}`);\n    });\n\n    pc.addEventListener('connectionstatechange', () => {\n    console.log(`Connection state change: ${pc.connectionState}`);\n    });\n\n    pc.addEventListener('signalingstatechange', () => {\n    console.log(`Signaling state change: ${pc.signalingState}`);\n    });\n\n    pc.addEventListener('iceconnectionstatechange ', () => {\n    console.log(`ICE connection state change: ${pc.iceConnectionState}`);\n    });\n};\n\nconst handleMuteAudio = () => {\n    if (localStream) {\n    localStream.getAudioTracks()[0].enabled = !localStream.getAudioTracks()[0].enabled;\n    setIsAudioEnabled(!isAudioEnabled);\n    }\n};\n\nconst handleStopVideo = async () => {\n  if (localStream) {\n    const videoTrack = localStream.getVideoTracks()[0];\n    videoTrack.enabled = !videoTrack.enabled;\n    setIsVideoEnabled(!isVideoEnabled);\n\n    // Create a reference to the user status document\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    // Get the current data for the document\n    const docSnap = await getDoc(userStatusDocRef);\n\n    if (docSnap.exists()) {\n      // Update the isEnabled field for the current user\n      await updateDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n      }, { merge: true });\n    } else {\n      // If the document doesn't exist, create it with the correct fields for both users\n      await setDoc(userStatusDocRef, {\n        [currentUserUID]: {\n          isEnabled: videoTrack.enabled,\n        },\n        [otherUserUID]: {\n          isEnabled: false,\n        },\n      });\n    }\n\n    // Toggle between the local video stream and the user's profile picture\n    const localVideoElement = localVideoRef.current;\n    if (videoTrack.enabled) {\n      localVideoElement.srcObject = localStream;\n    } else {\n      localVideoElement.srcObject = null;\n    }\n  }\n};\n\nuseEffect(() => {\n  if (roomId && otherUserUID) {\n    const userStatusDocRef = doc(db, 'videoCallStatus', roomId);\n\n    const unsubscribe = onSnapshot(userStatusDocRef, (docSnapshot) => {\n      if (docSnapshot.exists()) {\n        const otherUserStatus = docSnapshot.data()[otherUserUID];\n        if (otherUserStatus && otherUserStatus.isEnabled && remoteStream.getTracks().length > 0) {\n          setIsCalleeJoined(true);\n        } else {\n          setIsCalleeJoined(false);\n        }\n      } else {\n        setIsCalleeJoined(false);\n      }\n    }, (error) => {\n      console.log('Error listening to user status document:', error);\n    });\n\n    return () => unsubscribe();\n  }\n}, [roomId, otherUserUID, remoteStream]);\n\nconst isMobile = window.innerWidth <= 768;\n\nconst handleHangUp = () => {\n  hangUp();\n  onClose();\n};\n\nconst handleCloseVideoCallApp = () => {\n  onClose();\n};\n\n\n\nreturn (\n  <div className='video-chat' >\n\n    <div className=\"video-chat-header d-none-mobile\">\n\n    <h2 className=\"fw-bold lead mb-3\" style={{ fontSize: '2rem' }}>{userData.displayName}</h2>\n        <div className=\"video-go-back-svg\">\n        <button onClick={onClose}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5}  stroke=\"currentColor\" className=\"w-6 h-6\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n        </svg>\n        </button>\n    </div>\n    </div>\n    <div className=\"video-chat-container\">\n        <div className={`chat-container-call ${showChat ? 'show' : ''}`}>\n          {showChat && (\n            <ChatContainerCalls\n              currentUserUID={currentUserUID}\n              otherUserUID={otherUserUID}\n            />\n          )}\n        </div>\n\n<div className=\"video-row\">\n{isMobile && (\n       <div className=\"mobile-go-back-svg\">\n       <svg onClick={handleCloseVideoCallApp} xmlns=\"http://www.w3.org/2000/svg\" color= '#212529'  fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={3} stroke=\"white\" height=\"45\" width=\"25\" style={{ margin: '5px' }}>\n         <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 19.5 8.25 12l7.5-7.5\" />\n       </svg>\n     </div>\n     \n    )}  \n<video\nclassName=\"local-video\"\nref={localVideoRef}\nmuted\nautoPlay\nplaysInline\nstyle={{ display: isVideoEnabled ? 'block' : 'none' }}\n/>\n{!isVideoEnabled && !isMobile &&(\n<div className=\"profile-picture-container \">\n  <img\n    className=\"profile-picture\"\n    src={currentUser?.photoURL || \"default-profile-picture.png\"}\n    alt=\"Profile Picture\"\n  />\n</div>\n)}\n<video\n  className=\"remote-video\"\n  ref={remoteVideoRef}\n  autoPlay\n  playsInline\n  style={{ display: isCalleeJoined ? 'block' : 'none' }}\n/>\n{!isCalleeJoined && (\n  <>\n   \n    <div className=\"profile-picture-container \">\n    {isMobile && (\n      <p style={{ textAlign: 'center' }}>{userData?.displayName}</p>\n    )}\n      <img\n        className=\"profile-picture\"\n        src={userData.photoURL || \"default-profile-picture.png\"}\n        alt=\"Profile Picture\"\n      />\n    </div>\n  </>\n)}\n\n\n\n\n</div>\n<div className=\"name-row d-none-mobile \">\n<p>{currentUser?.displayName}</p>\n<p>{userData.displayName}</p>\n\n</div>\n</div>\n{!isMobile && (\n    <div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n         <button\n         className=\"join-room-button\"\n         onClick={() => joinRoom()}\n       >\n              \n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n  <div className=\"settings-button-container\">\n  <button className=\"settings-button\" onClick={() => setShowChat(!showChat)}>\n  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"white\">\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 0 1-.923 1.785A5.969 5.969 0 0 0 6 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337Z\" />\n  </svg>\n</button>\n\n        </div>\n        </div>\n\n    </div>\n        )}\n            {isMobile && (\n    <div className=\"video-chat-footer-mobile\">\n<div className=\"video-chat-footer\">\n        <div className=\"video-input-container\">\n        <button className=\"settings-button \" onClick={handleStopVideo}>\n            {isVideoEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/>\n            </svg>\n            )}\n        </button>\n    \n        {!inCall && !callToJoin && !roomId && (\n            <button\n            className=\"create-room-button\"\n            onClick={() => {\n                if (localStream) {\n                createRoom();\n                }\n            }}\n            >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n            <path d=\"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z\"/>\n            </svg>\n            </button>\n        )}\n\n        {!inCall && showJoinButton && (\n            <button className=\"join-room-button\" onClick={joinRoom}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M23.71 16.67C20.66 13.78 16.54 12 12 12 7.46 12 3.34 13.78.29 16.67c-.18.18-.29.43-.29.71 0 .28.11.53.29.71l2.48 2.48c.18.18.43.29.71.29.27 0 .52-.11.7-.28.79-.74 1.69-1.36 2.66-1.85.33-.16.56-.5.56-.9v-3.1c1.45-.48 3-.73 4.6-.73s3.15.25 4.6.72v3.1c0 .39.23.74.56.9.98.49 1.87 1.12 2.66 1.85.18.18.43.28.7.28.28 0 .53-.11.71-.29l2.48-2.48c.18-.18.29-.43.29-.71 0-.27-.11-.52-.29-.7zM21.16 6.26l-1.41-1.41-3.56 3.55 1.41 1.41s3.45-3.52 3.56-3.55zM13 2h-2v5h2V2zM6.4 9.81L7.81 8.4 4.26 4.84 2.84 6.26c.11.03 3.56 3.55 3.56 3.55z\"/>\n            </svg>\n            </button>\n        )}\n\n        {inCall && peerConnection && (\n            <button className=\"hang-up-button\" onClick={handleHangUp}>\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.74-1.69-1.36-2.67-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z\"/>\n            </svg>\n            </button>\n        )}\n            <button className=\"settings-button\" onClick={handleMuteAudio}>\n            {isAudioEnabled ? (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/>\n            </svg>\n            ) : (\n            <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"32px\" viewBox=\"0 0 24 24\" width=\"32px\" fill=\"white\">\n                <path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\n            </svg>\n            )}\n        </button>\n\n        </div>\n\n    </div>\n    </div>\n    )}\n    </div>\n);\n\n};\nexport default VideoCallApp;","import React, { useState, useEffect } from 'react';\nimport { db, auth } from '../firebase'; // Import your Firebase instance\nimport { collection, doc, getDoc, setDoc, where, query, onSnapshot } from 'firebase/firestore';\nimport ChatServiceconversation from './ChatServiceconversation';\nimport VideoChatApp from './VideoChatApp'; \nimport VideoCallApp from './VideoCallApp';\n\n\nconst ChatHeader = ({ toggleColumns, otherUserUID, currentUserUID }) => {\n  const [userData, setUserData] = useState({\n    isMobile: false,\n    photoURL: null,\n    displayName: '',\n    occupation: '',\n    isShareChatOpen: false,\n    selectedSession: null,\n    selectedMessageUID: null,\n  });\n\n  const [showVideoCall, setShowVideoCall] = useState(false);\n  const [incomingCall, setIncomingCall] = useState(null);\n\n  const [showCall, setShowCall] = useState(false);\n  const [incomingPhoneCall, setIncomingPhoneCall] = useState(null);\n\n  const [showVideoCallAnimation, setShowVideoCallAnimation] = useState(false);\n  const [showCallAnimation, setShowCallAnimation] = useState(false);\n\n\n  const toggleVideoCall = () => {\n    const videoWrapper = document.querySelector('.video-chat-wrapper');\n  \n    if (showVideoCall) {\n      videoWrapper.classList.remove('open');\n      videoWrapper.classList.add('close');\n      setTimeout(() => {\n        setShowVideoCall(false);\n        videoWrapper.classList.remove('close');\n      }, 500);\n    } else {\n      setShowVideoCallAnimation(true);\n      setTimeout(() => {\n        videoWrapper.classList.add('open');\n        setShowVideoCall(true);\n      }, 100);\n    }\n  };\n  \n  const handleVideoChatClose = () => {\n    toggleVideoCall();\n  };\n\n  const toggleCall = () => {\n    const videoCAllWrapper = document.querySelector('.video-call-wrapper');\n  \n    if (showCall) {\n      videoCAllWrapper.classList.remove('open');\n      videoCAllWrapper.classList.add('close');\n      setTimeout(() => {\n        setShowCall(false);\n        videoCAllWrapper.classList.remove('close');\n      }, 500);\n    } else {\n      setShowCallAnimation(true);\n      setTimeout(() => {\n        videoCAllWrapper.classList.add('open');\n        setShowCall(true);\n      }, 100);\n    }\n  };\n  \n  const handleVideoCallClose = () => {\n    toggleCall();\n  };\n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      const roomId = `${currentUserUID}_${otherUserUID}`;\n    const roomRef = doc(collection(db, 'rooms'), roomId);\n    \n    const unsubscribe = onSnapshot(roomRef, (snapshot) => {\n    if (snapshot.exists()) {\n    setIncomingCall({\n    roomId: snapshot.id,\n    offer: snapshot.data().offer,\n    });\n    } else {\n    setIncomingCall(null);\n    }\n    });\n    \n    return () => unsubscribe();\n    }\n    }, [currentUserUID, otherUserUID]);\n\n    useEffect(() => {\n      if (currentUserUID && otherUserUID) {\n        const roomId = `${currentUserUID}_${otherUserUID}`;\n      const roomRef = doc(collection(db, 'calls'), roomId);\n      \n      const unsubscribe = onSnapshot(roomRef, (snapshot) => {\n      if (snapshot.exists()) {\n        setIncomingPhoneCall({\n      roomId: snapshot.id,\n      offer: snapshot.data().offer,\n      });\n      } else {\n        setIncomingPhoneCall(null);\n      }\n      });\n      \n      return () => unsubscribe();\n      }\n      }, [currentUserUID, otherUserUID]);\n    \n  \n\n\n    useEffect(() => {\n      const mediaQuery = window.matchMedia('(max-width: 768px)');\n      setUserData((prevUserData) => ({ ...prevUserData, isMobile: mediaQuery.matches }));\n  \n      const handleResize = () => {\n        setUserData((prevUserData) => ({ ...prevUserData, isMobile: mediaQuery.matches }));\n      };\n  \n      mediaQuery.addListener(handleResize);\n  \n      return () => {\n        mediaQuery.removeListener(handleResize);\n      };\n    }, []);\n  \n    const fetchUserData = async (userTypeRef) => {\n      try {\n        const userDocSnap = await getDoc(doc(userTypeRef, otherUserUID));\n  \n        if (userDocSnap.exists()) {\n          const userData = userDocSnap.data();\n          if (userData) {\n            setUserData((prevUserData) => ({\n              ...prevUserData,\n              photoURL: userData.photoURL,\n              displayName: userData.displayName ?? '',\n              occupation: userData.occupation ?? '',\n            }));\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching user data:', error);\n      }\n    };\n  \n    useEffect(() => {\n      const fetchData = async () => {\n        try {\n          if (otherUserUID) {\n            const firestore = db;\n            const expertAppsRef = collection(firestore, 'expertApplications');\n            const expertDocSnap = await getDoc(doc(expertAppsRef, otherUserUID));\n  \n            if (expertDocSnap.exists()) {\n              fetchUserData(expertAppsRef);\n            } else {\n              const userProfilesRef = collection(firestore, 'userProfiles');\n              fetchUserData(userProfilesRef);\n            }\n          }\n        } catch (error) {\n          console.error('Error fetching user data:', error);\n        }\n      };\n  \n      fetchData();\n    }, [otherUserUID]);\n  \n    useEffect(() => {\n      const fetchSessionAndUpdate = async () => {\n        try {\n          if (otherUserUID && currentUserUID) {\n            const firestore = db;\n            const conversationsCollectionRef = collection(firestore, 'sharedConversations');\n            let discussionID;\n  \n            const expertAppsRef = collection(firestore, 'expertApplications');\n            const expertDocSnap = await getDoc(doc(expertAppsRef, currentUserUID));\n  \n            if (expertDocSnap.exists()) {\n              discussionID = `${otherUserUID}_${currentUserUID}`;\n            } else {\n              discussionID = `${currentUserUID}_${otherUserUID}`;\n            }\n  \n            const conversationRef = doc(conversationsCollectionRef, discussionID);\n            const conversationSnapshot = await getDoc(conversationRef);\n  \n            if (conversationSnapshot.exists()) {\n              const selectedSession = conversationSnapshot.data().selectedSession;\n              setUserData((prevUserData) => ({\n                ...prevUserData,\n                selectedSession: selectedSession,\n              }));\n            } else {\n            }\n          } else {\n            setUserData((prevUserData) => ({\n              ...prevUserData,\n              selectedMessageUID: null,\n              selectedSession: null,\n            }));\n          }\n        } catch (error) {\n          console.error('Error fetching and updating session:', error);\n        }\n      };\n  \n      fetchSessionAndUpdate();\n    }, [otherUserUID, currentUserUID]);\n  \n    const closeShareChat = () => {\n      setUserData((prevUserData) => ({ ...prevUserData, isShareChatOpen: false }));\n    };\n\n    const renderCustomSVG = () => {\n      if (userData.selectedSession) {\n        return (\n          <svg\n          className='render-chat'\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill={'none'}\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n            onClick={() => {\n              setUserData((prevUserData) => ({ ...prevUserData, isShareChatOpen: true }));\n            }}\n          >\n        <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z\"\n        />\n          </svg>\n      );\n    } else {\n      return null;\n    }\n  };\n  \n    const handleImageClick = async () => {\n      try {\n        if (!otherUserUID) {\n          throw new Error('otherUserUID is undefined or null');\n        }\n  \n        const firestore = db;\n        const expertAppsRef = collection(firestore, 'expertApplications');\n        const expertDocSnap = await getDoc(doc(expertAppsRef, otherUserUID));\n  \n        if (expertDocSnap.exists()) {\n          const customURL = expertDocSnap.data().customURL;\n          window.location.href = `https://www.tioassist.io/expert/${customURL}`;\n        } else {\n          const userProfilesRef = collection(firestore, 'userProfiles');\n          const userDocSnap = await getDoc(doc(userProfilesRef, otherUserUID));\n  \n          if (userDocSnap.exists()) {\n            const customURL = userDocSnap.data().customURL;\n            window.location.href = `https://www.tioassist.io/user/${customURL}`;\n          } else {\n          }\n        }\n      } catch (error) {\n        console.error('Error handling image click:', error.message);\n      }\n    };\n  \n    return (\n      <div className=\"chat-header\" >\n        <div className='chat-header-one'>\n        {userData.isMobile && (\n          <svg\n            onClick={toggleColumns}\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n            style={{ marginRight: '8px' }}\n          >\n<path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n          </svg>\n        )}\n  \n        <div className=\"small-avatar-mobile\" onClick={handleImageClick}>\n          <img\n            className=\"small-avatar-mobile \"\n            src={userData.photoURL}\n            alt=\"Custom 404 Image\"\n            role=\"button\"\n          />\n        </div>\n        <div className=\"user-info\">\n          <div>\n            <p className=\"font-weight-bold mb-0\">{userData.displayName}</p>\n            <p className=\"text-sm text-muted\">{userData.occupation}</p>\n          </div>\n        </div>\n        </div>\n        <div className='chat-header-two'>\n        <div className={`svg-wrapper ${incomingPhoneCall ? 'unread-svg-border' : ''}`}    onClick={toggleCall}>\n        <svg    \n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill={'none'}\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            id=\"call\"\n            height=\"25\" width=\"25\" style={{ margin: '5px' }}>\n            \n  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z\" />\n</svg>\n</div>\n<div className={`svg-wrapper ${incomingCall ? 'unread-svg-border' : ''}`}    onClick={toggleVideoCall}>\n<svg    \n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill={'none'}\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\" width=\"25\" style={{ margin: '5px' }}\n            id=\"videocall\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z\" />\n</svg>\n</div>\n{renderCustomSVG()}\n  \n        {userData.isShareChatOpen && (\n          <ChatServiceconversation\n            currentUserUID={currentUserUID}\n            selectedSession={userData.selectedSession}\n            otherUserUID={otherUserUID}\n            closeShareChat={closeShareChat}\n          />\n        )}\n\n        </div>\n        <div\n  className={`video-chat-wrapper ${showVideoCallAnimation ? 'open' : ''}`}\n>\n  {showVideoCall && (\n    <VideoChatApp\n      currentUserUID={currentUserUID}\n      otherUserUID={otherUserUID}\n      onClose={handleVideoChatClose}\n      userData={userData}\n    />\n  )}\n</div>\n\n<div\n  className={`video-call-wrapper ${showCallAnimation ? 'open' : ''}`}\n>\n       {showCall && (\n        <VideoCallApp\n          currentUserUID={currentUserUID}\n          otherUserUID={otherUserUID}\n          onClose={handleVideoCallClose}\n          userData={userData}  \n        />\n      )}\n      </div>\n    </div>\n    );\n  };\n  \n  export default ChatHeader;","import React, { useState, useEffect, useRef } from 'react';\nimport ChatHeader from './Chatheader';\nimport { sendMessage, getMessages, markMessageAsRead } from './ChatService';\nimport { auth, onAuthStateChanged, db } from '../firebase';\nimport { onSnapshot, collection, getDocs } from 'firebase/firestore';\n\n\nconst RightColumn = ({ isRightColumnVisible, toggleColumns, otherUserUID }) => {\n  const [messages, setMessages] = useState([]);\n  const chatBoxRef = useRef(null);\n  const messageInputRef = useRef(null);\n  const [inputValue, setInputValue] = useState('');\n  const [currentUserUID, setCurrentUserUID] = useState(null);\n  const [isChattingWithSelf, setIsChattingWithSelf] = useState(false);\n  const [textareaHeight, setTextareaHeight] = useState('28px');\n  const maxTextareaHeight = 200;\n\n  const [selectedFile, setSelectedFile] = useState(null);\n  const fileInputRef = useRef(null);\n  const [selectedFilePreview, setSelectedFilePreview] = useState(null);\n  const [lastSeenMessageId, setLastSeenMessageId] = useState(null);\n\n  const [initialLoad, setInitialLoad] = useState(true);\n\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      if (user) {\n        setCurrentUserUID(user.uid);\n      } else {\n        setCurrentUserUID(null);\n      }\n    });\n    return () => unsubscribe(); // Clean up the listener\n  }, []);\n\n  useEffect(() => {\n    setIsChattingWithSelf(currentUserUID === otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        // Reverse the messages here and then set them in the state\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n\n        // Scroll to bottom when new messages are fetched\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID);\n  }, [currentUserUID, otherUserUID]);\n  \n\n  const isMobile = window.innerWidth <= 767; // Adjust the width threshold as needed\n\n  const handleFileUpload = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      setSelectedFile(file);\n      if (file.type && file.type.startsWith('image/')) {\n        // It's an image, no need to display anything\n        setSelectedFilePreview(null);\n      } else {\n        // It's not an image, display the SVG icon and file name\n        setSelectedFilePreview({\n          name: file.name,\n          type: 'file',\n        });\n      }\n    }\n  };\n  \n\n  useEffect(() => {\n    if (selectedFile && selectedFile.type && selectedFile.type.startsWith('image/')) {\n      const reader = new FileReader();\n      reader.onload = (event) => {\n        setSelectedFilePreview(event.target.result);\n      };\n      reader.readAsDataURL(selectedFile);\n    } else {\n      setSelectedFilePreview(null);\n    }\n  }, [selectedFile]);\n  \n\n  const handleMessageSend = async () => {\n    try {\n      if (isChattingWithSelf) {\n        console.error(\"Cannot send messages to yourself.\");\n        console.log('currentUserUID:', currentUserUID);\n        console.log('otherUserUID:', otherUserUID);\n        return;\n      }\n  \n      if (inputValue.trim() === '' && !selectedFile) {\n        return;\n      }\n  \n      if (currentUserUID && otherUserUID) {\n        const success = await sendMessage(currentUserUID, otherUserUID, inputValue, selectedFile);\n        if (success) {\n          setInputValue('');\n          setSelectedFile(null);\n          // Clear the image preview in the userui-input\n          setSelectedFilePreview(null);\n  \n          if (!isMobile) {\n            messageInputRef.current.focus();\n          }\n        }\n      } else {\n        console.error('currentUserUID or otherUserUID is undefined');\n      }\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  \n  \n  const scrollToBottom = () => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.scrollTop = chatBoxRef.current.scrollHeight;\n    }\n  };\n  \n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleTextareaResize = () => {\n    const textarea = messageInputRef.current;\n    if (textarea) {\n      const newHeight = Math.min(textarea.scrollHeight, maxTextareaHeight);\n      setTextareaHeight(`${newHeight}px`);\n    }\n  };\n  \n  \n  \n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n  \n\n  const handleInputChange = (e) => {\n    setInputValue(e.target.value);\n    handleTextareaResize();\n  };\n\n  useEffect(() => {\n    handleTextareaResize();\n  }, []);\n\n  useEffect(() => {\n    if (inputValue === '') {\n      setTextareaHeight('28px');\n    }\n  }, [inputValue]);\n\n  const formatTimestamp = (timestamp) => {\n    if (timestamp) {\n      const date = timestamp.toDate();\n      const hours = date.getHours().toString().padStart(2, '0'); // Get hours in 24-hour format\n      const minutes = date.getMinutes().toString().padStart(2, '0'); // Get minutes\n      return `${hours}:${minutes}`; // Format to HH:MM\n    }\n    return ''; // Return an empty string if the timestamp is not available\n  };\n\n  const handleScroll = () => {\n    // Calculate the last seen message based on scroll position\n    if (chatBoxRef.current) {\n      const { scrollTop, scrollHeight, clientHeight } = chatBoxRef.current;\n      const lastVisibleMessageIndex = Math.floor(scrollTop / clientHeight);\n      if (lastVisibleMessageIndex >= 0 && lastVisibleMessageIndex < messages.length) {\n        const lastSeenMessage = messages[lastVisibleMessageIndex];\n        setLastSeenMessageId(lastSeenMessage.id);\n      }\n    }\n  };\n  useEffect(() => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.addEventListener('scroll', handleScroll);\n    }\n    return () => {\n      if (chatBoxRef.current) {\n        chatBoxRef.current.removeEventListener('scroll', handleScroll);\n      }\n    };\n  }, [chatBoxRef, messages]); // Add messages to dependency array\n\n\n\n  \n\n  useEffect(() => {\n    if (currentUserUID && otherUserUID) {\n      getMessages(currentUserUID, otherUserUID, (newMessages) => {\n        const reversedMessages = newMessages.slice(0).reverse();\n        setMessages(reversedMessages);\n        scrollToBottom();\n      });\n    }\n  }, [currentUserUID, otherUserUID]);\n\n  \n\n  useEffect(() => {\n    markMessageAsRead(currentUserUID, otherUserUID, messages, lastSeenMessageId); // Pass lastSeenMessageId\n  }, [messages, currentUserUID, otherUserUID, lastSeenMessageId]);\n\n  useEffect(() => {\n    if (isRightColumnVisible && initialLoad) {\n      setInitialLoad(false);\n    }\n  }, [isRightColumnVisible, initialLoad]);\n\n\n  return (\n    <div className={`chat-right ${isRightColumnVisible && !initialLoad ? 'slide-in' : ''}`}>\n      <ChatHeader toggleColumns={toggleColumns} otherUserUID={otherUserUID} currentUserUID={currentUserUID} />\n      <div className=\"chat-column\">\n        <div className=\"chat-box\" ref={chatBoxRef}>\n    {Array.isArray(messages) && messages.length > 0 ? (\n  messages.map((message, index) =>\n    message.timestamp ? (\n      <div\n        key={index}\n        className={message.sender === currentUserUID ? 'chat-bubble user-sent' : 'chat-bubble'}\n      >\n        <div className=\"message\">\n          {message.file && message.file.type && message.file.type.startsWith('image/') ? (\n            <img\n              src={message.file.url}\n              alt=\"Image\"\n              className=\"rounded-image\"\n            />\n          ) : (\n            message.file && (\n              <div className=\"file-container\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  color=\"#212529\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  strokeWidth={1}\n                  stroke=\"currentColor\"\n                  height=\"25\"\n                  width=\"25\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                  />\n                </svg>\n                <a\n                  href={message.file.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  {message.file.name}\n                </a>\n              </div>\n            )\n          )}\n          {message.text && <p>{message.text}</p>}\n        </div>\n        <div\n          className={`timestamp small-timestamp ${\n            message.sender === currentUserUID ? 'user-sent-timestamp' : 'other-sent-timestamp'\n          }`}\n        >\n          {formatTimestamp(message.timestamp)}\n        </div>\n      </div>\n    ) : null\n  )\n) : (\n  <div>No messages yet.</div>\n)}\n\n\n        </div>\n        <div className=\"chatui-container\">\n    \n            <input\n              type=\"file\"\n              onChange={(e) => handleFileUpload(e)}\n              style={{ display: 'none' }}\n              ref={fileInputRef}\n            />\n            <button className=\"userui-left-button\" onClick={() => fileInputRef.current.click()}>\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                color=\"#212529\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth={1}\n                stroke=\"currentColor\"\n                height=\"25\"\n                width=\"25\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n                />\n              </svg>\n            </button>\n            <button\n              aria-label=\"Send Message\"\n              onClick={handleMessageSend}\n              className=\" userui-right-button \"\n            >\n              <i className=\"fas fa-paper-plane\"></i>\n            </button>\n            <div id=\"messageInputContainer\">\n  {selectedFile && (\n    <div className=\"file-info\">\n      {selectedFile.type.startsWith('image/') && (\n        <div className=\"image-preview-container\">\n          <img\n            src={URL.createObjectURL(new Blob([selectedFile], { type: selectedFile.type }))}\n            alt=\"Image Preview\"\n            style={{ maxWidth: '70%', height: 'auto' }}\n          />\n        </div>\n      )}\n      {!selectedFile.type.startsWith('image/') && (\n        <div className=\"file-details\">\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            color=\"#212529\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            strokeWidth={1}\n            stroke=\"currentColor\"\n            height=\"25\"\n            width=\"25\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              d=\"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13\"\n            />\n          </svg>\n          <span>{selectedFile.name}</span>\n        </div>\n      )}\n<button className=\"remove-button\" onClick={() => setSelectedFile(null)}>X</button>\n    </div>\n  )}\n\n</div>\n\n       \n            <textarea\n  type=\"text\"\n  placeholder=\"Type a message...\"\n  ref={messageInputRef}\n  style={{ height: textareaHeight }}  // <-- Use the style attribute\n  value={inputValue}\n  onChange={handleInputChange}\n  onKeyDown={(e) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleMessageSend();\n    }\n  }}\n  className=\"message-input scroll-col\"\n  autoComplete=\"off\"\n  inputMode=\"text\"\n/>\n\n          </div>\n          \n          </div>\n        </div>\n  \n  );\n};\n\nexport default RightColumn;\n","import React, { useState, useEffect } from 'react';\nimport LeftColumn from './LeftColumn';\nimport MiddleColumn from './MiddleColumn';\nimport RightColumn from './RightColumn';\nimport ChatHistory from './ChatHistory';\nimport Contacts from './Contacts';\nimport Profile from './Profile';\nimport { useLocation } from 'react-router-dom';\n\nconst Chat = () => {\n  const [isActive, setIsActive] = useState(false);\n  const [selectedMenu, setSelectedMenu] = useState('');\n  const [isRightColumnVisible, setIsRightColumnVisible] = useState(true);\n  const [isMiddleColumnVisible, setIsMiddleColumnVisible] = useState(true);\n  const [isLeftColumnVisible, setIsLeftColumnVisible] = useState(true);\n  const [activeButton, setActiveButton] = useState(null);\n\n  const location = useLocation();\n  const { state: locationState } = location;\n  const { currentUserUID, otherUserUID: locationOtherUserUID } = locationState || {};\n\n  const [otherUserUID, setOtherUserUID] = useState(locationOtherUserUID || null);\n\n  const updateOtherUserID = (newOtherUserID, currentUserID) => {\n    setOtherUserUID(newOtherUserID);\n    console.log('Current User ID:', currentUserID); // Log the current user ID\n  };\n\n  useEffect(() => {\n    if (locationState) {\n      // Update otherUserUID if available in the location state\n      setOtherUserUID(locationState.otherUserUID || null);\n      console.log('Other User ID:', locationState.otherUserUID); // Log the other user ID\n    }\n  }, [locationState]);\n\n  \n  // useEffect to set 'Chat History' after component mounts\n  useEffect(() => {\n    setSelectedMenu('Chat History');\n    // Check if the device is a mobile device and hide the right column initially\n    const isMobile = window.matchMedia('(max-width: 768px)').matches;\n    setIsRightColumnVisible(!isMobile);\n  }, []);\n\n  const handleButtonClick = (menu) => {\n    setIsActive(!isActive);\n    setSelectedMenu(menu);\n    setIsLeftColumnVisible(true);\n    setActiveButton(menu);  // Show the left column when a menu is selected\n  };\n\n\n\n  const toggleRightColumnVisibility = () => {\n    setIsRightColumnVisible((prevVisibility) => !prevVisibility);\n    setIsMiddleColumnVisible(false);\n    setIsLeftColumnVisible(false); // Toggle the left column visibility\n  };\n\n  useEffect(() => {\n    const isMobile = window.matchMedia('(max-width: 768px)').matches;\n    if (isMobile && otherUserUID) {\n      setIsLeftColumnVisible(false);\n      setIsMiddleColumnVisible(false);\n      setIsRightColumnVisible(true);\n    }\n  }, [otherUserUID]);\n  \n  const toggleColumns = () => {\n    setIsRightColumnVisible((prevVisibility) => !prevVisibility);\n    setIsMiddleColumnVisible(true); // Show the middle column\n    setIsLeftColumnVisible(true); // Show the left column\n  };\n\n  useEffect(() => {\n    const isMobile = window.matchMedia('(max-width: 768px)').matches;\n\n    if (isMobile) {\n      document.body.style.overflow = 'hidden';\n\n      return () => {\n        document.body.style.overflow = 'auto';\n      };\n    }\n  }, []);\n\n\n\n  return (\n    <div className=\"chatcontainer\">\n      <LeftColumn handleButtonClick={handleButtonClick} isActive={isActive} \n              toggleRightColumnVisibility={toggleRightColumnVisibility}\n              isLeftColumnVisible={isLeftColumnVisible} \n              activeButton={activeButton} // Pass activeButton state\n              setActiveButton={setActiveButton} \n              otherUserUID={otherUserUID} \n              currentUserUID={currentUserUID} \n      />\n      <MiddleColumn\n        isActive={isActive}\n        selectedMenu={selectedMenu}\n        toggleRightColumnVisibility={toggleRightColumnVisibility}\n        isMiddleColumnVisible={isMiddleColumnVisible} \n        activeButton={activeButton} // Pass activeButton state\n        setActiveButton={setActiveButton} \n        currentUserUID={currentUserUID}\n        updateOtherUserID={updateOtherUserID}\n        otherUserUID={otherUserUID}\n      >\n        {selectedMenu === 'Chat History' && <ChatHistory isActive={isActive} selectedMenu={selectedMenu} />}\n        {selectedMenu === 'Contacts' && <Contacts isActive={isActive} selectedMenu={selectedMenu} />}\n        {selectedMenu === 'Profile' && <Profile isActive={isActive} selectedMenu={selectedMenu} />}\n        {/* Add conditions for other menu options here */}\n      </MiddleColumn>\n      {otherUserUID && (\n      <RightColumn\n        isRightColumnVisible={isRightColumnVisible}\n        toggleColumns={toggleColumns}\n        otherUserUID={otherUserUID}\n      />\n    )}\n  </div>\n\n  );\n};\n\nexport default Chat;"],"names":["_ref","handleButtonClick","isLeftColumnVisible","_useState","useState","_useState2","_slicedToArray","activeButton","setActiveButton","_useState3","_useState4","currentUser","setCurrentUser","isMobile","window","innerWidth","useEffect","unsubscribe","auth","onAuthStateChanged","user","handleButtonClickInternal","buttonName","goBack","history","back","_jsx","className","concat","children","_jsxs","photoURL","src","alt","style","maxWidth","onClick","type","xmlns","color","fill","viewBox","strokeWidth","stroke","height","width","strokeLinecap","strokeLinejoin","d","isActive","toggleRightColumnVisibility","updateOtherUserID","otherUserUID","setShowChatHistory","currentUserUID","setCurrentUserUID","_useState5","_useState6","setOtherUserIDs","_useState7","_useState8","chatsWithUserData","setChatsWithUserData","_useState9","_useState10","userProfilesCache","setUserProfilesCache","_useState11","_useState12","setHasNewMessages","_useState13","_useState14","setHasNewChats","_useState15","_useState16","unreadMessages","setUnreadMessages","_useState17","_useState18","callingUserID","setCallingUserID","matchMedia","matches","length","firstChat","firstChatOtherUserID","otherUserID","fetchChatsForCurrentUser","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","authUID","chatsCollection","querySnapshot","chats","_hasNewMessages","_hasNewChats","_unsubscribe","wrap","_context","prev","next","collection","db","getDocs","sent","forEach","doc","_chatID$split","id","split","_chatID$split2","fetchedAuthUID","fetchedOtherUserID","prevUserIDs","_toConsumableArray","push","data","hasNewMessages","some","chat","messages","hasNewChats","onSnapshot","snapshot","docChanges","change","chatID","_chatID$split3","_chatID$split4","prevChats","existingChatIndex","findIndex","updatedChats","filter","abrupt","t0","console","error","stop","_x","apply","arguments","uid","fetchUserProfiles","_ref3","_callee2","firestore","userData","expertAppsRef","expertAppDoc","expertDocSnap","expertData","userProfilesRef","userProfileDoc","docSnap","userProfileData","_context2","getDoc","exists","displayName","prevCache","_objectSpread","_defineProperty","_x2","updateChatsWithUserData","_ref4","_callee4","_context4","Promise","all","map","_ref5","_callee3","_context3","_x3","handleDeleteChat","_ref6","_callee5","event","_context5","stopPropagation","deleteDoc","_x4","_x5","hasUnreadMessages","_ref7","_callee6","messagesCollectionRef","_iterator","_step","_doc","message","_context6","_createForOfIteratorHelper","docs","s","n","done","value","receiver","isRead","e","f","finish","t1","_x6","_x7","fetchUnreadMessages","_ref8","_callee7","_context7","unsubscribeRooms","roomID","roomData","_roomID$split","_roomID$split2","user1","user2","offer","unsubscribeCalls","callID","callData","_callID$split","_callID$split2","display","justifyContent","alignItems","index","_chat$userData","_chat$userData2","process","searchQuery","setSearchQuery","searchResults","setSearchResults","trim","fetchData","collectionName","collectionRef","item","fetchExpertData","fetchProfileData","then","expertsData","profilesData","combinedData","Fuse","keys","includeScore","includeMatches","threshold","search","result","catch","customURL","userDocSnap","_customURL","log","location","href","placeholder","onChange","target","onKeyDown","key","Link","occupation","description","setDescription","city","setCity","expertProfileRef","expertProfileSnapshot","expertProfileData","userProfileRef","userProfileSnapshot","_Fragment","transform","paddingRight","selectedMenu","isMiddleColumnVisible","currentMenu","setCurrentMenu","isVisible","setIsVisible","isChatVisible","setIsChatVisible","timeoutId","setTimeout","clearTimeout","ChatHistory","Contacts","switchToChatHistory","updateActiveButton","Profile","selectedSession","closeShareChat","sharedChatData","setSharedChatData","isLoading","setIsLoading","selectedMessageUID","setSelectedMessageUID","determineSelectedMessageUID","expertAppDocRef","expertAppSnapshot","existsInExpertApplications","determinedMessageUID","fetchSharedChatData","messagesSnapshot","messagesData","path","query","orderBy","_doc$data","prompt","response","LoadingCircle","ReactMarkdown","storage","getStorage","createChatID","sendMessage","messageText","selectedFile","chatDocRef","storageRef","downloadURL","messageObject","_messageObject","_messagesCollectionRef","ref","Date","now","name","uploadBytes","getDownloadURL","text","file","url","sender","timestamp","serverTimestamp","addDoc","getMessages","callback","reversedMessages","sort","a","b","reverse","markMessageAsRead","messageDocRef","updateDoc","_x8","setMessages","chatBoxRef","useRef","messageInputRef","inputValue","setInputValue","isChattingWithSelf","setIsChattingWithSelf","textareaHeight","setTextareaHeight","setSelectedFile","fileInputRef","setSelectedFilePreview","lastSeenMessageId","setLastSeenMessageId","newMessages","slice","scrollToBottom","startsWith","reader","FileReader","onload","readAsDataURL","handleMessageSend","current","focus","scrollTop","scrollHeight","handleTextareaResize","textarea","newHeight","Math","min","formatTimestamp","date","toDate","hours","getHours","toString","padStart","minutes","getMinutes","handleScroll","_chatBoxRef$current","clientHeight","lastVisibleMessageIndex","floor","lastSeenMessage","addEventListener","removeEventListener","Array","isArray","rel","files","handleFileUpload","click","URL","createObjectURL","Blob","preventDefault","autoComplete","inputMode","onClose","localVideoRef","remoteVideoRef","peerConnection","setPeerConnection","localStream","setLocalStream","remoteStream","setRemoteStream","roomId","setRoomId","setIsCreatingRoom","setIsJoiningRoom","roomIdToJoin","setRoomIdToJoin","roomName","setRoomExists","_useState19","_useState20","showJoinButton","setShowJoinButton","_useState21","_useState22","callToJoin","setCallToJoin","_useState23","_useState24","isVideoEnabled","setIsVideoEnabled","_useState25","_useState26","isAudioEnabled","setIsAudioEnabled","_useState27","_useState28","inCall","setInCall","_useState29","_useState30","_useState31","_useState32","isCalleeJoined","setIsCalleeJoined","_useState33","_useState34","_useState35","_useState36","showChat","setShowChat","calleeCandidatesUnsubscribe","configuration","iceServers","urls","username","credential","iceCandidatePoolSize","openUserMedia","stream","navigator","mediaDevices","getUserMedia","video","audio","srcObject","MediaStream","hangUp","checkRoomExists","roomRef","roomSnapshot","roomsCollection","createRoom","newPeerConnection","videoCallStatusDocRef","_setDoc","_updateDoc","callerCandidatesCollection","roomWithOffer","RTCPeerConnection","registerPeerConnectionListeners","getTracks","track","addTrack","setDoc","isEnabled","merge","candidate","signalingState","toJSON","createOffer","setLocalDescription","sdp","streams","rtcSessionDescription","currentRemoteDescription","answer","RTCSessionDescription","setRemoteDescription","JSON","stringify","addIceCandidate","RTCIceCandidate","getVideoTracks","enabled","joinRoom","calleeCandidatesCollection","roomWithAnswer","createAnswer","_ref9","_callee10","profilePictureURL","_context10","_ref10","_callee8","_context8","_ref11","_callee9","_context9","close","poster","handleHangUp","pc","iceGatheringState","connectionState","iceConnectionState","handleMuteAudio","getAudioTracks","handleStopVideo","_ref12","_callee11","videoTrack","userStatusDocRef","_setDoc2","localVideoElement","_context11","docSnapshot","otherUserStatus","fontSize","ChatContainerCalls","margin","autoPlay","playsInline","muted","textAlign","toggleColumns","isShareChatOpen","setUserData","showVideoCall","setShowVideoCall","incomingCall","setIncomingCall","showCall","setShowCall","incomingPhoneCall","setIncomingPhoneCall","showVideoCallAnimation","setShowVideoCallAnimation","showCallAnimation","setShowCallAnimation","toggleVideoCall","videoWrapper","document","querySelector","classList","remove","add","toggleCall","videoCAllWrapper","mediaQuery","prevUserData","handleResize","addListener","removeListener","fetchUserData","userTypeRef","_userData","_userData$displayName","_userData$occupation","fetchSessionAndUpdate","conversationsCollectionRef","discussionID","conversationRef","conversationSnapshot","handleImageClick","Error","marginRight","role","ChatServiceconversation","VideoChatApp","VideoCallApp","isRightColumnVisible","initialLoad","setInitialLoad","ChatHeader","setIsActive","setSelectedMenu","setIsRightColumnVisible","setIsMiddleColumnVisible","setIsLeftColumnVisible","locationState","useLocation","state","locationOtherUserUID","setOtherUserUID","prevVisibility","body","overflow","LeftColumn","menu","MiddleColumn","newOtherUserID","currentUserID","RightColumn"],"sourceRoot":""}