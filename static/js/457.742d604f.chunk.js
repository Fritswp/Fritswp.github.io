"use strict";(self.webpackChunkmy_react=self.webpackChunkmy_react||[]).push([[457],{1457:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var s=n(9439),r=n(2791),a=n(673),i=n(184),c=function(e){var t=e.handleButtonClick,n=(e.isActive,e.isLeftColumnVisible),c=(0,r.useState)(null),o=(0,s.Z)(c,2),l=o[0],u=o[1],d=(0,r.useState)(null),h=(0,s.Z)(d,2),m=h[0],x=h[1];(0,r.useEffect)((function(){var e=a.I8.onAuthStateChanged((function(e){x(e||null)}));return function(){return e()}}),[]);var f=function(e){t(e),u(e)};return(0,i.jsx)("div",{className:"chat-left ".concat(n?"":"hide"),children:(0,i.jsxs)("div",{className:"chatleft-column",children:[(0,i.jsxs)("div",{className:"d-none d-md-block mb-4",children:[(0,i.jsx)("div",{className:"avatar-section",children:m&&m.photoURL&&(0,i.jsx)("img",{src:m.photoURL,alt:"Avatar",className:"w-100 h-auto rounded-circle",style:{maxWidth:"12rem"}})}),(0,i.jsx)("hr",{className:"avatar-divider"})]}),(0,i.jsx)("div",{className:"d-flex flex-column align-items-center",children:(0,i.jsxs)("div",{className:"chatbutton-container flex-wrap justify-content-center justify-content-md-start gap-2",children:[(0,i.jsxs)("div",{className:"button-container",onClick:function(){return f("Chat History")},children:[(0,i.jsx)("button",{type:"button",className:"py-3 px-3 gap-4 chat-btn",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"})})}),"Chat History"===l&&(0,i.jsx)("div",{className:"activated-indicator"})]}),(0,i.jsxs)("div",{className:"button-container",onClick:function(){return f("Contacts")},children:[(0,i.jsx)("button",{type:"button",className:"py-3 px-3 gap-4 chat-btn",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM4 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 0110.374 21c-2.331 0-4.512-.645-6.374-1.766z"})})}),"Contacts"===l&&(0,i.jsx)("div",{className:"activated-indicator"})]}),(0,i.jsxs)("div",{className:"button-container",onClick:function(){return f("Profile")},children:[(0,i.jsx)("button",{type:"button",className:"py-3 px-3 gap-4 chat-btn",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})})}),"Profile"===l&&(0,i.jsx)("div",{className:"activated-indicator"})]}),(0,i.jsxs)("div",{className:"button-container",onClick:function(){return f("Settings")},children:[(0,i.jsx)("button",{type:"button",className:"py-3 px-3 gap-4 chat-btn",children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:[(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"}),(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),"Settings"===l&&(0,i.jsx)("div",{className:"activated-indicator"})]}),(0,i.jsx)("button",{type:"button",className:"py-3 px-3 gap-4 chat-btn",onClick:function(){window.history.back()},children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})})})]})})]})})},o=n(4942),l=n(1413),u=n(4165),d=n(3433),h=n(5861),m=function(e){var t=e.isActive,n=e.toggleRightColumnVisibility,c=e.updateOtherUserID,m=e.otherUserUID,x=(0,r.useState)(!1),f=(0,s.Z)(x,2),p=(f[0],f[1]),v=(0,r.useState)(""),g=(0,s.Z)(v,2),j=g[0],w=g[1],b=(0,r.useState)([]),k=(0,s.Z)(b,2),y=(k[0],k[1]),N=(0,r.useState)([]),U=(0,s.Z)(N,2),Z=U[0],C=U[1],S=(0,r.useState)({}),L=(0,s.Z)(S,2),D=L[0],I=L[1],M=(0,r.useState)(null),A=(0,s.Z)(M,2);A[0],A[1];(0,r.useEffect)((function(){if(!window.matchMedia("(max-width: 768px)").matches&&!m&&Z.length>0){var e=Z[0],t=(null===e||void 0===e?void 0:e.otherUserID)||null;c(t,j)}}),[Z,m,j,c]);(0,r.useEffect)((function(){var e=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(t){var n,r,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,a.hJ)(a.db,"chats"),e.prev=1,e.next=4,(0,a.PL)(n);case 4:r=e.sent,i=[],r.forEach((function(e){var n=e.id.split("_"),r=(0,s.Z)(n,2),a=r[0],c=r[1];if(a===t||c===t){var o=a===t?c:a;y((function(e){return[].concat((0,d.Z)(e),[o])})),i.push({id:e.id,data:e.data(),otherUserID:o})}})),C(i),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("Error fetching chats:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),t=a.I8.onAuthStateChanged((function(t){if(t){var n=t.uid;w(n),e(n)}}));return function(){t()}}),[]);var E=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(t){var n,s,r,i,c,d,h,m,x,f;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!D[t]){e.next=2;break}return e.abrupt("return",D[t]);case 2:return n=a.db,s={},e.prev=4,r=(0,a.hJ)(n,"expertApplications"),i=(0,a.JU)(r,t),e.next=9,(0,a.QT)(i);case 9:if(!(c=e.sent).exists()){e.next=15;break}d=c.data(),s={photoURL:d.photoURL||"",displayName:d.displayName||"Unknown"},e.next=21;break;case 15:return h=(0,a.hJ)(n,"userProfiles"),m=(0,a.JU)(h,t),e.next=19,(0,a.QT)(m);case 19:(x=e.sent).exists()&&(f=x.data(),s={photoURL:f.photoURL||"",displayName:f.displayName||"Unknown"});case 21:I((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,o.Z)({},t,s))})),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(4),console.error("Error getting user profile:",e.t0);case 27:return e.abrupt("return",s);case 28:case"end":return e.stop()}}),e,null,[[4,24]])})));return function(t){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){var e=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(){var t;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Z.map(function(){var e=(0,h.Z)((0,u.Z)().mark((function e(t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t.otherUserID);case 2:return n=e.sent,e.abrupt("return",(0,l.Z)((0,l.Z)({},t),{},{userData:n}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:t=e.sent,C(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Z.length>0&&e()}),[Z]);var R=function(e,t){if(e.data&&e.data.messages){var n=e.otherUserID,s=Object.values(e.data.messages).filter((function(e){return e.sender===n}));if(s.length>0){var r=s.reduce((function(e,t){return t.timestamp.toMillis()>e.timestamp.toMillis()?t:e})),a=r.timestamp.toDate().toLocaleTimeString([],{hour:"numeric",minute:"numeric"}),i=r.timestamp.toDate().toLocaleDateString([],{year:"numeric",month:"short",day:"numeric"});return"".concat(a,", ").concat(i)}}return""};return(0,i.jsx)("div",{className:t?"visible":"hidden",children:(0,i.jsx)("div",{className:"p-2 flex flex-col gap-2 h-full",children:(0,i.jsxs)("div",{className:" d-flex flex-column gap-2",children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("div",{children:(0,i.jsx)("h4",{children:"Chats"})}),(0,i.jsxs)("div",{className:"flex gap-1",children:[(0,i.jsx)("button",{type:"button",className:"py-3 px-3 gap-4 chat-btn",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"})})}),(0,i.jsx)("button",{type:"button",className:"py-3 px-3 gap-4 chat-btn",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"})})})]})]}),(0,i.jsx)("div",{className:"relative flex flex-col",children:(0,i.jsx)("div",{})}),Z.map((function(e,t){var s,r;return(0,i.jsx)("div",{className:"relative",children:(0,i.jsxs)("button",{className:"chat-btn d-flex justify-content-start align-items-start w-100 gap-4 align-items-center",onClick:function(){return t=e.otherUserID,c(t,j),p(!0),void n();var t},children:[(0,i.jsx)("img",{src:(null===(s=e.userData)||void 0===s?void 0:s.photoURL)||"".concat("","/images/arts/user.webp"),alt:"Avatar",className:"small-avatar rounded-circle"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-weight-bold mb-0 text-start",children:null===(r=e.userData)||void 0===r?void 0:r.displayName}),(0,i.jsx)("p",{className:"text-sm text-muted text-start",children:R(e)})]})]})},t)}))]})})})},x=function(e){var t=e.handleContactButtonClick;return(0,i.jsx)("div",{className:"relative flex flex-col",children:(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"chat-btn add-contact p-sm-2  btn-block",onClick:t,children:(0,i.jsxs)("div",{className:"row align-items-center",children:[(0,i.jsx)("div",{className:"col-auto",children:(0,i.jsx)("div",{className:"avatar-section",children:(0,i.jsx)("img",{src:"avatar.png",alt:"Avatar",className:"w-100 h-auto rounded-circle",style:{maxWidth:"12rem"}})})}),(0,i.jsx)("div",{className:"col",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-weight-bold mb-0",children:"NAME"}),(0,i.jsx)("p",{className:"text-sm text-muted",children:"TIME"})]})})]})})})})},f=function(e){var t=e.toggleRightColumnVisibility,n=(0,r.useState)(!1),a=(0,s.Z)(n,2),c=a[0],o=a[1];return(0,i.jsxs)("div",{className:"d-flex flex-column gap-2 mt-3",children:[(0,i.jsx)("div",{className:"input-container",children:(0,i.jsx)("input",{type:"text",className:"chat-search-input",placeholder:"Search for Experts"})}),(0,i.jsx)(x,{handleContactButtonClick:function(){o(!c),t()}})]})},p=n(2481),v=function(){var e=(0,r.useState)(null),t=(0,s.Z)(e,2),n=t[0],c=t[1],o=(0,r.useState)(""),l=(0,s.Z)(o,2),d=l[0],m=l[1],x=(0,r.useState)(""),f=(0,s.Z)(x,2),v=f[0],g=f[1];return(0,r.useEffect)((function(){var e=a.I8.onAuthStateChanged(function(){var e=(0,h.Z)((0,u.Z)().mark((function e(t){var n,s,r,i,o,l;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}return c(t),n=(0,p.JU)(a.RZ,"expertApplications",t.uid),e.next=5,(0,p.QT)(n);case 5:if(!(s=e.sent).exists()){e.next=12;break}r=s.data(),m(r.description||""),g(r.city||""),e.next=17;break;case 12:return i=(0,p.JU)(a.RZ,"userProfiles",t.uid),e.next=15,(0,p.QT)(i);case 15:(o=e.sent).exists()?(l=o.data(),m(l.description||""),g(l.city||"")):(m("Description not found"),g("City not found"));case 17:e.next=22;break;case 19:c(null),m(""),g("");case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return function(){return e()}}),[]),(0,i.jsxs)("div",{className:"d-flex flex-column gap-2 mt-3",children:[(0,i.jsx)("div",{className:"justify-content-center align-items-center px-8",children:(0,i.jsxs)("div",{className:"text-center",children:[n&&n.photoURL&&(0,i.jsx)("img",{className:"medium-avatar mx-auto user-avatar mb-2",src:n.photoURL,alt:"User Avatar"}),n&&n.displayName&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h4",{children:n.displayName}),(0,i.jsx)("p",{className:"text-muted",children:d})," ",(0,i.jsx)("hr",{className:"avatar-divider"})]})]})}),(0,i.jsxs)("button",{className:"d-flex chat-btn chat-btn-history align-items-center px-4 p-2  w-100  gap-4",style:{transform:"none"},children:[(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",style:{paddingRight:"5px"},fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",height:"30",width:"30",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})}),"My Pofile"]}),(0,i.jsxs)("button",{className:"d-flex chat-btn chat-btn-history align-items-center px-4 p-2  gap-4   w-100 ",style:{transform:"none"},children:[(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",style:{paddingRight:"5px"},fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",height:"30",width:"30",children:[(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),v]})]})},g=function(e){var t=e.selectedMenu,n=e.toggleRightColumnVisibility,a=e.updateOtherUserID,c=e.isMiddleColumnVisible,o=e.setActiveButton,l=e.otherUserUID,u=e.currentUserUID,d=(0,r.useState)(t),h=(0,s.Z)(d,2),x=h[0],p=h[1],g=(0,r.useState)(!0),j=(0,s.Z)(g,2),w=j[0],b=j[1],k=(0,r.useState)(!0),y=(0,s.Z)(k,2),N=y[0],U=y[1];(0,r.useEffect)((function(){b(!1);var e=setTimeout((function(){p(t),b(!0),U("Chat History"===t)}),300);return function(){return clearTimeout(e)}}),[t]);return(0,i.jsxs)("div",{className:"chat-middle pt-4 ".concat(c?"":"hide"),children:[(0,i.jsx)("div",{className:"chat-component ".concat(w&&N?"visible":"hidden"),children:"Chat History"===x&&(0,i.jsx)(m,{otherUserUID:l,updateOtherUserID:a,toggleRightColumnVisibility:n,currentUserUID:u})}),(0,i.jsx)("div",{className:"contacts-component ".concat(w&&!N?"visible":"hidden"),children:"Contacts"===x&&(0,i.jsx)(f,{switchToChatHistory:function(e){p("Chat History"),U(!0),e("Chat History")},setActiveButton:o,toggleRightColumnVisibility:n})}),(0,i.jsx)("div",{className:"profile-component ".concat(w&&"Profile"===x?"visible":"hidden"),children:"Profile"===x&&(0,i.jsx)(v,{})})]})},j=n(5372),w=n(2383),b=function(e){var t=e.selectedSession,n=e.closeShareChat,c=(e.otherUserUID,e.selectedMessageUID),o=(0,r.useState)([]),l=(0,s.Z)(o,2),d=l[0],m=l[1],x=(0,r.useState)(!0),f=(0,s.Z)(x,2),v=f[0],g=f[1];return(0,r.useEffect)((function(){var e=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(){var n,s,r;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=10;break}return n=(0,p.hJ)(a.RZ,"users",c,"discussions",t,"messages"),e.next=5,(0,p.PL)((0,p.IO)(n,(0,p.Xo)("createTime")));case 5:s=e.sent,r=s.docs.map((function(e){var t=e.data();return{prompt:t.prompt,response:t.response}})),m(r),g(!1),console.log("Fetched messages for discussionId:",t,r);case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error fetching shared chat messages:",e.t0),g(!1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]),(0,i.jsxs)("div",{className:"white-box-chathistory",children:[(0,i.jsx)("div",{className:"go-back-svg go-back-svg-padding",children:(0,i.jsx)("button",{onClick:n,children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,color:"black",stroke:"currentColor",className:"w-6 h-6",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})}),(0,i.jsx)("h2",{children:"Share link to Chat"}),(0,i.jsx)("div",{className:"divider "}),(0,i.jsx)("p",{children:"Messages you send after creating your link won't be shared. Anyone with the URL will be able to view the shared chat."}),(0,i.jsx)("div",{className:"shared-chat scroll-cat",children:v?(0,i.jsx)(w.Z,{}):d.map((function(e,t){return(0,i.jsxs)("div",{className:"chat-message",children:[(0,i.jsx)("strong",{children:(0,i.jsx)(j.U,{children:e.prompt})}),(0,i.jsx)(j.U,{children:e.response}),(0,i.jsx)("div",{className:"divider "})]},t)}))})]})},k=function(e){var t=e.toggleColumns,n=e.otherUserUID,c=e.currentUserUID,o=(0,r.useState)(!1),l=(0,s.Z)(o,2),d=l[0],m=l[1],x=(0,r.useState)(null),f=(0,s.Z)(x,2),v=f[0],g=f[1],j=(0,r.useState)(""),w=(0,s.Z)(j,2),k=w[0],y=w[1],N=(0,r.useState)(""),U=(0,s.Z)(N,2),Z=U[0],C=U[1],S=(0,r.useState)(!1),L=(0,s.Z)(S,2),D=L[0],I=L[1],M=(0,r.useState)(null),A=(0,s.Z)(M,2),E=A[0],R=A[1],B=(0,r.useState)(null),V=(0,s.Z)(B,2),J=V[0],T=V[1];(0,r.useEffect)((function(){var e=window.matchMedia("(max-width: 768px)");m(e.matches);var t=function(){m(e.matches)};return e.addListener(t),function(){e.removeListener(t)}}),[]),(0,r.useEffect)((function(){var e=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(){var t,s,r,i,c,o,l,d,h;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=19;break}return t=a.db,s=(0,p.hJ)(t,"expertApplications"),r=(0,p.JU)(s,n),e.next=7,(0,p.QT)(r);case 7:if(!(i=e.sent).exists()){e.next=13;break}(c=i.data())&&(g(c.photoURL),y(c.displayName?c.displayName:""),C(c.occupation?c.occupation:"")),e.next=19;break;case 13:return o=(0,p.hJ)(t,"userProfiles"),l=(0,p.JU)(o,n),e.next=17,(0,p.QT)(l);case 17:(d=e.sent).exists()&&(h=d.data())&&(g(h.photoURL),y(h.displayName?h.displayName:""),C(h.occupation));case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.error("Error fetching user data:",e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}();e()}),[n]),(0,r.useEffect)((function(){var e=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(){var t,r,i,o,l,d,h,m,x,f,v,g,j,w,b,k,y;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=41;break}return t=a.db,r=[c,n].sort().join("_"),i=(0,p.JU)(t,"chats",r),e.next=7,(0,p.QT)(i);case 7:if(!(o=e.sent).exists()){e.next=39;break}for(l=o.data(),d=l.messages,h=0,m=null,x=0,f=Object.entries(d);x<f.length;x++)v=(0,s.Z)(f[x],2),v[0],(g=v[1]).timestamp.seconds>h&&(h=g.timestamp.seconds,m=g);if(!m){e.next=37;break}if(console.log("Fetched Message for selectedSession:",m),j=m.sender,console.log("Selected Message UID:",j),T(j),void 0===(w=m.selectedSession)){e.next=25;break}console.log("Selected Session Value:",w),R(w),e.next=35;break;case 25:b=Object.values(d),k=b.length-1;case 27:if(!(k>=0)){e.next=35;break}if(void 0===(y=b[k]).selectedSession){e.next=32;break}return R(y.selectedSession),e.abrupt("break",35);case 32:k--,e.next=27;break;case 35:e.next=37;break;case 37:e.next=39;break;case 39:e.next=44;break;case 41:console.log("Selected Message UID: null"),T(null),R(null);case 44:e.next=49;break;case 46:e.prev=46,e.t0=e.catch(0),console.error("Error fetching and updating session:",e.t0);case 49:case"end":return e.stop()}}),e,null,[[0,46]])})));return function(){return e.apply(this,arguments)}}();e()}),[n,c]);return(0,i.jsxs)("div",{className:"chat-header p-1",style:{display:"flex",alignItems:"center"},children:[d&&(0,i.jsx)("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",style:{marginRight:"8px"},children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),(0,i.jsx)("div",{className:"small-avatar",children:(0,i.jsx)("img",{className:"small-avatar mx-auto user-avatar mb-2",src:v,alt:"Custom 404 Image"})}),(0,i.jsx)("div",{className:"d-flex flex-column justify-content-start offset-1 pt-2",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-weight-bold mb-0",children:k}),(0,i.jsx)("p",{className:"text-sm text-muted",children:Z})]})}),console.log("Selected Session Value:",E),E&&(0,i.jsx)("svg",{className:"custom-svg-chatheader",xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",onClick:function(){I(!0)}}),D&&(0,i.jsx)(b,{selectedSession:E,selectedMessageUID:J,currentUserUID:c,otherUserUID:n,closeShareChat:function(){I(!1)}})]})},y=(0,a.hJ)(a.db,"chats"),N=function(e,t){return e<t?"".concat(e,"_").concat(t):"".concat(t,"_").concat(e)},U=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(t,n,s,r){var i,c,l;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=N(t,n),c=(0,a.JU)(y,i),console.log("Sending message with selectedSession:",r),l={text:s,sender:t,timestamp:(0,a.Bt)()},void 0!==r&&(l.selectedSession=r),console.log("Message to be sent:",l),e.next=9,(0,a.pl)(c,{messages:(0,o.Z)({},Date.now(),l)},{merge:!0});case 9:return e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(0),console.error("Error sending message:",e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n,s,r){return e.apply(this,arguments)}}(),Z=function(e){var t=e.isRightColumnVisible,n=e.toggleColumns,c=e.otherUserUID,o=e.selectedSession,d=(0,r.useState)([]),m=(0,s.Z)(d,2),x=m[0],f=m[1],p=(0,r.useRef)(null),v=(0,r.useRef)(null),g=(0,r.useState)(""),j=(0,s.Z)(g,2),w=j[0],b=j[1],Z=(0,r.useState)(null),C=(0,s.Z)(Z,2),S=C[0],L=C[1],D=(0,r.useState)(!1),I=(0,s.Z)(D,2),M=I[0],A=I[1],E=(0,r.useState)("52px"),R=(0,s.Z)(E,2),B=R[0],V=R[1];(0,r.useEffect)((function(){var e=(0,a.Aj)(a.I8,(function(e){L(e?e.uid:null)}));return function(){return e()}}),[]),(0,r.useEffect)((function(){A(S===c)}),[S,c]),(0,r.useEffect)((function(){S&&c&&function(e,t,n){try{var s=N(e,t),r=(0,a.JU)(y,s);(0,a.cf)(r,(function(e){try{var t,s=(e.exists()?Object.values((null===(t=e.data())||void 0===t?void 0:t.messages)||{}):[]).map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{selectedSession:e.selectedSession||null})})).sort((function(e,t){return t.timestamp-e.timestamp})).reverse();n(s)}catch(r){console.error("Error getting messages:",r),n([])}}))}catch(i){console.error("Error getting messages:",i),n([])}}(S,c,(function(e){var t=e.slice(0).reverse();f(t)}))}),[S,c]);var J=window.innerWidth<=767,T=function(){var e=(0,h.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!M){e.next=5;break}return console.error("Cannot send messages to yourself."),console.log("currentUserUID:",S),console.log("otherUserUID:",c),e.abrupt("return");case 5:if(""!==w.trim()){e.next=7;break}return e.abrupt("return");case 7:if(!S||!c){e.next=14;break}return e.next=10,U(S,c,w,o);case 10:e.sent&&(b(""),J||v.current.focus()),e.next=17;break;case 14:console.log("currentUserUID:",S),console.log("otherUserUID:",c),console.error("currentUserUID or otherUserUID is undefined");case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){p.current&&(p.current.scrollTop=p.current.scrollHeight)}),[x]);var W=function(){var e=v.current;if(e){e.style.height="52px";var t=Math.min(e.scrollHeight,200);e.style.height="".concat(t,"px")}};(0,r.useEffect)((function(){W()}),[]),(0,r.useEffect)((function(){""===w&&V("52px")}),[w]);var H=function(e){if(e){var t=e.toDate(),n=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0");return"".concat(n,":").concat(s)}return""};return(0,i.jsxs)("div",{className:"chat-right ".concat(t?"show":"hide"),children:[(0,i.jsx)(k,{toggleColumns:n,otherUserUID:c,currentUserUID:S,selectedSession:o}),(0,i.jsxs)("div",{className:"chat-column",children:[(0,i.jsx)("div",{className:"chat-box",ref:p,children:Array.isArray(x)&&x.length>0?x.map((function(e,t){return e.timestamp?(0,i.jsxs)("div",{className:e.sender===S?"chat-bubble user-sent":"chat-bubble",children:[(0,i.jsx)("div",{className:"message",children:e.text}),(0,i.jsx)("div",{className:"timestamp small-timestamp ".concat(e.sender===S?"user-sent-timestamp":"other-sent-timestamp"),children:H(e.timestamp)})]},t):null})):(0,i.jsx)("div",{children:"No messages yet."})}),(0,i.jsx)("div",{className:"chatui-container",children:(0,i.jsxs)("div",{className:"userui-input",children:[(0,i.jsx)("button",{className:"svg-container userui-left-button",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",color:"#212529",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",height:"25",width:"25",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13"})})}),(0,i.jsx)("textarea",{type:"text",placeholder:"Type a message...",ref:v,style:{height:B},value:w,onChange:function(e){b(e.target.value),W()},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),T())},className:"message-input scroll-col",autoComplete:"off",inputMode:"text"}),(0,i.jsx)("button",{"aria-label":"Send Message",onClick:T,className:"svg-container userui-right-button ",children:(0,i.jsx)("i",{className:"fas fa-paper-plane"})})]})})]})]})},C=n(7689),S=function(){var e=(0,r.useState)(!1),t=(0,s.Z)(e,2),n=t[0],a=t[1],o=(0,r.useState)(""),l=(0,s.Z)(o,2),u=l[0],d=l[1],h=(0,r.useState)(!0),x=(0,s.Z)(h,2),p=x[0],j=x[1],w=(0,r.useState)(!0),b=(0,s.Z)(w,2),k=b[0],y=b[1],N=(0,r.useState)(!0),U=(0,s.Z)(N,2),S=U[0],L=U[1],D=(0,r.useState)(null),I=(0,s.Z)(D,2),M=I[0],A=I[1],E=(0,C.TH)().state,R=E||{},B=R.currentUserUID,V=R.otherUserUID,J=R.selectedSession,T=(0,r.useState)(V||null),W=(0,s.Z)(T,2),H=W[0],z=W[1];(0,r.useEffect)((function(){E&&z(E.otherUserUID||null)}),[E]),(0,r.useEffect)((function(){d("Chat History");var e=window.matchMedia("(max-width: 768px)").matches;j(!e)}),[]);var P=function(){j((function(e){return!e})),y(!1),L(!1)};(0,r.useEffect)((function(){window.matchMedia("(max-width: 768px)").matches&&H&&(L(!1),y(!1),j(!0))}),[H]);return(0,r.useEffect)((function(){if(window.matchMedia("(max-width: 768px)").matches)return document.body.style.overflow="hidden",function(){document.body.style.overflow="auto"}}),[]),(0,i.jsxs)("div",{className:"chatcontainer",children:[(0,i.jsx)(c,{handleButtonClick:function(e){a(!n),d(e),L(!0),A(e)},isActive:n,toggleRightColumnVisibility:P,isLeftColumnVisible:S,activeButton:M,setActiveButton:A,otherUserUID:H,currentUserUID:B}),(0,i.jsxs)(g,{isActive:n,selectedMenu:u,toggleRightColumnVisibility:P,isMiddleColumnVisible:k,activeButton:M,setActiveButton:A,currentUserUID:B,updateOtherUserID:function(e,t){z(e)},otherUserUID:H,children:["Chat History"===u&&(0,i.jsx)(m,{isActive:n,selectedMenu:u}),"Contacts"===u&&(0,i.jsx)(f,{isActive:n,selectedMenu:u}),"Profile"===u&&(0,i.jsx)(v,{isActive:n,selectedMenu:u})]}),H&&(0,i.jsx)(Z,{isRightColumnVisible:p,toggleColumns:function(){j((function(e){return!e})),y(!0),L(!0)},otherUserUID:H,selectedSession:J,currentUserUID:B})]})}}}]);
//# sourceMappingURL=457.742d604f.chunk.js.map